"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[791],{3791:function(e,s,n){n.r(s),n.d(s,{default:function(){return x}});var a=n(2982),t=n(885),i=n(2791),r=n(4581),o=n(3806),l={content:"sales_content__Kz3Z8",sales:"sales_sales__QhOx8",addSaleForm:"sales_addSaleForm__SFVwQ",itemForm:"sales_itemForm__BLJdR",itemName:"sales_itemName__339eN",mainForm:"sales_mainForm__Jy4by",print:"sales_print__JF35w"},c=n(96),u=n(5454),d=n(1080),m=n(1413),p=n(1134),b=n(1570),f=n(184),h=function(e){var s=e.edit,n=e.onSuccess,a=(0,i.useState)(!1),r=(0,t.Z)(a,2),h=r[0],_=r[1],v=(0,p.cI)({resolver:(0,u.y)(b.Ry({name:b.Z_().required(),phone:b.Z_().required(),password:s?b.Z_():b.Z_().required(),subPlan:b.Z_().required()}))}),g=v.control,x=v.handleSubmit,N=v.register,j=v.reset,w=v.formState.errors,y=(0,u.i)(d.Hv.businesses+"/".concat((null===s||void 0===s?void 0:s._id)||"")),S=y.post,Z=y.put,B=y.loading;return(0,i.useEffect)((function(){var e,n;j({name:(null===s||void 0===s?void 0:s.name)||"",phone:(null===s||void 0===s?void 0:s.phone)||"",password:"",subPlan:(null===s||void 0===s||null===(e=s.subscription)||void 0===e||null===(n=e.plan)||void 0===n?void 0:n._id)||""})}),[s]),(0,f.jsx)("div",{className:"grid gap-1 p-1 ".concat(l.addRoleForm),children:(0,f.jsxs)("form",{autoComplete:"new-password",onSubmit:x((function(e){e.password||delete e.password,(s?Z:S)(e).then((function(e){var s=e.data;if(!s.success)return(0,c.N)({type:"error",message:s.message});n(s.data,h)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))})),className:"".concat(l.mainForm," grid gap-1"),children:[(0,f.jsx)(o.II,(0,m.Z)((0,m.Z)({label:"Name"},N("name")),{},{required:!0,error:w.name})),(0,f.jsx)(o.II,(0,m.Z)((0,m.Z)({label:"Phone"},N("phone")),{},{required:!0,error:w.phone})),(0,f.jsx)(o.II,(0,m.Z)((0,m.Z)({label:"Password",type:"password"},N("password")),{},{required:!s,error:w.password})),(0,f.jsx)(o.OC,{control:g,label:"Subscription Plan*",name:"subPlan",url:d.Hv.subPlans,getQuery:function(e,s){return{name:e,_id:s}},handleData:function(e){return{label:e.name,value:e._id}}}),(0,f.jsxs)("div",{className:"btns",children:[(0,f.jsx)("button",{className:"btn",disabled:B,children:s?"Update":"Submit"}),!s&&(0,f.jsx)("button",{className:"btn",disabled:B,onClick:function(){_(!0)},children:"Next"})]})]})})},_=n(6871),v=n(6355),g=n(3853),x=function(){var e=(0,i.useContext)(r.D),s=e.setBusiness,n=e.setConfig,m=e.setUser,p=(0,i.useState)([]),b=(0,t.Z)(p,2),x=b[0],N=b[1],j=(0,i.useState)(!1),w=(0,t.Z)(j,2),y=w[0],S=w[1],Z=(0,_.s0)(),B=(0,u.i)(d.Hv.findBusinesses).get,F=(0,u.i)(d.Hv.adminSwitchAccount).post;return(0,i.useEffect)((function(){B().then((function(e){var s=e.data;s.success?N(s.data):(0,c.N)({type:"error",message:s.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[]),(0,f.jsxs)("div",{className:"".concat(l.content," grid gap-1 m-a p-1"),children:[(0,f.jsxs)("div",{className:"flex",children:[(0,f.jsx)("h2",{children:"All Businesses"}),(0,f.jsx)("button",{className:"btn m-a mr-0",onClick:function(){return S(!0)},children:"Add Business"})]}),(0,f.jsx)(o.iA,{className:l.sales,columns:[{label:"Business"},{label:"Phone"},{label:"Plan"},{label:"Actions"}],children:x.map((function(e){var a,t;return(0,f.jsxs)("tr",{onClick:function(a){["TR","TD"].includes(a.target.nodeName)&&(s({business:e}),n(e.config))},style:{cursor:"pointer"},children:[(0,f.jsx)("td",{children:e.phone}),(0,f.jsx)("td",{children:e.name}),(0,f.jsx)("td",{children:null===(a=e.subscription)||void 0===a||null===(t=a.plan)||void 0===t?void 0:t.name}),(0,f.jsx)(o.p2,{className:l.actions,actions:[{icon:(0,f.jsx)(g._fJ,{style:{fontSize:"1.15rem"}}),label:"Login as this Business",callBack:function(){(0,c.N)({type:"confirmation",message:"Are you sure you want to logout and login as this business?",callback:function(){F({phone:e.phone}).then((function(e){var s=e.data;if(s.success)return m(s.data),localStorage.setItem("userType",s.data.userType),void(window.location=d.Hb.dashboard.replace("*","")+d.Hb.quotes);(0,c.N)({type:"error",message:s.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}})}},{icon:(0,f.jsx)(v.KHI,{}),label:"Edit",callBack:function(){S(e)}}]})]},e._id)}))}),(0,f.jsx)(c.u,{open:!!y,head:!0,label:"".concat(null!==y&&void 0!==y&&y._id?"View / Update":"Add"," Business"),className:l.addBusinessFormModal,setOpen:function(){S(null)},children:(0,f.jsx)(h,{edit:null!==y&&void 0!==y&&y._id?y:null,onSuccess:function(e,t){null!==y&&void 0!==y&&y._id?N((function(s){return s.map((function(s){return s._id===e._id?e:s}))})):N((function(s){return[].concat((0,a.Z)(s),[e])})),S(null),t&&(s({business:e}),n(e.config),Z(d.Hb.dashboard.replace("*","")+d.Hb.settings.baseUrl.replace("*","")+d.Hb.settings.businessInformation,{state:{next:t}}))}})})]})}}}]);
//# sourceMappingURL=791.6e1889a1.chunk.js.map