"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[170],{601:function(e,s,t){t.r(s),t.d(s,{default:function(){return f}});var a=t(2982),n=t(885),l=t(2791),c=t(4581),i=t(3806),r=t(6355),d=t(96),o={content:"chat_content__zOulD",subPlans:"chat_subPlans__H3lcW",adminView:"chat_adminView__ubc+2",fullChatModal:"chat_fullChatModal__yf1FM",chatContext:"chat_chatContext__k0EWE",fullChat:"chat_fullChat__WRb26",detail:"chat_detail__qgKty",messages:"chat_messages__BhAuS",placeholder:"chat_placeholder__tiwrY",date:"chat_date__ZPeXL",msg:"chat_msg__UHaM0",user:"chat_user__w6L8V",actions:"chat_actions__04l0D",btn:"chat_btn__4OyPB"},h=t(5454),u=t(1080),m=t(8617),x=t(184),j=function(e){var s=e.msg,t=e.style;return(0,x.jsxs)("div",{className:"".concat(o.msg," ").concat(o[s.role]),style:t,children:["assistant"===s.role&&(0,x.jsxs)("div",{className:o.actions,children:[s.like&&(0,x.jsx)(m.aMS,{}),!1===s.like&&(0,x.jsx)(m.fA,{})]}),(0,x.jsx)("p",{className:o.content,children:s.content}),(0,x.jsx)(i.W7,{format:"hh:mma",children:s.createdAt})]})},g=function(e){var s,t,a,c,r=e.chat,h=(0,l.useState)(!1),u=(0,n.Z)(h,2),m=u[0],g=u[1];return(0,x.jsxs)("div",{className:"grid gap-1 ".concat(o.fullChat),children:[(0,x.jsxs)("div",{className:"grid p-1 gap-1 ".concat(o.detail),children:[(0,x.jsxs)("div",{className:o.user,children:[(0,x.jsx)("h4",{children:null===(s=r.user)||void 0===s?void 0:s.name}),(0,x.jsx)("p",{children:null===(t=r.user)||void 0===t?void 0:t.phone}),(0,x.jsx)("p",{children:null===(a=r.user)||void 0===a?void 0:a.email})]}),(0,x.jsxs)("div",{className:o.other,children:[(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Chat Started: "}),(0,x.jsx)(i.W7,{format:"DD MMM YYYY hh:mma",children:r.createdAt})]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Last Message: "}),(0,x.jsx)(i.W7,{format:"DD MMM YYYY hh:mma",children:r.updatedAt})]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Total Messages: "}),r.messages.length-1]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Assistant Response: "}),r.messages.filter((function(e){return"assistant"===e.role})).length]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Total Liked Messages: "}),r.messages.filter((function(e){return"assistant"===e.role&&!0===e.like})).length]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Total Disliked Messages: "}),r.messages.filter((function(e){return"assistant"===e.role&&!1===e.like})).length]})]}),(0,x.jsx)("button",{className:"btn",onClick:function(){return g(!m)},children:"View Context"})]}),(0,x.jsx)("div",{className:o.messages,children:r.messages.filter((function(e){return"System"!==e.name})).map((function(e,s,t){return(0,x.jsxs)(l.Fragment,{children:[t[s-1]&&new Date(t[s-1].createdAt).getDate()!==new Date(e.createdAt).getDate()&&(0,x.jsx)("p",{className:o.date,children:(0,x.jsx)(i.W7,{format:"DD MMM YYYY",children:e.createdAt})}),0===s&&(0,x.jsx)("p",{className:o.date,children:(0,x.jsx)(i.W7,{format:"DD MMM YYYY",children:e.createdAt})}),(0,x.jsx)(j,{msg:e})]},e._id)}))}),m&&(0,x.jsx)(d.u,{open:m,setOpen:g,head:!0,label:"Context",children:(0,x.jsx)("div",{className:o.chatContext,children:null===(c=r.messages[0])||void 0===c?void 0:c.content.split("\n").map((function(e,s){return e?(0,x.jsx)("p",{children:e},s):null}))})})]})},f=function(){var e=(0,l.useContext)(c.D),s=e.user,t=e.checkPermission,m=(0,l.useState)([]),j=(0,n.Z)(m,2),f=j[0],_=j[1],p=(0,l.useState)(null),v=(0,n.Z)(p,2),M=v[0],b=v[1],D=(0,h.i)(u.Hv.chats),Y=D.get,N=D.loading,C=(0,h.i)(u.Hv.chats+"/{ID}").remove;return(0,l.useEffect)((function(){Y().then((function(e){var s=e.data;if(s.success)return _(s.data)})).catch((function(e){return(0,d.N)({type:"error",message:e.message})}))}),[]),(0,x.jsxs)("div",{className:"".concat(o.content," grid gap-1 m-a p-1"),children:[(0,x.jsx)("div",{className:"flex",children:(0,x.jsx)("h2",{children:"All Chats"})}),(0,x.jsx)(i.iA,{loading:N,className:"".concat(o.subPlans," ").concat("admin"===s.userType?o.adminView:""),columns:[{label:"Date"},{label:"User"}].concat((0,a.Z)("admin"===s.userType?[{label:"Business"}]:[]),[{label:"Topic"},{label:"Total Messages"},{label:"Token Usage"},{label:"Action"}]),children:f.map((function(e){var n,l;return(0,x.jsxs)("tr",{style:{cursor:"pointer"},children:[(0,x.jsx)("td",{children:(0,x.jsx)(i.W7,{format:"DD MMM YYYY hh:mma",children:e.createdAt})}),(0,x.jsx)("td",{children:null===(n=e.user)||void 0===n?void 0:n.name}),"admin"===s.userType&&(0,x.jsx)("td",{children:null===(l=e.business)||void 0===l?void 0:l.name}),(0,x.jsx)("td",{children:e.topic}),(0,x.jsx)("td",{children:e.messages.length-1}),(0,x.jsx)("td",{children:e.tokenUsage}),(0,x.jsx)(i.p2,{className:o.actions,actions:[{icon:(0,x.jsx)(r.z5B,{}),label:"View",callBack:function(){b(e)}}].concat((0,a.Z)(t("chat_delete")?[{icon:(0,x.jsx)(r.lp8,{}),label:"Delete",callBack:function(){return(0,d.N)({type:"confirmation",message:"Are you sure you want to remove this Chat?",callback:function(){C({},{params:{"{ID}":e._id}}).then((function(s){var t=s.data;t.success?_((function(s){return s.filter((function(s){return s._id!==e._id}))})):(0,d.N)({type:"error",message:t.message})}))}})}}]:[]))})]},e._id)}))}),(0,x.jsx)(d.u,{open:M,head:!0,label:"Chat",className:o.fullChatModal,setOpen:function(){return b(null)},children:(0,x.jsx)(g,{chat:M})})]})}}}]);
//# sourceMappingURL=170.2ca32cc0.chunk.js.map