"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[303],{303:function(e,n,a){a.r(n),a.d(n,{default:function(){return P}});var t=a(2982),l=a(885),i=a(2791),r=a(6871),o=a(5454),c=a(96),s=a(1080),u=a(3806),d=a(6355),m={content:"payments_content__Ef9dU",payments:"payments_payments__XOGgR",addCollectionForm:"payments_addCollectionForm__dbBn5",purchaseDetail:"payments_purchaseDetail__EXI1C",box:"payments_box__T7nJ3",noContent:"payments_noContent__LXw2o",items:"payments_items__YaYOZ",name:"payments_name__HBfCa",optionsWrapper:"payments_optionsWrapper__oZB1E",options:"payments_options__4V0MR",mainForm:"payments_mainForm__LW2nZ",detail:"payments_detail__0HqI0",label:"payments_label__9JEyz",viewOnly:"payments_viewOnly__z4Nm4",collectionFormModal:"payments_collectionFormModal__2J6RL",dynamicForm:"payments_dynamicForm__Y+G3e",productVariants:"payments_productVariants__LZbmq",images:"payments_images__bb4hn",selected:"payments_selected__qgQwF",products:"payments_products__sC4Lm",product:"payments_product__CbAbr",thumbnail:"payments_thumbnail__PaIN-",productDetail:"payments_productDetail__c4To3",price:"payments_price__mKzlw",subtotal:"payments_subtotal__e1Wjg",variantForm:"payments_variantForm__RfOJU",variantImages:"payments_variantImages__Gc-Op",fieldFormWrapper:"payments_fieldFormWrapper__IpOFl",dataDetail:"payments_dataDetail__kpLXP",inputDetail:"payments_inputDetail__+gZ5X",fieldForm:"payments_fieldForm__diCI4",fields:"payments_fields__Oy8kH",nestedObjectFormModal:"payments_nestedObjectFormModal__SYXpk",dynamicFormModal:"payments_dynamicFormModal__X-r0u"},p=a(1413),f=a(1134),b=a(1570),v=a(184);b.kM(b.Z_,"noneOf",(function(e,n){return this.test("noneOf",n,(function(a){var t=this.path,l=this.createError;return!e.includes(a)||l({path:t,message:(null===n||void 0===n?void 0:n.replace("{value}",a))||n})}))}));var y=b.Ry({name:b.Z_().required()}),x=b.Ry({label:b.Z_().required(),value:b.Z_().required()}),h=["title","description","images","price","whatsappNumber","category","subcategory"],j=function(e){var n,a,r,c=e.edit,d=e.fields,y=e.editCollection,x=e.collections,j=e.onSuccess,T=e.clear,Z=(0,f.cI)({resolver:(0,o.y)(b.Ry({name:b.Z_().noneOf(d.filter((function(e){return!c||c.name!==e.name})).map((function(e){return e.name})),"{value} already exists").required(),dataType:b.Z_().required(),label:b.Z_().required(),fieldType:b.Z_(),inputType:b.Z_(),required:b.O7()}))}),N=Z.handleSubmit,S=Z.register,C=Z.reset,F=Z.watch,O=Z.setValue,q=(Z.clearErrors,Z.control),I=Z.formState.errors,D=F("name"),A=F("inputType"),w=F("dataType"),k=F("dataElementType"),E=F("fields"),P=F("collection"),V=F("fieldType"),M=F("optionType"),L=F("options"),H=F("label"),R=(0,i.useCallback)((function(e){if("Product"===(null===y||void 0===y?void 0:y.name)){var n={};Object.entries(e).forEach((function(e){var a=(0,l.Z)(e,2),t=a[0],i=a[1];("subcategory"===t&&!h.filter((function(e){return"subcategory"!==e})).includes(t)||"subcategory"!==t)&&(n[t]=i)})),j(n)}else j(e);C({category:"",subcategory:"",name:"",inputType:"",dataType:"",dataElementType:"",dataElements:"",collection:"",fieldType:"",optionType:"",options:[],multiRange:"",label:"",required:"",decimalPlaces:"",unique:""})}),[c]);return(0,i.useEffect)((function(){C((0,p.Z)({},c))}),[c]),(0,v.jsxs)("div",{className:m.fieldFormWrapper,children:[(0,v.jsxs)("div",{className:m.dataDetail,children:[(0,v.jsxs)("form",{onSubmit:N(R),className:"".concat(m.fieldForm," grid gap-1"),children:[(0,v.jsxs)("div",{className:"flex all-columns gap-1 justify-space-between align-center",children:[(0,v.jsx)("h3",{children:"Data"}),"Product"===(null===y||void 0===y?void 0:y.name)&&!h.includes(D)&&(0,v.jsx)(u.OC,{label:"Subcategory",control:q,url:s.Hv.adminDynamic+"/Subcategory",getQuery:function(e,n){return(0,p.Z)((0,p.Z)({},e&&{name:e}),n&&{name:n})},handleData:function(e){return{label:e.name,value:e.name}},name:"subcategory"}),(0,v.jsx)(u.XZ,(0,p.Z)((0,p.Z)({},S("unique")),{},{label:"Unique"}))]}),(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({label:"Field Name",type:"text",required:!0,disabled:c},S("name")),{},{error:I.name})),(0,v.jsx)(u.hQ,{label:"Data Type",name:"dataType",control:q,formOptions:{required:!0},options:[{label:"String",value:"string"},{label:"Number",value:"number"},{label:"Date",value:"date"},{label:"Boolean",value:"boolean"},{label:"Array",value:"array"},{label:"Variant Array",value:"variantArray"},{label:"Object",value:"object"},{label:"Object ID",value:"objectId"}],disabled:c||"richText"===V}),"objectId"===w&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.OC,{control:q,label:"Collection",options:x.filter((function(e){return e._id!==(null===y||void 0===y?void 0:y._id)})).map((function(e){return{label:e.name,value:e.name}})),name:"collection",formOptions:{required:!0},className:m.itemName}),P&&(0,v.jsx)(u.hQ,{label:"Foreign Field",name:"foreignField",control:q,formOptions:{required:!0},options:[{label:"ID",value:"_id"}].concat((0,t.Z)((null===(n=x.find((function(e){return e.name===P})))||void 0===n?void 0:n.fields.map((function(e){return{label:e.label,value:e.name}})))||[]))})]}),["array","variantArray"].includes(w)&&(0,v.jsx)(u.hQ,{label:"Data Element Type",name:"dataElementType",control:q,formOptions:{required:!0},options:[{label:"String",value:"string"},{label:"Number",value:"number"},{label:"Date",value:"date"},{label:"Object",value:"object"}]})]}),"object"===w&&!["includeProducts","excludeProducts"].includes(D)&&(0,v.jsx)(g,{name:H||D,value:E,setValue:function(e){return O("objectFields",e)},collection:y,collections:x}),["array","variantArray"].includes(w)&&"object"===k&&(0,v.jsx)(g,{name:H||D,value:E,setValue:function(e){return O("fields",e)},collection:y,collections:x})]}),(0,v.jsxs)("div",{className:m.inputDetail,children:[(0,v.jsxs)("form",{onSubmit:N(R),className:"".concat(m.fieldForm," grid gap-1"),children:[(0,v.jsxs)("div",{className:"flex all-columns justify-space-between align-center",children:[(0,v.jsx)("h3",{className:"all-columns",children:"Input Field"}),(0,v.jsx)(u.XZ,(0,p.Z)((0,p.Z)({},S("required")),{},{label:"Required"}))]}),(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({label:"Label",type:"text",required:!0},S("label")),{},{error:I.label})),!(["array","variantArray"].includes(w)&&"object"===k)&&(0,v.jsx)(u.hQ,{label:"Field Type",name:"fieldType",control:q,formOptions:{required:!0},options:[{label:"Input",value:"input"},{label:"Textarea",value:"textarea"},{label:"Rich Text",value:"richText"},{label:"Combobox",value:"combobox"},{label:"Autocomplete",value:"select"},{label:"Date Range",value:"dateRange"},{label:"Collection Filter",value:"collectionFilter"},{label:"None",value:"none"}],onChange:function(e){"richText"===(null===e||void 0===e?void 0:e.value)&&O("dataType","object")}}),!(["combobox","textarea","richText","collectionFilter","none"].includes(V)||["array","variantArray"].includes(w)&&"object"===k||["includeProducts","excludeProducts"].includes(D)&&"object"===w)&&(0,v.jsx)(u.hQ,{label:"Input Type",name:"inputType",control:q,options:"dateRange"===V?[{label:"Calendar",value:"calendar"}]:[{label:"Text",value:"text"},{label:"Number",value:"number"}].concat((0,t.Z)("select"!==V?[{label:"Phone Number",value:"phone"},{label:"Date",value:"date"},{label:"File",value:"file"},{label:"Calendar",value:"calendar"},{label:"Password",value:"password"}]:[]))}),"number"===A&&(0,v.jsx)(u.hQ,{label:"Decimal Places",name:"decimalPlaces",control:q,options:[{label:"1",value:"0"},{label:"1.0",value:"0.0"},{label:"1.00",value:"0.00"},{label:"1.000",value:"0.000"},{label:"1.0000",value:"0.0000"},{label:"1.00000",value:"0.00000"}]}),["combobox","select"].includes(V)&&(0,v.jsx)(u.hQ,{label:"Options type",name:"optionType",control:q,formOptions:{required:!0},options:[{label:"Predefined",value:"array"},{label:"Other Collection",value:"collection",disabled:"combobox"===V}]}),["collection"].includes(M)&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.OC,{control:q,label:"Collection",options:x.filter((function(e){return e._id!==(null===y||void 0===y?void 0:y._id)})).map((function(e){return{label:e.name,value:e.name}})),name:"collection",formOptions:{required:!0},className:m.itemName}),P&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.hQ,{label:"Option Label",name:"optionLabel",control:q,formOptions:{required:!0},options:[{label:"ID",value:"_id"}].concat((0,t.Z)((null===(a=x.find((function(e){return e.name===P})))||void 0===a?void 0:a.fields.map((function(e){return{label:e.label,value:e.name}})))||[]))}),(0,v.jsx)(u.hQ,{label:"Option Value",name:"optionValue",control:q,formOptions:{required:!0},options:[{label:"ID",value:"_id"}].concat((0,t.Z)((null===(r=x.find((function(e){return e.name===P})))||void 0===r?void 0:r.fields.map((function(e){return{label:e.label,value:e.name}})))||[]))})]})]})]}),["combobox","select"].includes(V)&&"array"===M&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("h3",{children:[H," Options"]}),(0,v.jsx)(_,{dataType:w,options:L,setOptions:function(e){return O("options",e)}})]}),(0,v.jsxs)("form",{onSubmit:N(R),className:"".concat(m.fieldForm," grid gap-1"),children:[(["file"].includes(A)||["select","combobox"].includes(V))&&(0,v.jsx)(u.XZ,(0,p.Z)((0,p.Z)({},S("multiple")),{},{label:"Multiple"})),"calendar"===A&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u.hQ,{label:"Date Window",name:"dateWindow",control:q,options:[{label:"All time",value:"allTime"},{label:"Past including Today",value:"pastIncludingToday"},{label:"Past excluding Today",value:"pastExcludingToday"},{label:"Future including Today",value:"futureIncludingToday"},{label:"Future excluding Today",value:"futureExcludingToday"}]}),(0,v.jsx)(u.hQ,{label:"Multiple Range",name:"multipleRanges",control:q,options:[{label:"Yes",value:!0},{label:"No",value:!1}]})]})]}),(0,v.jsxs)("form",{onSubmit:N(R),className:"flex gap-1 justify-center",children:[c&&(0,v.jsx)("button",{className:"btn",type:"button",onClick:T,children:"Clear"}),(0,v.jsxs)("button",{className:"btn",children:[c?"Update":"Add"," Field"]})]})]})]})},g=function(e){var n=e.name,a=e.value,r=void 0===a?[]:a,o=e.setValue,s=e.collection,p=e.collections,f=(0,i.useState)(null),b=(0,l.Z)(f,2),y=b[0],x=b[1],h=(0,i.useState)(null),g=(0,l.Z)(h,2),_=g[0],T=g[1];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"flex justify-space-between align-center",children:[(0,v.jsxs)("h3",{children:[n," Fields"]}),(0,v.jsxs)("button",{className:"btn",onClick:function(){return T(!0)},children:["Add ",n," Field"]})]}),(0,v.jsx)(u.iA,{className:m.fields,columns:[{label:"Name"},{label:"Data Type"},{label:"Label"},{label:"Field Type"},{label:"Input Type"},{label:"Required"},{label:"Action",action:!0}],placeholder:"No fields yet.",children:r.map((function(e,n){return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:(0,v.jsx)("span",{className:"ellipsis",children:e.name})}),(0,v.jsx)("td",{children:e.dataType}),(0,v.jsx)("td",{children:e.label}),(0,v.jsx)("td",{children:e.fieldType}),(0,v.jsx)("td",{children:e.inputType}),(0,v.jsx)("td",{children:e.required?"Yes":"No"}),(0,v.jsx)(u.p2,{actions:[{icon:(0,v.jsx)(d.KHI,{}),label:"Edit",callBack:function(){x(e),T(!0)}},{icon:(0,v.jsx)(d.lp8,{}),label:"Delete",callBack:function(){return(0,c.N)({type:"confirmation",message:"Are you sure you want to remove this Field?",callback:function(){o(r.filter((function(n){return n.name!==e.name})))}})}}]})]},n)}))}),(0,v.jsx)(c.u,{head:!0,label:"".concat(y?"Update":"Add"," ").concat(n," Field"),open:_,setOpen:function(){T(!1),x(null)},className:m.nestedObjectFormModal,children:(0,v.jsx)(j,{edit:y,fields:r,editCollection:s,collections:p,productCollection:p.find((function(e){return"Product"===(null===e||void 0===e?void 0:e.name)})),onSuccess:function(e){y?(o(r.map((function(n){return n.name.toLowerCase()===e.name.toLowerCase()?e:n}))),x(null)):o([].concat((0,t.Z)(r),[e])),T(!1)},clear:function(){return x(null)}},y?"edit":"add")})]})},_=function(e){var n=e.dataType,a=e.options,r=e.setOptions,o=(0,i.useState)(null),s=(0,l.Z)(o,2),p=s[0],f=s[1];return(0,v.jsx)("section",{className:m.optionsWrapper,children:(0,v.jsxs)(u.iA,{className:"".concat(m.options),columns:[{label:"Label"},{label:"Value"},{label:"Action"}],children:[(0,v.jsx)("tr",{className:"inlineForm",children:(0,v.jsx)("td",{children:(0,v.jsx)(T,{dataType:n,edit:p,onSuccess:function(e){r(p?(a||[]).map((function(n){return n._id===e._id?e:n})):[e].concat((0,t.Z)(a||[]))),f(null)},clearForm:function(){return f(null)}})})}),null===a||void 0===a?void 0:a.map((function(e,n){var t;return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:e.label}),(0,v.jsx)("td",{children:null===(t=e.value)||void 0===t?void 0:t.toString()}),(0,v.jsx)(u.p2,{actions:[{icon:(0,v.jsx)(d.KHI,{}),label:"Edit",callBack:function(){f(e)}},{icon:(0,v.jsx)(d.lp8,{}),label:"Delete",callBack:function(){return(0,c.N)({type:"confirmation",message:"Are you sure you want to remove this Option?",callback:function(){r((a||[]).filter((function(n){return n._id!==e._id})))}})}}]})]},n)}))]})})},T=function(e){var n=e.dataType,a=e.edit,t=e.onSuccess,l=e.clearForm,r=(0,f.cI)({resolver:(0,o.y)(x)}),c=r.handleSubmit,s=r.register,m=r.formState.errors,b=r.reset;return(0,i.useEffect)((function(){b({label:(null===a||void 0===a?void 0:a.label)||"",value:(null===a||void 0===a?void 0:a.value)||""})}),[a]),(0,v.jsxs)("form",{onSubmit:c((function(e){"boolean"===n?e.value=["1",1,"true"].includes(e.value.toLowerCase()):"number"===n&&(e.value=+e.value),t((0,p.Z)((0,p.Z)({},e),{},{_id:(null===a||void 0===a?void 0:a._id)||Math.random().toString(36).substr(-8)})),b()})),children:[(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({},s("label")),{},{placeholder:"Label",error:m.label})),(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({},s("value")),{},{placeholder:"Value",error:m.value})),(0,v.jsxs)("section",{className:"btns",children:[(0,v.jsx)("button",{className:"btn clear border iconOnly",type:"submit",children:a?(0,v.jsx)(d.l_A,{}):(0,v.jsx)(d.wEH,{})}),a&&(0,v.jsx)("button",{className:"btn clear border iconOnly",type:"button",onClick:function(){l()},children:(0,v.jsx)(d.aHS,{})})]})]})},Z=function(e){var n=e.edit,a=e.collections,r=e.onSuccess,b=(0,i.useState)((null===n||void 0===n?void 0:n.fields)||[]),x=(0,l.Z)(b,2),h=x[0],g=x[1],_=(0,i.useState)(null),T=(0,l.Z)(_,2),Z=T[0],N=T[1],S=(0,i.useState)(null),C=(0,l.Z)(S,2),F=C[0],O=C[1],q=(0,f.cI)({resolver:(0,o.y)(y)}),I=q.handleSubmit,D=q.register,A=q.reset,w=(q.control,q.watch),k=q.formState.errors,E=q.setError,P=(0,o.i)(s.Hv.adminCollections+"/".concat((null===n||void 0===n?void 0:n._id)||"")),V=P.post,M=P.put,L=(P.loading,w("name")),H=(0,i.useCallback)((function(e){if(!e.name&&L&&(e.name=L),e.name){if(h.length<1)return O("Add at least one field");if("Product"===e.name){if(!h.find((function(e){return"images"===e.name})))return O('"images" is a required field');if(!h.find((function(e){return"title"===e.name})))return O('"title" is a required field');if(!h.find((function(e){return"price"===e.name})))return O('"price" is a required field');if(!h.find((function(e){return"whatsappNumber"===e.name})))return O('"whatsappNumber" is a required field')}(n?M:V)({name:e.name,fields:h.map((function(e){return(0,p.Z)((0,p.Z)({},e),{},{_id:void 0})}))}).then((function(e){var n=e.data;if(!n.success)return(0,c.N)({type:"error",message:n.message});r(n.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}else E("name",{type:"required",message:"Table name is required"})}),[h,L]);return(0,i.useEffect)((function(){h.length>0&&JSON.stringify(h)!==JSON.stringify((null===n||void 0===n?void 0:n.fields)||[])&&H({name:(null===n||void 0===n?void 0:n.name)||""})}),[h,n]),(0,i.useEffect)((function(){A((0,p.Z)({},n))}),[n]),(0,v.jsxs)("div",{className:"grid gap-1 p-1 ".concat(m.addCollectionForm),children:[(0,v.jsx)("form",{onSubmit:I(H),className:"".concat(m.mainForm," grid gap-1"),children:(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({label:"Table Name (singular)",type:"text"},D("name")),{},{required:!0,readOnly:n,error:k.name}))}),(0,v.jsx)("h3",{children:"Fields"}),(0,v.jsx)(u.iA,{className:m.fields,columns:[{label:"Name"}].concat((0,t.Z)("Product"===(null===n||void 0===n?void 0:n.name)?[{label:"Subcategory"}]:[]),[{label:"Data Type"},{label:"Label"},{label:"Field Type"},{label:"Input Type"},{label:"Required"},{label:"Action",action:!0}]),placeholder:"No fields yet.",children:h.map((function(e,a){return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:(0,v.jsx)("span",{className:"ellipsis",children:e.name})}),"Product"===(null===n||void 0===n?void 0:n.name)&&(0,v.jsx)("td",{children:e.subcategory}),(0,v.jsx)("td",{children:e.dataType}),(0,v.jsx)("td",{children:e.label}),(0,v.jsx)("td",{children:e.fieldType}),(0,v.jsx)("td",{children:e.inputType}),(0,v.jsx)("td",{children:e.required?"Yes":"No"}),(0,v.jsx)(u.p2,{actions:[{icon:(0,v.jsx)(d.KHI,{}),label:"Edit",callBack:function(){return N(e)}},{icon:(0,v.jsx)(d.lp8,{}),label:"Delete",callBack:function(){return(0,c.N)({type:"confirmation",message:"Are you sure you want to remove this Field?",callback:function(){g((function(n){return n.filter((function(n){return n.name!==e.name}))}))}})}}]})]},a)}))}),F&&(0,v.jsx)("p",{className:"error",children:F}),(0,v.jsx)(j,{edit:Z,editCollection:n,fields:h,collections:a,productCollection:a.find((function(e){return"Product"===(null===e||void 0===e?void 0:e.name)})),onSuccess:function(e){O(null),Z?(g((function(n){return n.map((function(n){return n.name.toLowerCase()===e.name.toLowerCase()?e:n}))})),N(null)):g((function(n){return[].concat((0,t.Z)(n),[e])}))},clear:function(){return N(null)}},Z?"edit":"add"),(0,v.jsx)("form",{onSubmit:I(H),className:"".concat(m.mainForm," grid gap-1")})]})},N=a(4581),S=a(4942),C=a(7762),F=a(8300),O=function(e){var n=e.collection,a=e.fields,t=e.productCollection,r=e.edit,c=e.loading,d=e.onSubmit,y=(0,i.useState)([]),x=(0,l.Z)(y,2),h=x[0],j=x[1],g=(0,f.cI)({resolver:(0,o.y)(b.Ry((0,p.Z)({},a.map((function(e){var n;return["objectId","string","date"].includes(e.dataType)&&(n=b.Z_()),"number"===e.dataType&&(n=b.Rx().typeError("Please enter a valid number")),"phone"===e.inputType&&(n=b.Z_().phone("Please enter a valid phone number")),["array","variantArray"].includes(e.dataType)&&(n=b.IX(),e.min&&(n=n.min(e.min,"At least ".concat(e.min," items required")))),e.required&&(n=n.required(n.errorMessage||"".concat(e.label," is required"))),n})).reduce((function(e,n,t){var l;return e[null===(l=a[t])||void 0===l?void 0:l.name]=n,e}),{}))))}),_=g.handleSubmit,T=g.register,Z=g.reset,N=g.setValue,C=g.watch,F=g.control,O=g.getValues,I=g.formState.errors,w=("Product"===(null===n||void 0===n?void 0:n.name)?h:a).map((function(e,a){if("Product"===(null===n||void 0===n?void 0:n.name)&&"variants"===e.name)return null;if("object"===e.dataType&&"collectionFilter"===e.fieldType){var l=C(e.name);return(0,v.jsx)(A,{field:e,value:l,productCollection:t,setValue:N},e.name)}if(["array","variantArray"].includes(e.dataType)&&"object"===e.dataElementType){var i=C(e.name);return(0,v.jsx)(D,{collection:n,values:i,field:e,setValue:N},e.name)}return"file"===e.inputType?(0,v.jsx)(u.Dj,{control:F,name:e.name,label:e.label,multiple:e.multiple,thumbnail:!0},e.name):"dateRange"===e.fieldType&&"calendar"===e.inputType?(0,v.jsx)(u.qe,{control:F,label:e.label,name:e.name,dateWindow:e.dateWindow,required:e.required,disabledDates:e.disabledDates||[],multipleRanges:e.multipleRanges},e.name):"input"===e.fieldType?"phone"===e.inputType?(0,v.jsx)(u.C2,{label:e.label,name:e.name,formOptions:{required:e.required},control:F},e.name):(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({},T(e.name)),{},{type:e.inputType||"text",label:e.label,required:e.required,error:I[e.name],autoFocus:0===a}),e.name):"textarea"===e.fieldType?(0,v.jsx)(u.gx,(0,p.Z)((0,p.Z)({},T(e.name)),{},{label:e.label,required:e.required,error:I[e.name],autoFocus:0===a}),e.name):"richText"===e.fieldType?(0,v.jsx)(u.Ho,{control:F,name:e.name,autoFocus:0===a,label:e.label,required:e.required},e.name):"combobox"===e.fieldType?(0,v.jsx)(u.hQ,{label:e.label,control:F,name:e.name,multiple:e.multiple,formOptions:{required:e.required},options:e.options||[]},e.name):"select"===e.fieldType?(0,v.jsx)(u.OC,(0,p.Z)((0,p.Z)((0,p.Z)({control:F,label:e.label},"predefined"===e.optionType&&{options:e.options||[]}),"collection"===e.optionType&&{url:"".concat(s.Hv.adminDynamic,"/").concat(e.collection)}),{},{getQuery:function(n,a){return(0,p.Z)((0,p.Z)({},n&&(0,S.Z)({},e.optionLabel,n)),a&&(0,S.Z)({},e.optionValue,a))},handleData:function(n){return{label:n[e.optionLabel],value:n[e.optionValue]}},multiple:e.multiple,name:e.name,formOptions:{required:e.required},className:m.itemName}),e.name):void 0})),k=C("addVariant"),E=C("category");return(0,i.useEffect)((function(){var e=[{name:"title",required:!0,label:"Title",dataType:"string",fieldType:"input",inputType:"text"},{name:"description",inputType:"text",dataType:"string",fieldType:"textarea",label:"Description",required:!0},{name:"images",required:!0,label:"Images",dataType:"array",fieldType:"input",inputType:"file",dataElementType:"string",multiple:!0},{name:"price",inputType:"number",dataType:"number",fieldType:"input",label:"Price",required:!0,decimalPlaces:"0.00"},{name:"whatsappNumber",required:!0,label:"WhatsApp",dataType:"string",fieldType:"input",inputType:"phone"}],t=(0,p.Z)({},r);r?a.forEach((function(a){if("date"===a.inputType)t[a.name]=(0,u._7)(t[a.name],"YYYY-MM-DD");else if("datetime-local"===a.inputType)t[a.name]=(0,u._7)(t[a.name],"YYYY-MM-DD hh:mm");else if("objectId"===a.dataType&&"object"===typeof r[a.name])t[a.name]=r[a.name][a.optionValue];else if("objectId"===a.dataElementType&&"object"===typeof(r[a.name]||[])[0])t[a.name]=r[a.name].map((function(e){return e[a.optionValue]}));else if("variants"===a.name&&"Product"===(null===n||void 0===n?void 0:n.name)){var l;t.addVariant=!(null===(l=r.variants)||void 0===l||!l.length)}"Store Subcategory"===(null===n||void 0===n?void 0:n.name)&&"fields"===a.name&&(t.fields=r.fields||e)})):"Store Subcategory"===(null===n||void 0===n?void 0:n.name)&&(t.fields=e),Z(t)}),[r]),(0,i.useEffect)((function(){j(E?a.filter((function(e){return!e.category||e.category===E})):a.filter((function(e){return"category"===e.name})))}),[E]),(0,v.jsxs)("form",{onSubmit:_((function(e){if("Product"===(null===n||void 0===n?void 0:n.name)){var a=h.map((function(e){return e.name})),t={};Object.entries(e).filter((function(e){var n=(0,l.Z)(e,2),t=n[0];n[1];return a.includes(t)})).forEach((function(e){var n=(0,l.Z)(e,2),a=n[0],i=n[1];t[a]=i})),d((0,p.Z)((0,p.Z)({},t),{},{_id:(null===r||void 0===r?void 0:r._id)||Math.random().toString(36).substr(-8)}))}else d((0,p.Z)((0,p.Z)({},e),{},{_id:(null===r||void 0===r?void 0:r._id)||Math.random().toString(36).substr(-8)}))})),className:"".concat(m.dynamicForm," grid gap-1 p-1"),children:[w,"Product"===(null===n||void 0===n?void 0:n.name)&&E&&(null===n||void 0===n?void 0:n.fields.some((function(e){return"variantArray"===e.dataType})))&&(0,v.jsx)(u.XZ,(0,p.Z)((0,p.Z)({},T("addVariant")),{},{label:"Add Variant"})),k&&(0,v.jsx)(q,{collection:n,setValue:N,getValues:O}),(0,v.jsx)("div",{className:"btns",children:(0,v.jsx)("button",{className:"btn",disabled:c,children:r?"Update":"Submit"})})]})},q=function(e){var n=e.collection,a=e.setValue,r=e.getValues,o=(0,i.useState)(!1),s=(0,l.Z)(o,2),p=s[0],f=s[1],b=(0,i.useState)(null),y=(0,l.Z)(b,2),x=y[0],h=y[1],j=(0,i.useState)(r("variants")||[]),g=(0,l.Z)(j,2),_=g[0],T=g[1],Z=(0,i.useState)(n.fields.filter((function(e){return"variantArray"===e.dataType}))),N=(0,l.Z)(Z,2),S=N[0];N[1];return(0,v.jsxs)("div",{className:m.productVariants,children:[(0,v.jsxs)("div",{className:"flex justify-space-between mb-1",children:[(0,v.jsx)("h3",{children:"Product Variants"}),(0,v.jsx)("button",{className:"btn",type:"button",onClick:function(){return f(!0)},children:"Add Variant"})]}),(0,v.jsx)(u.iA,{columns:[].concat((0,t.Z)(S.map((function(e){return{label:e.label}}))),[{label:"Price"},{label:"Images"},{label:"Actions"}]),children:_.map((function(e,n){var t,l;return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:e[null===(t=S[0])||void 0===t?void 0:t.name]}),(0,v.jsx)("td",{children:e[null===(l=S[1])||void 0===l?void 0:l.name]}),(0,v.jsx)("td",{children:e.price}),(0,v.jsx)("td",{children:(e.images||[]).length}),(0,v.jsx)(u.p2,{actions:[{icon:(0,v.jsx)(d.KHI,{}),label:"Edit",callBack:function(){h(e),f(!0)}},{icon:(0,v.jsx)(d.lp8,{}),label:"Delete",callBack:function(){return(0,c.N)({type:"confirmation",message:"Are you sure you want to remove this Variant?",callback:function(){T(_.filter((function(n){return n._id!==e._id}))),a("variants",_.filter((function(n){return n._id!==e._id})))}})}}]})]},n)}))}),(0,v.jsx)(c.u,{head:!0,label:"".concat(x?"Update":"Add"," Item"),open:p,setOpen:function(){f(!1),h(null)},className:m.nestedObjectFormModal,children:(0,v.jsx)(I,{edit:x,fields:S,images:r("images"),onSubmit:function(e){x?(T(_.map((function(n){return n._id===e._id?e:n}))),a("variants",_.map((function(n){return n._id===e._id?e:n}))),h(null)):(T([].concat((0,t.Z)(_),[e])),a("variants",[].concat((0,t.Z)(_),[e]))),f(!1)}})})]})},I=function(e){var n=e.edit,a=e.fields,t=e.images,l=e.onSubmit,r=(0,f.cI)({resolver:(0,o.y)(b.Ry({price:b.Rx().typeError("Please enter a valid number")}))}),c=r.handleSubmit,d=r.control,y=r.register,x=r.reset;r.errors;(0,i.useEffect)((function(){n&&x((0,p.Z)({},n))}),[]);var h=a.map((function(e,n){return"combobox"===e.fieldType?(0,v.jsx)(u.hQ,{label:e.label,control:d,name:e.name,formOptions:{required:e.required},options:e.options||[]},e.name):"select"===e.fieldType?(0,v.jsx)(u.OC,(0,p.Z)((0,p.Z)((0,p.Z)({control:d,label:e.label},"predefined"===e.optionType&&{options:e.options}),"collection"===e.optionType&&{url:"".concat(s.Hv.adminDynamic,"/").concat(e.collection)}),{},{getQuery:function(n,a){return(0,p.Z)((0,p.Z)({},n&&(0,S.Z)({},e.optionLabel,n)),a&&(0,S.Z)({},e.optionValue,a))},handleData:function(n){return{label:n[e.optionLabel],value:n[e.optionValue]}},name:e.name,formOptions:{required:e.required},className:m.itemName}),e.name):void 0}));return(0,v.jsxs)("form",{className:"".concat(m.variantForm," p-1 grid gap-1"),onSubmit:c((function(e){l((0,p.Z)((0,p.Z)({},e),{},{_id:(null===n||void 0===n?void 0:n._id)||Math.random().toString(36).substr(-8)}))})),children:[(0,v.jsx)(u.rG,{control:d,label:"Images",name:"images",className:m.variantImages,multiple:!0,selectedClassName:m.selected,options:t.filter((function(e){return"string"===typeof e||"uploadFilePath"in e})).map((function(e){return"string"===typeof e?{value:e}:"uploadFilePath"in e?{value:e.uploadFilePath}:"type"in e&&e.type.startsWith("image")?{value:URL.createObjectURL(e)}:void 0})),renderItem:function(e){return(0,v.jsx)("img",{src:e.value})}}),h,(0,v.jsx)(u.II,(0,p.Z)({label:"Price Difference",type:"number"},y("price"))),(0,v.jsx)("div",{className:"btns",children:(0,v.jsx)("button",{className:"btn",children:n?"Update":"Submit"})})]})},D=function(e){var n=e.collection,a=e.field,r=e.values,o=void 0===r?[]:r,s=e.setValue,p=(0,i.useState)(!1),f=(0,l.Z)(p,2),b=f[0],y=f[1],x=(0,i.useState)(null),h=(0,l.Z)(x,2),g=h[0],_=h[1],T=(0,i.useContext)(N.D).config,Z="Order"===n.name?n.fields.find((function(e){return"products"===e.name})).fields.filter((function(e){return!["product","variant"].includes(e.name)})):null;return(0,v.jsxs)("section",{className:m.nestedTable,onSubmit:function(e){return e.stopPropagation()},children:[(0,v.jsxs)("div",{className:"flex justify-space-between align-center mb-1",children:[(0,v.jsx)("h3",{children:a.label}),!("Order"===n.name&&"products"===a.name)&&(0,v.jsx)("button",{className:"btn",type:"button",onClick:function(){return y(!0)},children:"Add"})]}),"Order"===n.name&&"products"===a.name?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("ul",{className:m.products,children:(o||[]).map((function(e,n){var a,t,l,i;return(0,v.jsxs)("li",{className:m.product,children:[(0,v.jsx)("div",{className:m.thumbnail,children:(0,v.jsx)("img",{src:((null===(a=e.variant)||void 0===a?void 0:a.images)||e.product.images)[0]})}),(0,v.jsxs)("div",{className:m.productDetail,children:[(0,v.jsx)("h3",{children:null===(t=e.product)||void 0===t?void 0:t.title}),(Z||[]).map((function(n){return(0,v.jsxs)("p",{children:[(0,v.jsx)("strong",{children:n.label}),":"," ",(0,v.jsx)("span",{children:e[n.name]})]},n.name)}))]}),(0,v.jsxs)("span",{className:m.price,children:[null===T||void 0===T||null===(l=T.siteConfig)||void 0===l?void 0:l.currency," ",((e.product.price+((null===(i=e.variant)||void 0===i?void 0:i.price)||0))*(e.qty||1)).toLocaleString()]})]},n)}))}),(0,v.jsx)("hr",{}),(0,v.jsxs)("p",{className:m.subtotal,children:["Subtotal (",o.reduce((function(e,n){return e+(n.qty||1)}),0)," item):"," ",(0,v.jsx)("strong",{children:(null===T||void 0===T?void 0:T.siteConfig.currency)+" "+o.reduce((function(e,n){var a;return e+(n.product.price+((null===(a=n.variant)||void 0===a?void 0:a.price)||0))*(n.qty||1)}),0).toLocaleString()})]})]}):(0,v.jsx)(u.tM,{fields:a.fields,data:o,actions:function(e){return[{icon:(0,v.jsx)(d.KHI,{}),label:"Edit",callBack:function(){_(e),y(!0)}},{icon:(0,v.jsx)(d.lp8,{}),label:"Delete",callBack:function(){return(0,c.N)({type:"confirmation",message:"Are you sure you want to remove this Collection?",callback:function(){s(a.name,o.filter((function(n){return n._id!==e._id})))}})}}]}}),(0,v.jsx)(c.u,{head:!0,label:"".concat(g?"Update":"Add"," Item"),open:b,setOpen:function(){y(!1),_(null)},className:m.nestedObjectFormModal,children:"Store Subcategory"===n.name&&"fields"===a.name?(0,v.jsx)(j,{edit:g,fields:o,editCollection:n,onSuccess:function(e){g?(s(a.name,o.map((function(n){return n.name.toLowerCase()===e.name.toLowerCase()?e:n}))),_(null)):s(a.name,[].concat((0,t.Z)(o),[e])),y(!1)}},g?"edit":"add"):(0,v.jsx)(O,{edit:g,fields:a.fields,onSubmit:function(e){g?(s(a.name,o.map((function(n){return n._id===e._id?e:n}))),_(null)):s(a.name,[].concat((0,t.Z)(o),[e])),y(!1)}})})]})},A=function(e){var n=e.field,a=e.value,t=e.productCollection,r=e.setValue,o=(0,i.useState)(!1),s=(0,l.Z)(o,2),d=s[0],p=s[1];return(0,v.jsxs)("section",{className:m.nestedTable,onSubmit:function(e){return e.stopPropagation()},children:[(0,v.jsxs)("div",{className:"flex justify-space-between align-center mb-1",children:[(0,v.jsxs)("h3",{children:[n.label," Filters"]}),(0,v.jsxs)("button",{className:"btn",type:"button",onClick:function(){return p(!0)},children:["Update ",n.label]})]}),(0,v.jsx)(u.iA,{className:m.fields,columns:[{label:"Field"},{label:"Data Type"},{label:"Filter Type"},{label:"value"}],children:Object.entries(a||{}).map((function(e,n){var a,i,r=(0,l.Z)(e,2),o=r[0],c=r[1];return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:o}),(0,v.jsx)("td",{children:null===(a=t.fields.find((function(e){return e.name===o})))||void 0===a?void 0:a.dataType}),(0,v.jsx)("td",{children:c.filterType}),(0,v.jsxs)("td",{children:["minMax"===c.filterType&&(0,v.jsxs)(v.Fragment,{children:["Min: ",c.min,"; Max: ",c.max]}),"arrayContains"===c.filterType&&(0,v.jsxs)(v.Fragment,{children:[(null===(i=c.array)||void 0===i?void 0:i.length)||0," items"]}),"stringContains"===c.filterType&&(0,v.jsx)(v.Fragment,{children:c.text})]})]},n)}))}),(0,v.jsx)(c.u,{head:!0,label:"".concat(n.label," Filters"),open:d,setOpen:function(){p(!1)},className:m.nestedObjectFormModal,children:(0,v.jsx)(w,{productCollection:t,value:a,onSubmit:function(e){r(n.name,e),p(!1)}})})]})},w=function(e){var n=e.value,a=void 0===n?{}:n,t=e.productCollection,r=e.onSubmit,o=(0,f.cI)(),c=o.handleSubmit,d=o.register,b=o.control,y=o.watch,x=o.reset,h=o.formState.errors,j=y("fields");return(0,i.useEffect)((function(){var e={fields:Object.keys(a)};Object.entries(a).forEach((function(n){var a=(0,l.Z)(n,2),i=a[0],r=a[1],o=t.fields.find((function(e){return e.name===i}));o&&("number"===o.dataType&&"minMax"===r.filterType?(e[i+"___min"]=r.min||"",e[i+"___max"]=r.max||""):"string"===o.dataType&&["input","textarea"].includes(o.fieldType)?e[i]=r.text:("combobox"===o.fieldType||"select"===o.fieldType)&&(e[i]=r.array))})),x(e)}),[]),(0,v.jsxs)("form",{onSubmit:c((function(e){var n={};Object.entries(e).forEach((function(a){var i=(0,l.Z)(a,2),r=i[0],o=i[1],c=r.split("___"),s=(0,l.Z)(c,2),u=s[0],d=s[1];if(d&&(r=u),e.fields.includes(r)){var m=t.fields.find((function(e){return e.name===r}));m&&("string"===m.dataType&&["input","textarea"].includes(m.fieldType)?n[r]={filterType:"stringContains",text:o}:"number"===m.dataType?n[u]=(0,p.Z)((0,p.Z)({},n[u]),{},(0,S.Z)({filterType:"minMax"},d,+o)):["string","objectId"].includes(m.dataType)&&"select"===m.fieldType&&(n[r]={filterType:"arrayContains",array:o}))}})),r(n)})),className:"grid gap-1 p-1",children:[(0,v.jsx)(u.rG,{control:b,name:"fields",className:m.itemColumnsRadio,multiple:!0,label:"Fields",options:t.fields.filter((function(e){return!("file"===e.inputType||"calendar"===e.inputType)})).map((function(e){return{label:e.label,value:e.name}}))}),(j||[]).map((function(e,n){var a=t.fields.find((function(n){return n.name===e}));if(a)return"string"===a.dataType&&["input","textarea"].includes(a.fieldType)?(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({},d(a.name)),{},{type:"text",label:"".concat(a.label," contains"),required:a.required,error:h[a.name]}),n):"number"===a.dataType?(0,v.jsxs)("div",{className:"flex gap-1",children:[(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({className:"all-columns"},d(a.name+"___min")),{},{type:"number",label:"Minimum ".concat(a.label),required:a.required,error:h[a.name+"___min"]})),(0,v.jsx)(u.II,(0,p.Z)((0,p.Z)({className:"all-columns"},d(a.name+"___max")),{},{type:"number",label:"Maximum ".concat(a.label),required:a.required,error:h[a.name+"___max"]}))]},n):"select"===a.fieldType?(0,v.jsx)(u.OC,(0,p.Z)((0,p.Z)((0,p.Z)({control:b,label:a.label,multiple:!0},"predefined"===a.optionType&&{options:a.options}),"collection"===a.optionType&&{url:"".concat(s.Hv.adminDynamic,"/").concat(a.collection)}),{},{getQuery:function(e,n){return(0,p.Z)((0,p.Z)({},e&&(0,S.Z)({},a.optionLabel,e)),n&&(0,S.Z)({},a.optionValue,n))},handleData:function(e){return{label:e[a.optionLabel],value:e[a.optionValue]}},name:a.name,formOptions:{required:!0},className:m.itemName}),n):"combobox"===a.fieldType?(0,v.jsx)(u.hQ,{label:a.label,control:b,name:a.name,multiple:!0,formOptions:{required:!0},options:a.options||[]},n):void 0})),(0,v.jsx)("div",{className:"flex justify-center",children:(0,v.jsx)("button",{className:"btn",children:"Update"})})]})},k=function(e){var n=e.collection,a=e.productCollection,t=e.edit,l=e.onSuccess,i=(0,o.i)("".concat(s.Hv.adminDynamic,"/").concat(n.name,"/").concat((null===t||void 0===t?void 0:t._id)||"")),r=i.post,u=i.put,d=i.loading;return(0,v.jsx)("div",{className:"grid gap-1",children:(0,v.jsx)(O,{collection:n,fields:n.fields,productCollection:a,edit:t,loading:d,onSubmit:function(e){var a=(0,p.Z)({},e);"Product"===n.name&&"variants"in a&&(a.variants=JSON.stringify(a.variants)),n.fields.some((function(e){return"object"===e.dataType}))&&n.fields.filter((function(e){return"object"===e.dataType})).forEach((function(n){e[n.name]&&(a[n.name]=JSON.stringify(e[n.name]))})),(0,F.Ty)("_id",a).forEach((function(e){e.path.reduce((function(e,n,a,t){return a===t.length-1&&e[n].length<=20&&delete e[n],e[n]}),a)})),n.fields.some((function(e){return"file"===e.inputType}))&&(a=new FormData,n.fields.forEach((function(t){if("Product"!==n.name||"variants"!==t.name){var l=e[t.name];if(void 0!==l)if("file"===t.inputType&&l.length){var i,r=(0,C.Z)(l);try{for(r.s();!(i=r.n()).done;){var o=i.value;a.append("".concat(t.name),o.uploadFilePath||o)}}catch(d){r.e(d)}finally{r.f()}}else if(["array","variantArray"].includes(t.dataType)){var c,s=(0,C.Z)(l);try{for(s.s();!(c=s.n()).done;){var u=c.value;a.append("".concat(t.name),u)}}catch(d){s.e(d)}finally{s.f()}}else{if("object"!==t.dataType)return a.append(t.name,l);a.append("".concat(t.name),JSON.stringify(l))}}})),"Product"===n.name&&"variants"in e&&a.append("variants",JSON.stringify(e.variants))),(t?u:r)(a).then((function(e){var n=e.data;if(!n.success)return(0,c.N)({type:"error",message:n.message});l(n.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}})})},E=function(){var e=(0,i.useState)({}),n=(0,l.Z)(e,2),a=n[0],f=n[1],b=(0,i.useContext)(N.D),y=b.business,x=b.checkPermission,h=(0,i.useState)([]),j=(0,l.Z)(h,2),g=(j[0],j[1]),_=(0,i.useState)(null),T=(0,l.Z)(_,2),Z=T[0],S=T[1],C=(0,i.useState)(!1),F=(0,l.Z)(C,2),O=F[0],q=F[1],I=(0,i.useState)(null),D=(0,l.Z)(I,2),A=D[0],w=D[1],E=(0,i.useState)(null),P=(0,l.Z)(E,2),V=P[0],M=P[1],L=(0,r.s0)(),H=(0,r.UO)()["*"],R=(0,o.i)("".concat(s.Hv.adminCollections,"/").concat(H)),B=R.get,Q=R.loading,U=(0,o.i)("".concat(s.Hv.adminCollections,"/Product")),Y=U.get,W=(U.loading,(0,o.i)("".concat(s.Hv.adminDynamic,"/").concat(H,"/{ID}")).remove);return(0,i.useEffect)((function(){B().then((function(e){var n=e.data;if(n.success){for(var a=[],t=function(e){var t={};n.data.fields.forEach((function(n){var a,l,i;return"date"===n.dataType?t[n.name]=(new Date).toISOString().substring(0,10):"number"===n.dataType?t[n.name]=+(1e3*Math.random()).toFixed(0)+1e3:"objectId"===n.dataType?t[n.name]=(new Date).getTime().toString(16)+(+(1e19*Math.random()).toFixed(0)).toString(16):["combobox","select"].includes(n.fieldType)&&null!==(a=n.options)&&void 0!==a&&a.length?t[n.name]=(null===(l=n.options[e])||void 0===l?void 0:l.value)||(null===(i=n.options[0])||void 0===i?void 0:i.value):void(t[n.name]="".concat(n.label," ").concat(e))})),a.push(t)},l=0;l<5;l++)t(l);return g(a),w(n.data)}})).catch((function(e){return(0,c.N)({type:"error",message:e.message})})),"Campaign"===H&&Y().then((function(e){var n=e.data;if(n.success)return M(n.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[]),(0,v.jsxs)("div",{className:"".concat(m.content," grid gap-1 m-a p-1"),children:[(0,v.jsxs)("div",{className:"flex justify-space-between",children:[(0,v.jsx)("h2",{children:H}),(0,v.jsxs)("div",{className:"flex gap-1",children:[(0,v.jsx)("button",{className:"btn m-a mr-0",onClick:function(){return L(s.Hb.dashboard.replace("*","")+s.Hb.dynamicTables.replace("/*",""))},children:"Back"}),x("".concat(null===y||void 0===y?void 0:y.business._id,"_").concat(H,"_create"))&&(0,v.jsxs)("button",{className:"btn m-a mr-0",onClick:function(){return q(!0)},children:["Add ",H]})]})]}),(0,v.jsx)(u.tM,{admin:!0,fields:null===A||void 0===A?void 0:A.fields,loading:Q,url:"".concat(s.Hv.adminDynamic,"/").concat(H),filters:a,pagination:!0,actions:function(e){return[].concat((0,t.Z)(x("".concat(null===y||void 0===y?void 0:y.business._id,"_").concat(H,"_update"))?[{icon:(0,v.jsx)(d.KHI,{}),label:"Edit",callBack:function(){S(e),q(!0)}}]:[]),(0,t.Z)(x("".concat(null===y||void 0===y?void 0:y.business._id,"_").concat(H,"_delete"))?[{icon:(0,v.jsx)(d.lp8,{}),label:"Delete",callBack:function(){return(0,c.N)({type:"confirmation",message:"Are you sure you want to remove this Collection?",callback:function(){W({},{params:{"{ID}":e._id}}).then((function(e){var n=e.data;n.success?f((function(e){return(0,p.Z)({},e)})):(0,c.N)({type:"error",message:n.message})}))}})}}]:[]))}}),(0,v.jsx)(c.u,{head:!0,label:"".concat(Z?"Update":"Add"," ").concat((null===A||void 0===A?void 0:A.name)||"Collection"),open:O,setOpen:function(){q(!1),S(null)},className:m.dynamicFormModal,children:(0,v.jsx)(k,(0,p.Z)((0,p.Z)({edit:Z,collection:A},["Campaign","Order"].includes(null===A||void 0===A?void 0:A.name)&&{productCollection:V}),{},{onSuccess:function(e){Z?(f((function(e){return(0,p.Z)({},e)})),S(null)):f((function(e){return(0,p.Z)({},e)})),q(!1)}}))})]})},P=(b.Ry({schema_id:b.Z_().required()}),function(){var e=(0,i.useContext)(N.D).checkPermission,n=(0,i.useState)(null),a=(0,l.Z)(n,2),p=a[0],f=a[1],b=(0,i.useState)(!1),y=(0,l.Z)(b,2),x=y[0],h=y[1],j=(0,i.useState)(!1),g=(0,l.Z)(j,2),_=(g[0],g[1],(0,i.useState)([])),T=(0,l.Z)(_,2),S=T[0],C=T[1],F=(0,o.i)(s.Hv.adminCollections),O=F.get,q=F.loading,I=(0,o.i)(s.Hv.adminCollections+"/{ID}"),D=I.remove,A=I.loading,w=(0,r.s0)(),k=(0,r.UO)()["*"],P=(0,i.useCallback)((function(){O().then((function(e){var n=e.data;if(n.success)return C(n.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[]);return(0,i.useEffect)((function(){P()}),[]),k?(0,v.jsx)(E,{}):(0,v.jsxs)("div",{className:"".concat(m.content," grid gap-1 m-a p-1"),children:[(0,v.jsxs)("div",{className:"flex justify-space-between",children:[(0,v.jsx)("h2",{children:"All Tables"}),(0,v.jsx)("div",{className:"flex gap-1",children:(0,v.jsx)("button",{className:"btn m-a mr-0",onClick:function(){return h(!0)},children:"Add Table"})})]}),(0,v.jsx)(u.iA,{loading:q,className:m.collections,columns:[{label:"Name"},{label:"Action"}],children:S.map((function(n,a){return(0,v.jsxs)("tr",{onClick:function(e){"TD"===e.target.tagName&&w(s.Hb.dynamicTable.replace(":table",n.name))},children:[(0,v.jsx)("td",{children:n.name}),(0,v.jsx)(u.p2,{actions:[].concat((0,t.Z)(e("dynamic_table_update")?[{icon:(0,v.jsx)(d.KHI,{}),label:"Edit",callBack:function(){f(n),h(!0)}}]:[]),(0,t.Z)(e("dynamic_table_delete")?[{icon:(0,v.jsx)(d.lp8,{}),label:"Delete",disabled:A,callBack:function(){return(0,c.N)({type:"confirmation",message:"Are you sure you want to remove this Collection?",callback:function(){D({},{params:{"{ID}":n._id}}).then((function(e){var a=e.data;null!==a&&void 0!==a&&a.success&&C((function(e){return e.filter((function(e){return e._id!==n._id}))}))})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}})}}]:[]))})]},a)}))}),(0,v.jsx)(c.u,{head:!0,label:"".concat(p?"Update":"Add"," Table"),open:x,setOpen:function(){h(!1),f(null)},className:m.collectionFormModal,children:(0,v.jsx)(Z,{collections:S,edit:p,onSuccess:function(e){p?(C((function(n){return n.map((function(n){return n._id.toLowerCase()===p._id.toLowerCase()?e:n}))})),f(e)):(f(e),C((function(n){return[].concat((0,t.Z)(n),[e])})))}})})]})})}}]);
//# sourceMappingURL=303.2dfc93e0.chunk.js.map