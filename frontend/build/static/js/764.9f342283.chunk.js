"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[764],{9764:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var a=t(2982),l=t(1413),r=t(885),s=t(2791),i=t(5470),c=t(8750),o="quotes_content__d6QGt",u="quotes_innerWrapper__0o8+D",d="quotes_sidebar__OueuR",p="quotes_addButton__XE+Gn",h="quotes_btns__y2nuy",m="quotes_listItem__ityEv",v="quotes_label__VuSPM",x="quotes_accountName__zyenQ",_="quotes_nestedList__B-cIy",f="quotes_open__aa1x+",b="quotes_innerContent__wCHU6",j="quotes_innerContentWrapper__rKsb7",g="quotes_vouchers__t8sKZ",N="quotes_footer__AWxAV",y="quotes_masterFormModal__36AN0",S="quotes_masterForm__dXJKs",q="quotes_head__uo7Hz",C=t(5454),k=t(1080),Z=t(1134),T=t(1570),A=t(184),B=T.Ry({name:T.Z_().required("Please enter a name"),parent:T.Z_(),type:T.Z_().oneOf(["Cash","Bank","Customers","Suppliers","Sales","Purchase","Stock","null","Tax",null]).nullable(),isGroup:T.O7().required(),openingBalance:T.Rx().required("Please enter opening balance").typeError("Please enter a valid number")}),G=function(e){var n=e.edit,t=e.masters,r=void 0===t?[]:t,o=e.onSuccess,u=(0,Z.cI)({resolver:(0,C.y)(B)}),d=u.handleSubmit,p=u.register,h=u.reset,m=u.control,v=u.formState.errors,x=(0,C.i)(k.Hv.accountingMasters+"/".concat((null===n||void 0===n?void 0:n._id)||"")),_=x.post,f=x.put,b=x.loading;return(0,s.useEffect)((function(){var e;h({name:(null===n||void 0===n?void 0:n.name)||"",parent:(null===n||void 0===n?void 0:n.parent)||"null",type:(null===n||void 0===n?void 0:n.type)||"null",isGroup:null===(e=null===n||void 0===n?void 0:n.isGroup)||void 0===e||e,openingBalance:(null===n||void 0===n?void 0:n.openingBalance)||0})}),[n]),(0,A.jsxs)("form",{onSubmit:d((function(e){"null"===e.parent&&(e.parent=null),"null"===e.type&&(e.type=null),(null!==n&&void 0!==n&&n._id?f:_)(e).then((function(e){var n=e.data;if(!n.success)return(0,c.N)({type:"error",message:n.message});o(n.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))})),className:"".concat(S," grid gap-1"),children:[(0,A.jsx)(i.II,(0,l.Z)((0,l.Z)({label:"Name"},p("name")),{},{required:!0,error:v.name})),(0,A.jsx)(i.hQ,{label:"Parent",name:"parent",control:m,options:[{label:"None",value:"null"}].concat((0,a.Z)(r.map((function(e){return{label:e.name,value:e._id}}))))}),(0,A.jsx)(i.hQ,{label:"Type",name:"type",control:m,options:[{label:"None",value:"null"},{label:"Cash",value:"Cash"},{label:"Bank",value:"Bank"},{label:"Customers",value:"Customers"},{label:"Suppliers",value:"Suppliers"},{label:"Sales",value:"Sales"},{label:"Purchase",value:"Purchase"},{label:"Stock",value:"Stock"},{label:"Tax",value:"Tax"}]}),(0,A.jsx)(i.hQ,{label:"Is Group",name:"isGroup",control:m,formOptions:{required:!0},options:[{label:"No",value:!1},{label:"Yes",value:!0}]}),(0,A.jsx)(i.II,(0,l.Z)((0,l.Z)({label:"Opening Balance",type:"number"},p("openingBalance")),{},{required:!0,error:v.openingBalance})),(0,A.jsx)("div",{className:"btns",children:(0,A.jsx)("button",{className:"btn",disabled:b,children:null!==n&&void 0!==n&&n._id?"Update":"Submit"})})]})},P=t(5804),I=t(3974),M=t(1765),D=t(4794),E=function e(n){var t=n.account,a=n.setAddMaster,l=n.onClick,i=void 0===l?function(){}:l,o=(0,s.useState)(t.children||[]),u=(0,r.Z)(o,2),d=u[0],f=u[1],b=(0,s.useState)(!(null===t||void 0===t||!t.isGroup)&&d.length>0),j=(0,r.Z)(b,2),g=j[0],N=j[1],y=(0,C.i)(k.Hv.accountingMasters),S=y.get,q=y.loading;return(0,A.jsxs)("li",{style:{whiteSpace:"nowrap"},className:m,children:[(0,A.jsxs)("div",{className:v,children:[t.isGroup&&(0,A.jsx)(A.Fragment,{children:((null===d||void 0===d?void 0:d.length)||t.totalChildren)>0?(0,A.jsx)("button",{onClick:function(){(null===d||void 0===d?void 0:d.length)===t.totalChildren?N(!g):S({query:{parent:t._id}}).then((function(e){var n=e.data;n.success?(f(n.data),N(!0)):(0,c.N)({type:"error",message:n.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))},children:q?(0,A.jsx)(D.frZ,{className:"spin"}):g?(0,A.jsx)(P.IgQ,{}):(0,A.jsx)(P.b5v,{})}):(0,A.jsx)("button",{style:{height:"16px",width:"16px",border:"1px dashed #818181",borderRadius:"2px",pointerEvents:"none"}})}),(0,A.jsx)("strong",{className:t.isGroup?"":x,onClick:function(){t.isGroup||i(t)},children:t.name}),(0,A.jsxs)("div",{className:h,children:[(0,A.jsx)("button",{className:p,onClick:function(){return a(t)},children:(0,A.jsx)(I.Nte,{})}),t.isGroup&&(0,A.jsx)("button",{className:p,onClick:function(){return a({parent:t._id,type:t.type||""})},children:(0,A.jsx)(P.iTs,{})})]})]}),g&&d.length>0&&(0,A.jsx)("ul",{className:_,children:d.map((function(n){return(0,A.jsx)(e,{account:n,setAddMaster:a,onClick:i},n._id)}))})]})},F=function(e){var n=e.setSidebarOpen,t=(0,s.useState)(null),h=(0,r.Z)(t,2),m=h[0],v=h[1],x=(0,s.useState)([]),_=(0,r.Z)(x,2),S=_[0],Z=_[1],T=(0,s.useState)("voucherListing"),B=(0,r.Z)(T,2),I=B[0],D=B[1],F=(0,s.useState)(!1),O=(0,r.Z)(F,2),R=O[0],w=O[1],Q=(0,s.useState)({}),H=(0,r.Z)(Q,2),W=H[0],L=H[1],Y=(0,C.i)(k.Hv.accountingMasters).get,z=(0,s.useMemo)((function(){return function(e){var n={};e.forEach((function(e){e.children=[],n[e._id]=e}));var t=[];return e.forEach((function(e){if(e.parent){var a=n[e.parent];a&&a.children.push(e)}else t.push(e)})),t}(S)}),[S]);return(0,s.useEffect)((function(){Y({query:{isGroup:"true"}}).then((function(e){var n=e.data;if(n.success)return Z(n.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[]),(0,A.jsxs)("div",{className:"".concat(o," grid gap-1 m-a"),children:[(0,A.jsx)("div",{className:"flex ".concat(q),children:(0,A.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return n((function(e){return!e}))},children:[(0,A.jsx)(P.Ps6,{style:{fontSize:"1.75rem"}}),(0,A.jsx)("h2",{children:"Accounting"})]})}),(0,A.jsxs)("div",{className:"".concat(u," ").concat(R?f:""),children:[(0,A.jsxs)("div",{className:d,children:[(0,A.jsx)("button",{className:p,onClick:function(){return v({})},children:(0,A.jsx)(P.iTs,{})}),(0,A.jsx)("ul",{children:S.length>0?z.map((function(e){return(0,A.jsx)(E,{account:e,setAddMaster:v,onClick:function(e){return L((function(n){return(0,l.Z)((0,l.Z)({},n),{},{accountId:e._id})}))}},e._id)})):(0,A.jsx)("p",{style:{marginTop:"1rem",marginBottom:"1rem",textAlign:"center",textWrap:"balance",color:"#797979"},children:"No accounts have been added yet."})})]}),(0,A.jsxs)("div",{className:b,children:[(0,A.jsxs)("div",{className:"flex gap-1 align-center",children:[(0,A.jsx)("button",{className:"btn clear iconOnly",onClick:function(){return w(!R)},children:(0,A.jsx)(M.kpB,{})}),(0,A.jsx)(i.mQ,{activeTab:I,tabs:[{label:"Voucher Listing",value:"voucherListing"}],onChange:function(e){return D(e.value)}})]}),"voucherListing"===I&&(0,A.jsx)("div",{className:j,children:(0,A.jsx)(i.iA,{url:k.Hv.accountingVouchers,countRecord:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,n,t,a){var l;return e+((null===(l=a[t-1])||void 0===l?void 0:l.rec_id)!==n.rec_id?1:0)}),0)},filters:W,filterFields:[{label:"Type",fieldType:"select",name:"type",optionType:"predefined",options:[{label:"Invoice",value:"Invoice"},{label:"Purchase",value:"Purchase"},{label:"Receipt",value:"Receipt"},{label:"Payment",value:"Payment"}]},{label:"Start Date",fieldType:"input",inputType:"datetime-local",name:"startDate"},{label:"End Date",fieldType:"input",inputType:"datetime-local",name:"endDate"}],className:g,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Account Name"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"}],renderRow:function(e,n,t){var a,l,r;return(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"grid",children:(null===(a=t[n-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(i.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,A.jsx)(i.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,A.jsx)("td",{children:(null===(l=t[n-1])||void 0===l?void 0:l.rec_id)!==e.rec_id&&e.no}),(0,A.jsx)("td",{children:(null===(r=t[n-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&e.type}),(0,A.jsx)("td",{children:e.accountName}),(0,A.jsx)("td",{className:"text-right",children:e.debit?e.debit.toFixed(2):null}),(0,A.jsx)("td",{className:"text-right",children:e.credit?e.credit.toFixed(2):null})]},n)},tfoot:function(e){return(0,A.jsx)("tfoot",{children:(0,A.jsxs)("tr",{className:N,children:[(0,A.jsx)("td",{}),(0,A.jsx)("td",{}),(0,A.jsx)("td",{}),(0,A.jsx)("td",{className:"text-right",children:"Total"}),(0,A.jsx)("td",{className:"text-right",children:e.reduce((function(e,n){return e+n.debit}),0).toFixed(2)}),(0,A.jsx)("td",{className:"text-right",children:e.reduce((function(e,n){return e+n.credit}),0).toFixed(2)})]})})}})})]})]}),(0,A.jsx)(c.u,{open:m,head:!0,label:"".concat(null!==m&&void 0!==m&&m._id?"Update":"Add"," Account"),className:y,setOpen:function(){v(null)},children:(0,A.jsx)(G,{edit:m,masters:S,onSuccess:function(e){null!==m&&void 0!==m&&m._id?Z((function(n){return n.map((function(n){return n._id===e._id?e:n}))})):Z((function(n){return[].concat((0,a.Z)(n),[e])})),v(!1)}})})]})}}}]);
//# sourceMappingURL=764.9f342283.chunk.js.map