"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[977],{977:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var r=n(1413),a=n(2982),s=n(885),i=n(2791),c=n(5470),o=n(8750),l={content:"quotes_content__niBb4",innerWrapper:"quotes_innerWrapper__eqA-i",sidebar:"quotes_sidebar__J-8f3",addButton:"quotes_addButton__u9EdI",btns:"quotes_btns__4+XC2",listItem:"quotes_listItem__WD70k",label:"quotes_label__KbFIm",accountName:"quotes_accountName__7d1uP",highlight:"quotes_highlight__oAB8h",nestedList:"quotes_nestedList__hnP2n",open:"quotes_open__1j-GY",innerContent:"quotes_innerContent__AASR0",innerContentWrapper:"quotes_innerContentWrapper__wL0J2",vouchers:"quotes_vouchers__B6a0g",footer:"quotes_footer__NlFGZ",ledgers:"quotes_ledgers__uY7N8",closing:"quotes_closing__wlH0o",analysysPlaceholder:"quotes_analysysPlaceholder__WFSHT",entryForm:"quotes_entryForm__oFShb",voucherFilters:"quotes_voucherFilters__Mobw4",masterFormModal:"quotes_masterFormModal__mLMGL",masterForm:"quotes_masterForm__peHJD",head:"quotes_head__x3HSY"},u=n(5454),d=n(1080),h=n(1134),m=n(1570),f=n(184),p=m.Ry({name:m.Z_().required("Please enter a name")}),x=function(e){var t=e.edit,n=e.onSuccess,a=(0,h.cI)({resolver:(0,u.y)(p)}),s=a.handleSubmit,m=a.register,x=a.reset,v=a.formState.errors,g=(0,u.i)(d.Hv.inventoryBranches+"/".concat((null===t||void 0===t?void 0:t._id)||"")),_=g.post,b=g.put,j=g.loading;return(0,i.useEffect)((function(){x({name:(null===t||void 0===t?void 0:t.name)||""})}),[t]),(0,f.jsxs)("form",{onSubmit:s((function(e){(null!==t&&void 0!==t&&t._id?b:_)({name:e.name}).then((function(e){var t=e.data;if(!t.success)return(0,o.N)({type:"error",message:t.message});n(t.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))})),className:"".concat(l.masterForm," grid gap-1"),children:[(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Name"},m("name")),{},{required:!0,error:v.name})),(0,f.jsx)("div",{className:"btns",children:(0,f.jsx)("button",{className:"btn",disabled:j,children:null!==t&&void 0!==t&&t._id?"Update":"Submit"})})]})},v=n(2942),g=m.Ry({name:m.Z_().required("Please enter a name"),isGroup:m.O7().required(),parent:m.Z_().when("isGroup",{is:!1,then:function(e){return e.required("Please select a group.")},otherwise:function(e){return e}})}),_=function(e){var t=e.edit,n=e.masters,m=void 0===n?[]:n,p=e.onSuccess,x=(0,i.useState)([]),_=(0,s.Z)(x,2),b=_[0],j=_[1],y=(0,h.cI)({resolver:(0,u.y)(g)}),N=y.handleSubmit,S=y.register,Z=y.reset,D=y.control,k=y.setValue,C=y.setError,q=y.watch,I=y.clearErrors,w=y.formState.errors,F=q("isGroup"),M=(0,u.i)(d.Hv.inventoryMasters+"/".concat((null===t||void 0===t?void 0:t._id)||"")),Y=M.post,G=M.put,A=M.loading;return(0,i.useEffect)((function(){var e,n,r,a,s={name:(null===t||void 0===t?void 0:t.name)||"",parent:(null===t||void 0===t?void 0:t.parent)||"",isGroup:null===(e=null===t||void 0===t?void 0:t.isGroup)||void 0===e||e};null!==t&&void 0!==t&&null!==(n=t.openingStocks)&&void 0!==n&&n.length?null===t||void 0===t||null===(a=t.openingStocks)||void 0===a||a.forEach((function(e,t){s["entries_".concat(t,"_branch")]=e.branch,s["entries_".concat(t,"_openingStock")]=e.openingStock,s["entries_".concat(t,"_cost")]=e.cost,s["entries_".concat(t,"_reorderQty")]=e.reorderQty})):(s.entries_0_branch="",s.entries_0_openingStock="",s.entries_0_cost="",s.entries_0_reorderQty="");Z(s),j(null!==t&&void 0!==t&&null!==(r=t.openingStocks)&&void 0!==r&&r.length?null===t||void 0===t?void 0:t.openingStocks:[{_id:Math.random().toString(36),branch:"",openingStock:"",reorderQty:""}])}),[t]),(0,f.jsxs)("form",{onSubmit:N((function(e){if(e.isGroup||!b.some((function(e,t){return!(e.branch&&e.openingStock&&e.cost&&e.reorderQty)&&(e.branch||C("entries_".concat(t,"_branch"),{type:"custom",message:"Name is required."}),e.openingStock||C("entries_".concat(t,"_openingStock"),{type:"custom",message:"Stock is required."}),e.cost||C("entries_".concat(t,"_cost"),{type:"custom",message:"Cost is required."}),e.reorderQty||C("entries_".concat(t,"_reorderQty"),{type:"custom",message:"Reorder QTY is required."}),!0)}))){e.parent||(e.parent=null);var n={name:e.name,isGroup:e.isGroup,parent:e.parent,type:e.type};e.isGroup||(n.openingStocks=b.map((function(e){return{branch:e.branch,openingStock:e.openingStock,cost:e.cost,reorderQty:e.reorderQty}}))),(null!==t&&void 0!==t&&t._id?G:Y)(n).then((function(e){var t=e.data;if(!t.success)return(0,o.N)({type:"error",message:t.message});p(t.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}})),className:"".concat(l.masterForm," grid gap-1"),children:[(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Name"},S("name")),{},{required:!0,error:w.name})),(0,f.jsx)(c.hQ,{label:"Parent",name:"parent",control:D,formOptions:{required:!F},placeholder:"",options:[{label:"None",value:""}].concat((0,a.Z)(m.map((function(e){return{label:e.name,value:e._id}}))))}),(0,f.jsx)(c.hQ,{label:"Is Group",name:"isGroup",control:D,formOptions:{required:!0},options:[{label:"No",value:!1},{label:"Yes",value:!0}]}),!F&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h3",{children:"Opening Stocks"}),(b||[]).map((function(e,t){return(0,f.jsxs)("div",{className:l.entryForm,children:[(0,f.jsx)(c.OC,{label:"Branch",control:D,name:"entries_".concat(t,"_branch"),formOptions:{required:!0},url:d.Hv.inventoryBranches,getQuery:function(e){return{name:e}},handleData:function(e){return{label:e.name,value:e._id}},onChange:function(n){I("entries_".concat(t,"_openingStock")),j((function(t){return t.map((function(t){return t._id===e._id?(0,r.Z)((0,r.Z)({},t),{},{branch:n.value}):t}))}))}}),(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Opening Stock",type:"number",required:!0},S("entries_".concat(t,"_openingStock"))),{},{onChange:function(n){I("entries_".concat(t,"_openingStock")),j((function(t){return t.map((function(t){return t._id===e._id?(0,r.Z)((0,r.Z)({},t),{},{openingStock:n.target.value}):t}))}))},error:w["entries_".concat(t,"_openingStock")]})),(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Cost",type:"number",required:!0},S("entries_".concat(t,"_cost"))),{},{onChange:function(n){I("entries_".concat(t,"_cost")),j((function(t){return t.map((function(t){return t._id===e._id?(0,r.Z)((0,r.Z)({},t),{},{cost:n.target.value}):t}))}))},error:w["entries_".concat(t,"_cost")]})),(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Reorder QTY",type:"number",required:!0},S("entries_".concat(t,"_reorderQty"))),{},{onChange:function(n){I("entries_".concat(t,"_reorderQty")),j((function(t){return t.map((function(t){return t._id===e._id?(0,r.Z)((0,r.Z)({},t),{},{reorderQty:n.target.value}):t}))}))},error:w["entries_".concat(t,"_reorderQty")]})),(null===b||void 0===b?void 0:b.length)>1&&(0,f.jsx)("button",{type:"button",onClick:function(){return j((function(t){return t.filter((function(t){return t._id!==e._id}))}))},className:"btn clear iconOnly",children:(0,f.jsx)(v.K3i,{})})]},e._id)})),!A&&(0,f.jsx)("button",{type:"button",className:"btn secondary",onClick:function(){k("entries_".concat(b.length,"_type"),"credit"),j((function(e){return[].concat((0,a.Z)(e),[{_id:Math.random().toString(36),type:"credit",accountId:"",debit:"",credit:""}])}))},children:"Add More Stock"})]}),(0,f.jsx)("div",{className:"btns",children:(0,f.jsx)("button",{className:"btn",disabled:A,children:null!==t&&void 0!==t&&t._id?"Update":"Submit"})})]})},b=n(5804),j=n(3974),y=n(1765),N=n(4794),S=n(4581),Z=function(e){e.filters;var t=e.setFilters,n=(0,i.useContext)(S.D).finPeriod,a=(0,h.cI)(),s=a.handleSubmit,o=a.register,u=a.reset,d=a.control,m=a.formState.errors;return(0,f.jsxs)("form",{onSubmit:s((function(e){var n={};e.type&&(n.type=e.type),e.startDate&&e.endDate&&(n.startDate=e.startDate,n.endDate=e.endDate),t(n)})),className:"".concat(l.voucherFilters," grid gap-1"),children:[(0,f.jsx)(c.hQ,{label:"Type",name:"type",control:d,options:[{label:"Invoice",value:"Invoice"},{label:"Sales Return",value:"Sales Return"},{label:"Purchase",value:"Purchase"},{label:"Purchase Return",value:"Purchase Return"}]}),(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({label:"Start Date",type:"date"},o("startDate")),n&&{min:(0,c._7)(n.startDate,"YYYY-MM-DD")}),n&&{max:(0,c._7)(n.endDate,"YYYY-MM-DD")}),{},{required:!0,error:m.startDate})),(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({label:"End Date",type:"date"},o("endDate")),n&&{min:(0,c._7)(n.startDate,"YYYY-MM-DD")}),n&&{max:(0,c._7)(n.endDate,"YYYY-MM-DD")}),{},{required:!0,error:m.endDate})),(0,f.jsxs)("div",{className:"flex gap-1",children:[(0,f.jsx)("button",{className:"btn",children:"Search"}),(0,f.jsx)("button",{className:"btn secondary",type:"button",onClick:function(){u(),t({})},children:"Clear"})]})]})},D=function(e){e.filters;var t=e.setFilters,n=((0,i.useContext)(S.D).finPeriod,(0,h.cI)()),a=n.handleSubmit,s=n.register,o=n.reset,u=n.formState.errors;return(0,f.jsxs)("form",{onSubmit:a((function(e){var n={};e.type&&(n.type=e.type),e.startDate&&e.endDate&&(n.startDate=e.startDate,n.endDate=e.endDate),t(n)})),className:"".concat(l.voucherFilters," grid gap-1"),children:[(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Start Date",type:"date"},s("startDate")),{},{required:!0,error:u.startDate})),(0,f.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"End Date",type:"date"},s("endDate")),{},{required:!0,error:u.endDate})),(0,f.jsxs)("div",{className:"flex gap-1",children:[(0,f.jsx)("button",{className:"btn",children:"Search"}),(0,f.jsx)("button",{className:"btn secondary",type:"button",onClick:function(){o(),t({})},children:"Clear"})]})]})},k=function e(t){var n=t.account,r=t.setAddMaster,a=t.activeGroup,c=t.activeLeaf,h=t.activeLeavs,m=void 0===h?[]:h,p=t.onClick,x=void 0===p?function(){}:p,v=(0,i.useState)([]),g=(0,s.Z)(v,2),_=g[0],y=g[1],S=(0,i.useState)(!1),Z=(0,s.Z)(S,2),D=Z[0],k=Z[1],C=(0,u.i)(d.Hv.inventoryMasters),q=C.get,I=C.loading;return(0,i.useEffect)((function(){n.children&&(n.children.length&&n.totalChildren>n.children.length?q({query:{parent:n._id}}).then((function(e){var t=e.data;t.success?(y(t.data),k(!0)):(0,o.N)({type:"error",message:t.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})})):(y(n.children),k(!(null===n||void 0===n||!n.isGroup)&&n.children.length>0)))}),[n.children]),(0,f.jsxs)("li",{style:{whiteSpace:"nowrap"},className:l.listItem,children:[(0,f.jsxs)("div",{className:l.label,children:[n.isGroup&&(0,f.jsx)(f.Fragment,{children:((null===_||void 0===_?void 0:_.length)||n.totalChildren)>0?(0,f.jsx)("button",{onClick:function(){(null===_||void 0===_?void 0:_.length)===n.totalChildren?k(!D):q({query:{parent:n._id}}).then((function(e){var t=e.data;t.success?(y(t.data),k(!0)):(0,o.N)({type:"error",message:t.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))},children:I?(0,f.jsx)(N.frZ,{className:"spin"}):D?(0,f.jsx)(b.IgQ,{}):(0,f.jsx)(b.b5v,{})}):(0,f.jsx)("button",{style:{height:"16px",width:"16px",border:"1px dashed #818181",borderRadius:"2px",pointerEvents:"none"}})}),(0,f.jsx)("strong",{className:"".concat(l.accountName," ").concat(n.isGroup&&a===n._id||!n.isGroup&&c===n._id||m.includes(n._id)?l.highlight:""),onClick:function(){x(n)},children:n.name}),(0,f.jsxs)("div",{className:l.btns,children:[(0,f.jsx)("button",{className:l.addButton,onClick:function(){return r(n)},children:(0,f.jsx)(j.Nte,{})}),n.isGroup&&(0,f.jsx)("button",{className:l.addButton,onClick:function(){return r({parent:n._id,type:n.type||"",isGroup:!1})},children:(0,f.jsx)(b.iTs,{})})]})]}),D&&_.length>0&&(0,f.jsx)("ul",{className:"".concat(l.nestedList," ").concat(n.isGroup&&a===n._id?l.highlight:""),children:_.map((function(t){return(0,f.jsx)(e,{activeGroup:a,activeLeaf:c,activeLeavs:m,account:t,setAddMaster:r,onClick:x},t._id)}))})]})},C=function(e){var t=e.branches,n=e.setBranches,r=e.addBranch,s=e.setAddBranch;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("ul",{children:[t.map((function(e){return(0,f.jsx)("li",{className:l.listItem,children:(0,f.jsxs)("div",{className:l.label,children:[(0,f.jsx)("strong",{children:e.name}),(0,f.jsx)("div",{className:l.btns,children:(0,f.jsx)("button",{className:l.addButton,onClick:function(){return s(e)},children:(0,f.jsx)(j.Nte,{})})})]})},e._id)})),0===t.length&&(0,f.jsx)("p",{className:"text-center m-2",children:"No branch has been added yet."})]}),(0,f.jsx)(o.u,{open:r,head:!0,label:"".concat(null!==r&&void 0!==r&&r._id?"Update":"Add"," Branch"),className:l.masterFormModal,setOpen:function(){s(null)},children:(0,f.jsx)(x,{edit:r,onSuccess:function(e){null!==r&&void 0!==r&&r._id?n((function(t){return t.map((function(t){return t._id===e._id?e:t}))})):n((function(t){return[].concat((0,a.Z)(t),[e])})),s(!1)}})})]})},q=function(e){var t=e.branch,n=e.vouchers,a=e.setVouchers,h=(0,i.useContext)(S.D).config,m=(0,i.useState)({}),p=(0,s.Z)(m,2),x=p[0],v=p[1],g=(0,i.useRef)(),_=(0,u.i)(d.Hv.inventoryListing).get;return(0,i.useEffect)((function(){var e=(0,r.Z)({},x);t&&(e.branch=t._id),_({query:e}).then((function(e){var t=e.data;t.success?a(t.data):(0,o.N)({type:"error",message:t.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}),[x,t]),(0,f.jsxs)("div",{className:l.innerContentWrapper,children:[(0,f.jsx)(Z,{filters:x,setFilters:v}),(0,f.jsx)(c.iA,{ref:g,countRecord:function(){return n.reduce((function(e,t,n,r){var a;return e+((null===(a=r[n-1])||void 0===a?void 0:a.rec_id)!==t.rec_id?1:0)}),0)},className:l.vouchers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Product Name"},{label:"In",className:"text-right"},{label:"Out",className:"text-right"}],tfoot:function(){return(0,f.jsx)("tfoot",{children:(0,f.jsxs)("tr",{className:l.footer,children:[(0,f.jsx)("td",{}),(0,f.jsx)("td",{}),(0,f.jsx)("td",{}),(0,f.jsx)("td",{style:{fontWeight:"bold"},children:"Total"}),(0,f.jsx)("td",{className:"text-right",children:n.reduce((function(e,t){return e+t.inward}),0).fix(2,null===h||void 0===h?void 0:h.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:n.reduce((function(e,t){return e+t.outward}),0).fix(2,null===h||void 0===h?void 0:h.numberSeparator)})]})})},children:n.map((function(e,t,n){var r,a,s;return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"grid",children:(null===(r=n[t-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,f.jsx)(c.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,f.jsx)("td",{children:(null===(a=n[t-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&e.no}),(0,f.jsx)("td",{children:(null===(s=n[t-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.type}),(0,f.jsx)("td",{children:e.accountName}),(0,f.jsx)("td",{className:"text-right",children:e.inward?e.inward.fix(2,null===h||void 0===h?void 0:h.numberSeparator):null}),(0,f.jsx)("td",{className:"text-right",children:e.outward?e.outward.fix(2,null===h||void 0===h?void 0:h.numberSeparator):null})]},t)}))})]})},I=function(e){var t=e.account,n=e.branch,r=(0,i.useContext)(S.D).config,a=(0,i.useState)([]),h=(0,s.Z)(a,2),m=h[0],p=h[1],x=(0,i.useState)(0),v=(0,s.Z)(x,2),g=v[0],_=v[1],b=(0,i.useState)({}),j=(0,s.Z)(b,2),y=j[0],N=j[1],Z=(0,u.i)(d.Hv.inventoryLedgers).get;return(0,i.useEffect)((function(){if(t){var e={accountId:t._id};n&&(e.branch=n._id),y.startDate&&y.endDate&&(e.startDate=y.startDate,e.endDate=y.endDate),Z({query:e}).then((function(e){var t=e.data;t.success?(p(t.data),_(t.openingStock||0)):(0,o.N)({type:"error",message:t.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}else p([])}),[t,y,n]),(0,f.jsx)("div",{className:l.innerContentWrapper,children:t?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(D,{filter:y,setFilters:N}),(0,f.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"mt-1 pl_5",children:t.name}),(0,f.jsxs)(c.iA,{className:l.ledgers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"In",className:"text-right"},{label:"Out",className:"text-right"}],countRecord:function(){return m.length},tfoot:(0,f.jsxs)("tfoot",{style:{marginTop:"0"},children:[(0,f.jsxs)("tr",{className:l.footer,children:[(0,f.jsx)("td",{}),(0,f.jsx)("td",{}),(0,f.jsx)("td",{style:{fontWeight:"bold"},children:"Totals"}),(0,f.jsx)("td",{className:"text-right",children:m.reduce((function(e,t){return e+t.inward}),0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:m.reduce((function(e,t){return e+t.outward}),0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)})]}),(0,f.jsxs)("tr",{className:l.closing,children:[(0,f.jsx)("td",{}),(0,f.jsx)("td",{}),(0,f.jsx)("td",{style:{fontWeight:"bold"},children:"Closing Stock"}),(0,f.jsx)("td",{className:"text-right",children:((g||0)+m.reduce((function(e,t){return e+(t.inward-t.outward)}),0)).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{})]})]}),children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{}),(0,f.jsx)("td",{}),(0,f.jsx)("td",{style:{fontWeight:"bold"},children:"Opening Stock"}),(0,f.jsx)("td",{className:"text-right",children:(g||0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{})]}),m.map((function(e,t,n){var a,s,i;return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"grid",children:e.createdAt&&(null===(a=n[t-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,f.jsx)(c.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,f.jsx)("td",{children:(null===(s=n[t-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.no}),(0,f.jsx)("td",{children:(null===(i=n[t-1])||void 0===i?void 0:i.rec_id)!==e.rec_id&&e.type}),(0,f.jsx)("td",{className:"text-right",children:e.inward?e.inward.fix(2,null===r||void 0===r?void 0:r.numberSeparator):null}),(0,f.jsx)("td",{className:"text-right",children:e.outward?e.outward.fix(2,null===r||void 0===r?void 0:r.numberSeparator):null})]},t)}))]})]}):(0,f.jsx)("p",{className:l.analysysPlaceholder,children:"No product has been selected."})})},w=function(e){var t=e.branch,n=e.account,r=(0,i.useContext)(S.D).config,h=(0,i.useState)([]),m=(0,s.Z)(h,2),p=m[0],x=m[1],v=(0,i.useState)([]),g=(0,s.Z)(v,2),_=g[0],b=g[1],j=(0,i.useState)({}),y=(0,s.Z)(j,2),N=y[0],Z=y[1],k=(0,i.useState)({}),C=(0,s.Z)(k,2),q=C[0],I=C[1],w=(0,i.useState)("statement"),M=(0,s.Z)(w,2),Y=M[0],G=M[1],A=(0,u.i)(d.Hv.inventoryMonthlyAnalysys),B=A.get,Q=A.loading;return(0,i.useEffect)((function(){if(n){var e={accountId:n._id};t&&(e.branch=t._id),N.startDate&&N.endDate&&(e.startDate=N.startDate,e.endDate=N.endDate),B({query:e}).then((function(e){var t=e.data;t.success?(b(t.data),x(t.months),I(t.openingStocks)):(0,o.N)({type:"error",message:t.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}else b([]),x([])}),[n,N,t]),(0,f.jsx)("div",{className:l.innerContentWrapper,children:n?(0,f.jsxs)("div",{children:[(0,f.jsx)(D,{filter:N,setFilters:Z}),(0,f.jsxs)("div",{className:"mt-1 flex gap-2 align-center",children:[(0,f.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"pl_5",children:n.name}),(0,f.jsxs)("div",{className:"flex gap-2",children:[(0,f.jsxs)("label",{className:"flex align-center gap_5",children:[(0,f.jsx)("input",{name:"calculation",type:"radio",value:"statement",checked:"statement"===Y,onChange:function(e){return G(e.target.value)}}),"Stock Statement"]}),(0,f.jsxs)("label",{className:"flex align-center gap_5",children:[(0,f.jsx)("input",{name:"calculation",type:"radio",value:"sum_in",checked:"sum_in"===Y,onChange:function(e){return G(e.target.value)}}),"Total In"]}),(0,f.jsxs)("label",{className:"flex align-center gap_5",children:[(0,f.jsx)("input",{name:"calculation",type:"radio",value:"sum_out",checked:"sum_out"===Y,onChange:function(e){return G(e.target.value)}}),"Total Out"]}),(0,f.jsxs)("label",{className:"flex align-center gap_5",children:[(0,f.jsx)("input",{name:"calculation",type:"radio",value:"net",checked:"net"===Y,onChange:function(e){return G(e.target.value)}}),"Net"]})]})]}),(0,f.jsx)(c.iA,{loading:Q,className:l.analysys,columns:[{label:n.name}].concat((0,a.Z)("statement"===Y?[{label:"Opening Stock",className:"text-right"},{label:"Total In",className:"text-right"},{label:"Total Out",className:"text-right"},{label:"Closing Stock",className:"text-right"}]:(p||[]).map((function(e){return{label:e.label,className:"text-right"}})))),tfoot:(0,f.jsx)("tfoot",{style:{marginTop:"0"},children:(0,f.jsxs)("tr",{className:l.footer,style:{borderTop:"1px solid #979797",padding:"0 0.5rem",paddingTop:"1rem"},children:[(0,f.jsx)("td",{children:"Total"}),"statement"===Y?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("td",{className:"text-right",children:Object.values(q).reduce((function(e,t){return e+t}),0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:_.reduce((function(e,t){return e+t.entries.flat().reduce((function(e,t){return e+t.inward}),0)}),0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:_.reduce((function(e,t){return e+t.entries.flat().reduce((function(e,t){return e+t.outward}),0)}),0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:(Object.values(q||{}).reduce((function(e,t){return e+t}),0)+_.reduce((function(e,t){return e+t.entries.flat().reduce((function(e,t){return e+(t.inward-t.outward)}),0)}),0)).fix(2,null===r||void 0===r?void 0:r.numberSeparator)})]}):(p||[]).map((function(e,t){return(0,f.jsx)("td",{className:"text-right",children:F(Y,_.reduce((function(e,n,r){return e.push.apply(e,(0,a.Z)(n.entries[t])),e}),[]),0,null===r||void 0===r?void 0:r.numberSeparator)},t)}))]})}),children:(_||[]).map((function(e,t,n){return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"grid",children:e.name}),"statement"===Y?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("td",{className:"text-right",children:(q[e._id]||0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:e.entries.flat().reduce((function(e,t){return e+t.inward}),0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:e.entries.flat().reduce((function(e,t){return e+t.outward}),0).fix(2,null===r||void 0===r?void 0:r.numberSeparator)}),(0,f.jsx)("td",{className:"text-right",children:((q[e._id]||0)+e.entries.flat().reduce((function(e,t){return e+((t.inward||0)-(t.outward||0))}),0)).fix(2,null===r||void 0===r?void 0:r.numberSeparator)})]}):(p||[]).map((function(t,n){return(0,f.jsx)("td",{className:"text-right",children:F(Y,e.entries[n],q[e._id],null===r||void 0===r?void 0:r.numberSeparator)},n)}))]},t)}))})]}):(0,f.jsx)("p",{className:l.analysysPlaceholder,children:"No group has been selected."})})},F=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,a=null;return"sum_in"===e?a=t.reduce((function(e,t){return e+t.inward}),0):"sum_out"===e?a=t.reduce((function(e,t){return e+t.outward}),0):"net"===e?a=t.reduce((function(e,t){return e+(t.inward-t.outward)}),0):"statement"===e&&(a=t.reduce((function(e,t){return e+(t.inward-t.outward)}),0)+n),a.fix(2,r)},M=function(e){var t=e.setSidebarOpen,n=(0,i.useState)(null),r=(0,s.Z)(n,2),m=r[0],p=r[1],x=(0,i.useState)([]),v=(0,s.Z)(x,2),g=v[0],j=v[1],N=(0,i.useState)("voucherListing"),S=(0,s.Z)(N,2),Z=S[0],D=S[1],F=(0,i.useState)(!1),M=(0,s.Z)(F,2),Y=M[0],G=M[1],A=(0,i.useState)("accounts"),B=(0,s.Z)(A,2),Q=B[0],T=B[1],W=(0,i.useState)(!0),O=(0,s.Z)(W,2),L=O[0],P=O[1],E=(0,i.useState)(null),H=(0,s.Z)(E,2),R=H[0],z=H[1],U=(0,i.useState)({}),J=(0,s.Z)(U,2),V=J[0],K=J[1],X=(0,i.useState)([]),$=(0,s.Z)(X,2),ee=$[0],te=$[1],ne=(0,i.useState)([]),re=(0,s.Z)(ne,2),ae=re[0],se=(re[1],(0,h.cI)()),ie=se.control,ce=se.reset,oe=(0,u.i)(d.Hv.inventoryMasters).get,le=(0,u.i)(d.Hv.inventoryBranches).get,ue=(0,i.useState)([]),de=(0,s.Z)(ue,2),he=de[0],me=de[1],fe=(0,i.useState)(null),pe=(0,s.Z)(fe,2),xe=pe[0],ve=pe[1],ge=(0,i.useMemo)((function(){return function(e){var t={};e.forEach((function(e){e.children=[],t[e._id]=e}));var n=[];return e.forEach((function(e){if(e.parent){var r=t[e.parent];r&&r.children.push(e)}else n.push(e)})),n}(g)}),[g]);return(0,i.useEffect)((function(){le().then((function(e){var t=e.data;t.success?(me(t.data),t.data.length&&(ce({branch:t.data[0]._id}),ve(t.data[0]))):(0,o.N)({type:"error",message:t.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})})),oe({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return j(t.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}),[]),(0,f.jsxs)("div",{className:"".concat(l.content," grid gap-1 m-a"),children:[(0,f.jsx)("div",{className:"flex ".concat(l.head),children:(0,f.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return t((function(e){return!e}))},children:[(0,f.jsx)(b.Ps6,{style:{fontSize:"1.75rem"}}),(0,f.jsx)("h2",{children:"Inventory"})]})}),(0,f.jsxs)("div",{className:"".concat(l.innerWrapper," ").concat(L?l.open:""),children:[(0,f.jsxs)("div",{className:l.sidebar,children:[(0,f.jsxs)("div",{children:[(0,f.jsx)(c.mQ,{activeTab:Q,tabs:[{label:"Products",value:"accounts"},{label:"Branches",value:"branches"}],onChange:function(e){return T(e.value)}}),(0,f.jsx)("button",{className:l.addButton,onClick:function(){"accounts"===Q?p({}):"branches"===Q&&G(!0)},children:(0,f.jsx)(b.iTs,{})})]}),"accounts"===Q&&(0,f.jsx)("ul",{children:g.length>0?ge.map((function(e){var t;return(0,f.jsx)(k,{account:e,setAddMaster:p,activeGroup:"analysys"===Z?null===R||void 0===R?void 0:R._id:null,activeLeaf:"ledgers"===Z?null===V||void 0===V||null===(t=V.account)||void 0===t?void 0:t._id:null,activeLeavs:"journals"===Z?ae.map((function(e){return e._id})):[],onClick:function(e){if(e.isGroup)z(e),D("analysys");else{var t=(ee||[]).filter((function(t){return t.accountId===e._id})),n=(ee||[]).filter((function(e){return t.some((function(t){return t.rec_id===e.rec_id}))})),r=[].concat((0,a.Z)(t),(0,a.Z)(n)).filter((function(e,t,n){return t===n.findIndex((function(t){return t.rec_id===e.rec_id&&t.index===e.index}))})).filter((function(t){return t.accountId===e._id}));K({account:e,rows:r}),D("ledgers")}}},e._id)})):(0,f.jsx)("p",{style:{marginTop:"1rem",marginBottom:"1rem",textAlign:"center",textWrap:"balance",color:"#797979"},children:"No product have been added yet."})}),"branches"===Q&&(0,f.jsx)(C,{branches:he,setBranches:me,addBranch:Y,setAddBranch:G})]}),(0,f.jsxs)("div",{className:l.innerContent,children:[(0,f.jsx)("div",{style:{maxWidth:"15rem"},children:(0,f.jsx)(c.hQ,{label:"Branch",control:ie,name:"branch",options:he.map((function(e){return{label:e.name,value:e._id,branch:e}})),onChange:function(e){null!==e&&void 0!==e&&e.branch&&ve(e.branch)},className:"mb-2"})}),(0,f.jsxs)("div",{className:"flex gap-1 align-center",children:[(0,f.jsx)("button",{className:"btn clear iconOnly",onClick:function(){return P(!L)},children:(0,f.jsx)(y.kpB,{})}),(0,f.jsx)(c.mQ,{activeTab:Z,tabs:[{label:"Listing",value:"voucherListing"},{label:"Stock Ledgers",value:"ledgers"},{label:"Inventory Analysys",value:"analysys"}],onChange:function(e){return D(e.value)}})]}),"voucherListing"===Z&&(0,f.jsx)(q,{branch:xe,vouchers:ee,setVouchers:te}),"ledgers"===Z&&(0,f.jsx)(I,{account:null===V||void 0===V?void 0:V.account,branch:xe}),"analysys"===Z&&(0,f.jsx)(w,{branch:xe,account:R})]})]}),(0,f.jsx)(o.u,{open:m,head:!0,label:"".concat(null!==m&&void 0!==m&&m._id?"Update":"Add"," Account"),className:l.masterFormModal,setOpen:function(){p(null)},children:(0,f.jsx)(_,{edit:m,masters:g,onSuccess:function(){oe({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return j(t.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})})),p({})}})})]})}}}]);
//# sourceMappingURL=977.3db20635.chunk.js.map