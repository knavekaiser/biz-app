"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[977],{977:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var r=t(1413),a=t(2982),s=t(885),i=t(2791),c=t(5470),o=t(8750),l={content:"quotes_content__niBb4",innerWrapper:"quotes_innerWrapper__eqA-i",sidebar:"quotes_sidebar__J-8f3",addButton:"quotes_addButton__u9EdI",btns:"quotes_btns__4+XC2",listItem:"quotes_listItem__WD70k",label:"quotes_label__KbFIm",accountName:"quotes_accountName__7d1uP",highlight:"quotes_highlight__oAB8h",nestedList:"quotes_nestedList__hnP2n",open:"quotes_open__1j-GY",innerContent:"quotes_innerContent__AASR0",innerContentWrapper:"quotes_innerContentWrapper__wL0J2",vouchers:"quotes_vouchers__B6a0g",footer:"quotes_footer__NlFGZ",analysysPlaceholder:"quotes_analysysPlaceholder__WFSHT",entryForm:"quotes_entryForm__oFShb",voucherFilters:"quotes_voucherFilters__Mobw4",masterFormModal:"quotes_masterFormModal__mLMGL",masterForm:"quotes_masterForm__peHJD",head:"quotes_head__x3HSY"},u=t(5454),d=t(1080),h=t(1134),m=t(1570),p=t(184),f=m.Ry({name:m.Z_().required("Please enter a name")}),v=function(e){var n=e.edit,t=e.onSuccess,a=(0,h.cI)({resolver:(0,u.y)(f)}),s=a.handleSubmit,m=a.register,v=a.reset,x=a.formState.errors,_=(0,u.i)(d.Hv.inventoryBranches+"/".concat((null===n||void 0===n?void 0:n._id)||"")),g=_.post,j=_.put,b=_.loading;return(0,i.useEffect)((function(){v({name:(null===n||void 0===n?void 0:n.name)||""})}),[n]),(0,p.jsxs)("form",{onSubmit:s((function(e){(null!==n&&void 0!==n&&n._id?j:g)({name:e.name}).then((function(e){var n=e.data;if(!n.success)return(0,o.N)({type:"error",message:n.message});t(n.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))})),className:"".concat(l.masterForm," grid gap-1"),children:[(0,p.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Name"},m("name")),{},{required:!0,error:x.name})),(0,p.jsx)("div",{className:"btns",children:(0,p.jsx)("button",{className:"btn",disabled:b,children:null!==n&&void 0!==n&&n._id?"Update":"Submit"})})]})},x=t(2942),_=m.Ry({name:m.Z_().required("Please enter a name"),isGroup:m.O7().required(),parent:m.Z_().when("isGroup",{is:!1,then:function(e){return e.required("Please select a group.")},otherwise:function(e){return e}})}),g=function(e){var n=e.edit,t=e.masters,m=void 0===t?[]:t,f=e.onSuccess,v=(0,i.useState)([]),g=(0,s.Z)(v,2),j=g[0],b=g[1],y=(0,h.cI)({resolver:(0,u.y)(_)}),N=y.handleSubmit,S=y.register,Z=y.reset,k=y.control,q=y.setValue,w=y.setError,C=y.watch,I=y.clearErrors,F=y.formState.errors,A=C("isGroup"),G=(0,u.i)(d.Hv.inventoryMasters+"/".concat((null===n||void 0===n?void 0:n._id)||"")),D=G.post,B=G.put,M=G.loading;return(0,i.useEffect)((function(){var e,t,r,a,s={name:(null===n||void 0===n?void 0:n.name)||"",parent:(null===n||void 0===n?void 0:n.parent)||"",isGroup:null===(e=null===n||void 0===n?void 0:n.isGroup)||void 0===e||e};null!==n&&void 0!==n&&null!==(t=n.openingStocks)&&void 0!==t&&t.length?null===n||void 0===n||null===(a=n.openingStocks)||void 0===a||a.forEach((function(e,n){s["entries_".concat(n,"_branch")]=e.branch,s["entries_".concat(n,"_openingStock")]=e.openingStock,s["entries_".concat(n,"_cost")]=e.cost,s["entries_".concat(n,"_reorderQty")]=e.reorderQty})):(s.entries_0_branch="",s.entries_0_openingStock="",s.entries_0_cost="",s.entries_0_reorderQty="");Z(s),b(null!==n&&void 0!==n&&null!==(r=n.openingStocks)&&void 0!==r&&r.length?null===n||void 0===n?void 0:n.openingStocks:[{_id:Math.random().toString(36),branch:"",openingStock:"",reorderQty:""}])}),[n]),(0,p.jsxs)("form",{onSubmit:N((function(e){if(e.isGroup||!j.some((function(e,n){return!(e.branch&&e.openingStock&&e.cost&&e.reorderQty)&&(e.branch||w("entries_".concat(n,"_branch"),{type:"custom",message:"Name is required."}),e.openingStock||w("entries_".concat(n,"_openingStock"),{type:"custom",message:"Stock is required."}),e.cost||w("entries_".concat(n,"_cost"),{type:"custom",message:"Cost is required."}),e.reorderQty||w("entries_".concat(n,"_reorderQty"),{type:"custom",message:"Reorder QTY is required."}),!0)}))){e.parent||(e.parent=null);var t={name:e.name,isGroup:e.isGroup,parent:e.parent,type:e.type};e.isGroup||(t.openingStocks=j.map((function(e){return{branch:e.branch,openingStock:e.openingStock,cost:e.cost,reorderQty:e.reorderQty}}))),(null!==n&&void 0!==n&&n._id?B:D)(t).then((function(e){var n=e.data;if(!n.success)return(0,o.N)({type:"error",message:n.message});f(n.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}})),className:"".concat(l.masterForm," grid gap-1"),children:[(0,p.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Name"},S("name")),{},{required:!0,error:F.name})),(0,p.jsx)(c.hQ,{label:"Parent",name:"parent",control:k,formOptions:{required:!A},placeholder:"",options:[{label:"None",value:""}].concat((0,a.Z)(m.map((function(e){return{label:e.name,value:e._id}}))))}),(0,p.jsx)(c.hQ,{label:"Is Group",name:"isGroup",control:k,formOptions:{required:!0},options:[{label:"No",value:!1},{label:"Yes",value:!0}]}),!A&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h3",{children:"Opening Stocks"}),(j||[]).map((function(e,n){return(0,p.jsxs)("div",{className:l.entryForm,children:[(0,p.jsx)(c.OC,{label:"Branch",control:k,name:"entries_".concat(n,"_branch"),formOptions:{required:!0},url:d.Hv.inventoryBranches,getQuery:function(e){return{name:e}},handleData:function(e){return{label:e.name,value:e._id}},onChange:function(t){I("entries_".concat(n,"_openingStock")),b((function(n){return n.map((function(n){return n._id===e._id?(0,r.Z)((0,r.Z)({},n),{},{branch:t.value}):n}))}))}}),(0,p.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Opening Stock",type:"number",required:!0},S("entries_".concat(n,"_openingStock"))),{},{onChange:function(t){I("entries_".concat(n,"_openingStock")),b((function(n){return n.map((function(n){return n._id===e._id?(0,r.Z)((0,r.Z)({},n),{},{openingStock:t.target.value}):n}))}))},error:F["entries_".concat(n,"_openingStock")]})),(0,p.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Cost",type:"number",required:!0},S("entries_".concat(n,"_cost"))),{},{onChange:function(t){I("entries_".concat(n,"_cost")),b((function(n){return n.map((function(n){return n._id===e._id?(0,r.Z)((0,r.Z)({},n),{},{cost:t.target.value}):n}))}))},error:F["entries_".concat(n,"_cost")]})),(0,p.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Reorder QTY",type:"number",required:!0},S("entries_".concat(n,"_reorderQty"))),{},{onChange:function(t){I("entries_".concat(n,"_reorderQty")),b((function(n){return n.map((function(n){return n._id===e._id?(0,r.Z)((0,r.Z)({},n),{},{reorderQty:t.target.value}):n}))}))},error:F["entries_".concat(n,"_reorderQty")]})),(null===j||void 0===j?void 0:j.length)>1&&(0,p.jsx)("button",{type:"button",onClick:function(){return b((function(n){return n.filter((function(n){return n._id!==e._id}))}))},className:"btn clear iconOnly",children:(0,p.jsx)(x.K3i,{})})]},e._id)})),!M&&(0,p.jsx)("button",{type:"button",className:"btn secondary",onClick:function(){q("entries_".concat(j.length,"_type"),"credit"),b((function(e){return[].concat((0,a.Z)(e),[{_id:Math.random().toString(36),type:"credit",accountId:"",debit:"",credit:""}])}))},children:"Add More Stock"})]}),(0,p.jsx)("div",{className:"btns",children:(0,p.jsx)("button",{className:"btn",disabled:M,children:null!==n&&void 0!==n&&n._id?"Update":"Submit"})})]})},j=t(5804),b=t(3974),y=t(1765),N=t(4794),S=function(e){e.filters;var n=e.setFilters,t=(0,h.cI)(),a=t.handleSubmit,s=t.register,i=t.reset,o=t.control,u=t.formState.errors;return(0,p.jsxs)("form",{onSubmit:a((function(e){var t={};e.type&&(t.type=e.type),e.startDate&&e.endDate&&(t.startDate=e.startDate,t.endDate=e.endDate),n(t)})),className:"".concat(l.voucherFilters," grid gap-1"),children:[(0,p.jsx)(c.hQ,{label:"Type",name:"type",control:o,options:[{label:"Invoice",value:"Invoice"},{label:"Sales Return",value:"Sales Return"},{label:"Purchase",value:"Purchase"},{label:"Purchase Return",value:"Purchase Return"},{label:"Receipt",value:"Receipt"},{label:"Payment",value:"Payment"}]}),(0,p.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"Start Date",type:"datetime-local"},s("startDate")),{},{required:!0,error:u.startDate})),(0,p.jsx)(c.II,(0,r.Z)((0,r.Z)({label:"End Date",type:"datetime-local"},s("endDate")),{},{required:!0,error:u.endDate})),(0,p.jsxs)("div",{className:"flex gap-1",children:[(0,p.jsx)("button",{className:"btn",children:"Search"}),(0,p.jsx)("button",{className:"btn secondary",type:"button",onClick:function(){i(),n({})},children:"Clear"})]})]})},Z=function e(n){var t=n.account,r=n.setAddMaster,a=n.activeGroup,c=n.activeLeaf,h=n.activeLeavs,m=void 0===h?[]:h,f=n.onClick,v=void 0===f?function(){}:f,x=(0,i.useState)([]),_=(0,s.Z)(x,2),g=_[0],y=_[1],S=(0,i.useState)(!1),Z=(0,s.Z)(S,2),k=Z[0],q=Z[1],w=(0,u.i)(d.Hv.inventoryMasters),C=w.get,I=w.loading;return(0,i.useEffect)((function(){t.children&&(t.children.length&&t.totalChildren>t.children.length?C({query:{parent:t._id}}).then((function(e){var n=e.data;n.success?(y(n.data),q(!0)):(0,o.N)({type:"error",message:n.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})})):(y(t.children),q(!(null===t||void 0===t||!t.isGroup)&&t.children.length>0)))}),[t.children]),(0,p.jsxs)("li",{style:{whiteSpace:"nowrap"},className:l.listItem,children:[(0,p.jsxs)("div",{className:l.label,children:[t.isGroup&&(0,p.jsx)(p.Fragment,{children:((null===g||void 0===g?void 0:g.length)||t.totalChildren)>0?(0,p.jsx)("button",{onClick:function(){(null===g||void 0===g?void 0:g.length)===t.totalChildren?q(!k):C({query:{parent:t._id}}).then((function(e){var n=e.data;n.success?(y(n.data),q(!0)):(0,o.N)({type:"error",message:n.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))},children:I?(0,p.jsx)(N.frZ,{className:"spin"}):k?(0,p.jsx)(j.IgQ,{}):(0,p.jsx)(j.b5v,{})}):(0,p.jsx)("button",{style:{height:"16px",width:"16px",border:"1px dashed #818181",borderRadius:"2px",pointerEvents:"none"}})}),(0,p.jsx)("strong",{className:"".concat(l.accountName," ").concat(t.isGroup&&a===t._id||!t.isGroup&&c===t._id||m.includes(t._id)?l.highlight:""),onClick:function(){v(t)},children:t.name}),(0,p.jsxs)("div",{className:l.btns,children:[(0,p.jsx)("button",{className:l.addButton,onClick:function(){return r(t)},children:(0,p.jsx)(b.Nte,{})}),t.isGroup&&(0,p.jsx)("button",{className:l.addButton,onClick:function(){return r({parent:t._id,type:t.type||"",isGroup:!1})},children:(0,p.jsx)(j.iTs,{})})]})]}),k&&g.length>0&&(0,p.jsx)("ul",{className:"".concat(l.nestedList," ").concat(t.isGroup&&a===t._id?l.highlight:""),children:g.map((function(n){return(0,p.jsx)(e,{activeGroup:a,activeLeaf:c,activeLeavs:m,account:n,setAddMaster:r,onClick:v},n._id)}))})]})},k=function(e){var n=e.addBranch,t=e.setAddBranch,r=(0,i.useState)([]),c=(0,s.Z)(r,2),h=c[0],m=c[1],f=(0,u.i)(d.Hv.inventoryBranches).get;return(0,i.useEffect)((function(){f().then((function(e){var n=e.data;n.success?m(n.data):(0,o.N)({type:"error",message:n.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}),[]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("ul",{children:[h.map((function(e){return(0,p.jsx)("li",{className:l.listItem,children:(0,p.jsxs)("div",{className:l.label,children:[(0,p.jsx)("strong",{children:e.name}),(0,p.jsx)("div",{className:l.btns,children:(0,p.jsx)("button",{className:l.addButton,onClick:function(){return t(e)},children:(0,p.jsx)(b.Nte,{})})})]})},e._id)})),0===h.length&&(0,p.jsx)("p",{className:"text-center m-2",children:"No branch has been added yet."})]}),(0,p.jsx)(o.u,{open:n,head:!0,label:"".concat(null!==n&&void 0!==n&&n._id?"Update":"Add"," Branch"),className:l.masterFormModal,setOpen:function(){t(null)},children:(0,p.jsx)(v,{edit:n,onSuccess:function(e){null!==n&&void 0!==n&&n._id?m((function(n){return n.map((function(n){return n._id===e._id?e:n}))})):m((function(n){return[].concat((0,a.Z)(n),[e])})),t(!1)}})})]})},q=function(e){var n=e.vouchers,t=e.setVouchers,r=(0,i.useState)({}),a=(0,s.Z)(r,2),h=a[0],m=a[1],f=(0,i.useRef)(),v=(0,u.i)(d.Hv.inventoryListing).get;return(0,i.useEffect)((function(){v({query:h}).then((function(e){var n=e.data;n.success?t(n.data):(0,o.N)({type:"error",message:n.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}),[h]),(0,p.jsxs)("div",{className:l.innerContentWrapper,children:[(0,p.jsx)(S,{filters:h,setFilters:m}),(0,p.jsx)(c.iA,{ref:f,countRecord:function(){return n.reduce((function(e,n,t,r){var a;return e+((null===(a=r[t-1])||void 0===a?void 0:a.rec_id)!==n.rec_id?1:0)}),0)},className:l.vouchers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Product Name"},{label:"Out",className:"text-right"},{label:"In",className:"text-right"}],tfoot:function(){return(0,p.jsx)("tfoot",{children:(0,p.jsxs)("tr",{className:l.footer,children:[(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{className:"text-right",children:"Total"}),(0,p.jsx)("td",{className:"text-right",children:n.reduce((function(e,n){return e+n.outward}),0).toFixed(2)}),(0,p.jsx)("td",{className:"text-right",children:n.reduce((function(e,n){return e+n.inward}),0).toFixed(2)})]})})},children:n.map((function(e,n,t){var r,a,s;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"grid",children:(null===(r=t[n-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,p.jsx)(c.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,p.jsx)("td",{children:(null===(a=t[n-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&e.no}),(0,p.jsx)("td",{children:(null===(s=t[n-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.type}),(0,p.jsx)("td",{children:e.accountName}),(0,p.jsx)("td",{className:"text-right",children:e.outward?e.outward.toFixed(2):null}),(0,p.jsx)("td",{className:"text-right",children:e.inward?e.inward.toFixed(2):null})]},n)}))})]})},w=function(e){var n=e.account,t=e.rows;return(0,p.jsx)("div",{className:l.innerContentWrapper,children:(null===t||void 0===t?void 0:t.length)>0?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"mt-1 pl_5",children:n.name}),(0,p.jsx)(c.iA,{className:l.vouchers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Product Name"},{label:"Out",className:"text-right"},{label:"In",className:"text-right"}],tfoot:(0,p.jsx)("tfoot",{style:{marginTop:"0"},children:(0,p.jsxs)("tr",{className:l.footer,children:[(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{className:"text-right",children:"Total"}),(0,p.jsx)("td",{className:"text-right",children:t.reduce((function(e,n){return e+n.outward}),0).toFixed(2)}),(0,p.jsx)("td",{className:"text-right",children:t.reduce((function(e,n){return e+n.inward}),0).toFixed(2)})]})}),children:t.map((function(e,n,t){var r,a,s,i;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"grid",children:e.createdAt&&(null===(r=t[n-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,p.jsx)(c.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,p.jsx)("td",{children:(null===(a=t[n-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&e.no}),(0,p.jsx)("td",{children:(null===(s=t[n-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.type}),(0,p.jsx)("td",{className:"grid",children:(null===(i=e.details)||void 0===i?void 0:i.length)>0?"Details:":e.accountName}),(0,p.jsx)("td",{className:"text-right",children:e.outward?e.outward.toFixed(2):null}),(0,p.jsx)("td",{className:"text-right",children:e.inward?e.inward.toFixed(2):null})]},n)}))})]}):n?(0,p.jsxs)("p",{className:l.analysysPlaceholder,children:["No records found for ",(0,p.jsx)("strong",{children:n.name}),"."]}):(0,p.jsx)("p",{className:l.analysysPlaceholder,children:"No account has been selected."})})},C=function(e){var n=e.account,t=(0,i.useState)([]),r=(0,s.Z)(t,2),h=r[0],m=r[1],f=(0,i.useState)([]),v=(0,s.Z)(f,2),x=v[0],_=v[1],g=(0,i.useState)("sum_debit"),j=(0,s.Z)(g,2),b=j[0],y=j[1],N=(0,u.i)(d.Hv.inventoryMonthlyAnalysys),S=N.get,Z=N.loading;return(0,i.useEffect)((function(){n?(y(["Liabilities","Income"].includes(null===n||void 0===n?void 0:n.name)?"sum_credit":"sum_debit"),S({query:{accountId:n._id}}).then((function(e){var n=e.data;n.success?(_(n.data),m(n.months)):(0,o.N)({type:"error",message:n.message})})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))):(_([]),m([]))}),[n]),(0,p.jsx)("div",{className:l.innerContentWrapper,children:n?(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"mt-1 flex gap-2 align-center",children:[(0,p.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"pl_5",children:n.name}),(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"sum_debit",checked:"sum_debit"===b,onChange:function(e){return y(e.target.value)}}),"Total Out"]}),(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"sum_credit",checked:"sum_credit"===b,onChange:function(e){return y(e.target.value)}}),"Total In"]}),(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"net",onChange:function(e){return y(e.target.value)}}),"Net"]}),(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"balance",onChange:function(e){return y(e.target.value)}}),"Balance"]})]})]}),(0,p.jsx)(c.iA,{loading:Z,className:l.analysys,columns:[{label:n.name}].concat((0,a.Z)((h||[]).map((function(e){return{label:e.label,className:"text-right"}})))),tfoot:(0,p.jsx)("tfoot",{style:{marginTop:"0"},children:(0,p.jsxs)("tr",{className:l.footer,style:{borderTop:"1px solid #979797",padding:"0 0.5rem",paddingTop:"1rem"},children:[(0,p.jsx)("td",{children:"Total"}),(h||[]).map((function(e,n){return(0,p.jsx)("td",{className:"text-right",children:I(b,x.reduce((function(e,t,r){return e.push.apply(e,(0,a.Z)(t.entries[n])),e}),[]))},n)}))]})}),children:(x||[]).map((function(e,n,t){return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"grid",children:e.name}),(h||[]).map((function(n,t){return(0,p.jsx)("td",{className:"text-right",children:I(b,e.entries[t],e.openingBalance)},t)}))]},n)}))})]}):(0,p.jsx)("p",{className:l.analysysPlaceholder,children:"No group has been selected."})})},I=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=null;return"sum_debit"===e?r=n.reduce((function(e,n){return e+n.outward}),0):"sum_credit"===e?r=n.reduce((function(e,n){return e+n.inward}),0):"net"===e?r=n.reduce((function(e,n){return e+n.outward-n.inward}),0):"balance"===e&&(r=n.reduce((function(e,n){return e+n.outward-n.inward}),0)+t),r.toFixed(2)},F=function(e){var n=e.setSidebarOpen,t=(0,i.useState)(null),h=(0,s.Z)(t,2),m=h[0],f=h[1],v=(0,i.useState)([]),x=(0,s.Z)(v,2),_=x[0],b=x[1],N=(0,i.useState)("voucherListing"),S=(0,s.Z)(N,2),I=S[0],F=S[1],A=(0,i.useState)(!1),G=(0,s.Z)(A,2),D=G[0],B=G[1],M=(0,i.useState)("accounts"),Q=(0,s.Z)(M,2),T=Q[0],P=Q[1],L=(0,i.useState)(!0),W=(0,s.Z)(L,2),E=W[0],O=W[1],R=(0,i.useState)(null),Y=(0,s.Z)(R,2),H=Y[0],z=Y[1],U=(0,i.useState)({}),J=(0,s.Z)(U,2),V=J[0],K=J[1],X=(0,i.useState)([]),$=(0,s.Z)(X,2),ee=$[0],ne=$[1],te=(0,i.useState)([]),re=(0,s.Z)(te,2),ae=re[0],se=(re[1],(0,u.i)(d.Hv.inventoryMasters).get),ie=(0,i.useMemo)((function(){return function(e){var n={};e.forEach((function(e){e.children=[],n[e._id]=e}));var t=[];return e.forEach((function(e){if(e.parent){var r=n[e.parent];r&&r.children.push(e)}else t.push(e)})),t}(_)}),[_]);return(0,i.useEffect)((function(){se({query:{isGroup:"true"}}).then((function(e){var n=e.data;if(n.success)return b(n.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})}))}),[]),(0,p.jsxs)("div",{className:"".concat(l.content," grid gap-1 m-a"),children:[(0,p.jsx)("div",{className:"flex ".concat(l.head),children:(0,p.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return n((function(e){return!e}))},children:[(0,p.jsx)(j.Ps6,{style:{fontSize:"1.75rem"}}),(0,p.jsx)("h2",{children:"Inventory"})]})}),(0,p.jsxs)("div",{className:"".concat(l.innerWrapper," ").concat(E?l.open:""),children:[(0,p.jsxs)("div",{className:l.sidebar,children:[(0,p.jsxs)("div",{children:[(0,p.jsx)(c.mQ,{activeTab:T,tabs:[{label:"Accounts",value:"accounts"},{label:"Branches",value:"branches"}],onChange:function(e){return P(e.value)}}),(0,p.jsx)("button",{className:l.addButton,onClick:function(){"accounts"===T?f({}):"branches"===T&&B(!0)},children:(0,p.jsx)(j.iTs,{})})]}),"accounts"===T&&(0,p.jsx)("ul",{children:_.length>0?ie.map((function(e){var n;return(0,p.jsx)(Z,{account:e,setAddMaster:f,activeGroup:"analysys"===I?null===H||void 0===H?void 0:H._id:null,activeLeaf:"ledgers"===I?null===V||void 0===V||null===(n=V.account)||void 0===n?void 0:n._id:null,activeLeavs:"journals"===I?ae.map((function(e){return e._id})):[],onClick:function(e){if(e.isGroup)z(e),F("analysys");else{var n=(ee||[]).filter((function(n){return n.accountId===e._id})),t=(ee||[]).filter((function(e){return n.some((function(n){return n.rec_id===e.rec_id}))})),s=[].concat((0,a.Z)(n),(0,a.Z)(t)).filter((function(e,n,t){return n===t.findIndex((function(n){return n.rec_id===e.rec_id&&n.index===e.index}))})),i=s.filter((function(n){return n.accountId!==e._id})).reduce((function(e,n){var t=e.findIndex((function(e){return e.some((function(e){return e.rec_id===n.rec_id}))}));return-1===t?e.push([n]):e[t].push(n),e}),[]).map((function(e){var n=s.find((function(n){return n.rec_id===e[0].rec_id}));return e.length<=1?(0,r.Z)((0,r.Z)({},e[0]),{},{outward:n.outward,inward:n.inward}):(0,r.Z)((0,r.Z)({},e[0]),{},{details:e.map((function(e){return{label:e.accountName,value:e.inward||e.outward}})),outward:n.outward,inward:n.inward})})).sort((function(e,n){return new Date(e)>new Date(n)?1:-1})).sort((function(e,n){return e.index>n.index?1:-1})).reduce((function(e,n){var t;return null!==(t=n.details)&&void 0!==t&&t.length?e.push.apply(e,[n].concat((0,a.Z)(n.details.map((function(e){return{createdAt:null,no:null,type:null,accountName:(0,p.jsxs)("p",{children:[e.label,": ",e.value.toFixed(2)]}),outward:null,inward:null}}))))):e.push(n),e}),[]);K({account:e,rows:i}),F("ledgers")}}},e._id)})):(0,p.jsx)("p",{style:{marginTop:"1rem",marginBottom:"1rem",textAlign:"center",textWrap:"balance",color:"#797979"},children:"No accounts have been added yet."})}),"branches"===T&&(0,p.jsx)(k,{addBranch:D,setAddBranch:B})]}),(0,p.jsxs)("div",{className:l.innerContent,children:[(0,p.jsxs)("div",{className:"flex gap-1 align-center",children:[(0,p.jsx)("button",{className:"btn clear iconOnly",onClick:function(){return O(!E)},children:(0,p.jsx)(y.kpB,{})}),(0,p.jsx)(c.mQ,{activeTab:I,tabs:[{label:"Listing",value:"voucherListing"},{label:"Traking",value:"ledgers"},{label:"Accounting Analysys",value:"analysys"}],onChange:function(e){return F(e.value)}})]}),"voucherListing"===I&&(0,p.jsx)(q,{vouchers:ee,setVouchers:ne}),"ledgers"===I&&(0,p.jsx)(w,{account:null===V||void 0===V?void 0:V.account,rows:null===V||void 0===V?void 0:V.rows}),"analysys"===I&&(0,p.jsx)(C,{account:H})]})]}),(0,p.jsx)(o.u,{open:m,head:!0,label:"".concat(null!==m&&void 0!==m&&m._id?"Update":"Add"," Account"),className:l.masterFormModal,setOpen:function(){f(null)},children:(0,p.jsx)(g,{edit:m,masters:_,onSuccess:function(){se({query:{isGroup:"true"}}).then((function(e){var n=e.data;if(n.success)return b(n.data)})).catch((function(e){return(0,o.N)({type:"error",message:e.message})})),f({})}})})]})}}}]);
//# sourceMappingURL=977.46ded8cd.chunk.js.map