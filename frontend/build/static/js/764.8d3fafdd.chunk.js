"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[764],{9764:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var a=n(1413),r=n(885),l=n(2791),s=n(5470),i=n(8750),c="quotes_content__d6QGt",o="quotes_innerWrapper__0o8+D",u="quotes_sidebar__OueuR",d="quotes_addButton__XE+Gn",h="quotes_btns__y2nuy",m="quotes_listItem__ityEv",p="quotes_label__VuSPM",x="quotes_accountName__zyenQ",v="quotes_nestedList__B-cIy",f="quotes_open__aa1x+",_="quotes_innerContent__wCHU6",j="quotes_innerContentWrapper__rKsb7",g="quotes_vouchers__t8sKZ",b="quotes_footer__AWxAV",N="quotes_analysysPlaceholder__0wx94",y="quotes_masterFormModal__36AN0",S="quotes_masterForm__dXJKs",C="quotes_head__uo7Hz",q=n(5454),k=n(1080),A=n(2982),Z=n(1134),T=n(1570),M=n(184),F=T.Ry({name:T.Z_().required("Please enter a name"),parent:T.Z_(),type:T.Z_().oneOf(["Cash","Bank","Customers","Suppliers","Sales","Purchase","Stock","null","Tax",null]).nullable(),isGroup:T.O7().required(),openingBalance:T.Rx().required("Please enter opening balance").typeError("Please enter a valid number")}),G=function(e){var t=e.edit,n=e.masters,r=void 0===n?[]:n,c=e.onSuccess,o=(0,Z.cI)({resolver:(0,q.y)(F)}),u=o.handleSubmit,d=o.register,h=o.reset,m=o.control,p=o.formState.errors,x=(0,q.i)(k.Hv.accountingMasters+"/".concat((null===t||void 0===t?void 0:t._id)||"")),v=x.post,f=x.put,_=x.loading;return(0,l.useEffect)((function(){var e;h({name:(null===t||void 0===t?void 0:t.name)||"",parent:(null===t||void 0===t?void 0:t.parent)||"null",type:(null===t||void 0===t?void 0:t.type)||"null",isGroup:null===(e=null===t||void 0===t?void 0:t.isGroup)||void 0===e||e,openingBalance:(null===t||void 0===t?void 0:t.openingBalance)||0})}),[t]),(0,M.jsxs)("form",{onSubmit:u((function(e){"null"===e.parent&&(e.parent=null),"null"===e.type&&(e.type=null),(null!==t&&void 0!==t&&t._id?f:v)(e).then((function(e){var t=e.data;if(!t.success)return(0,i.N)({type:"error",message:t.message});c(t.data)})).catch((function(e){return(0,i.N)({type:"error",message:e.message})}))})),className:"".concat(S," grid gap-1"),children:[(0,M.jsx)(s.II,(0,a.Z)((0,a.Z)({label:"Name"},d("name")),{},{required:!0,error:p.name})),(0,M.jsx)(s.hQ,{label:"Parent",name:"parent",control:m,options:[{label:"None",value:"null"}].concat((0,A.Z)(r.map((function(e){return{label:e.name,value:e._id}}))))}),(0,M.jsx)(s.hQ,{label:"Type",name:"type",control:m,options:[{label:"None",value:"null"},{label:"Cash",value:"Cash"},{label:"Bank",value:"Bank"},{label:"Customers",value:"Customers"},{label:"Suppliers",value:"Suppliers"},{label:"Sales",value:"Sales"},{label:"Purchase",value:"Purchase"},{label:"Stock",value:"Stock"},{label:"Tax",value:"Tax"}]}),(0,M.jsx)(s.hQ,{label:"Is Group",name:"isGroup",control:m,formOptions:{required:!0},options:[{label:"No",value:!1},{label:"Yes",value:!0}]}),(0,M.jsx)(s.II,(0,a.Z)((0,a.Z)({label:"Opening Balance",type:"number"},d("openingBalance")),{},{required:!0,error:p.openingBalance})),(0,M.jsx)("div",{className:"btns",children:(0,M.jsx)("button",{className:"btn",disabled:_,children:null!==t&&void 0!==t&&t._id?"Update":"Submit"})})]})},P=n(5804),B=n(3974),D=n(1765),I=n(4794),E=function e(t){var n=t.account,a=t.setAddMaster,s=t.onClick,c=void 0===s?function(){}:s,o=(0,l.useState)([]),u=(0,r.Z)(o,2),f=u[0],_=u[1],j=(0,l.useState)(!1),g=(0,r.Z)(j,2),b=g[0],N=g[1],y=(0,q.i)(k.Hv.accountingMasters),S=y.get,C=y.loading;return(0,l.useEffect)((function(){n.children&&(n.children.length===n.totalChildren?(_(n.children),N(!(null===n||void 0===n||!n.isGroup)&&n.children.length>0)):n.children.length&&n.totalChildren>n.children.length&&S({query:{parent:n._id}}).then((function(e){var t=e.data;t.success?(_(t.data),N(!0)):(0,i.N)({type:"error",message:t.message})})).catch((function(e){return(0,i.N)({type:"error",message:e.message})})))}),[n.children]),(0,M.jsxs)("li",{style:{whiteSpace:"nowrap"},className:m,children:[(0,M.jsxs)("div",{className:p,children:[n.isGroup&&(0,M.jsx)(M.Fragment,{children:((null===f||void 0===f?void 0:f.length)||n.totalChildren)>0?(0,M.jsx)("button",{onClick:function(){(null===f||void 0===f?void 0:f.length)===n.totalChildren?N(!b):S({query:{parent:n._id}}).then((function(e){var t=e.data;t.success?(_(t.data),N(!0)):(0,i.N)({type:"error",message:t.message})})).catch((function(e){return(0,i.N)({type:"error",message:e.message})}))},children:C?(0,M.jsx)(I.frZ,{className:"spin"}):b?(0,M.jsx)(P.IgQ,{}):(0,M.jsx)(P.b5v,{})}):(0,M.jsx)("button",{style:{height:"16px",width:"16px",border:"1px dashed #818181",borderRadius:"2px",pointerEvents:"none"}})}),(0,M.jsx)("strong",{className:n.isGroup?"":x,onClick:function(){n.isGroup||c(n)},children:n.name}),(0,M.jsxs)("div",{className:h,children:[(0,M.jsx)("button",{className:d,onClick:function(){return a(n)},children:(0,M.jsx)(B.Nte,{})}),n.isGroup&&(0,M.jsx)("button",{className:d,onClick:function(){return a({parent:n._id,type:n.type||""})},children:(0,M.jsx)(P.iTs,{})})]})]}),b&&f.length>0&&(0,M.jsx)("ul",{className:v,children:f.map((function(t){return(0,M.jsx)(e,{account:t,setAddMaster:a,onClick:c},t._id)}))})]})},w=function(e){var t=e.accounts;return(0,M.jsx)("div",{className:j,children:(null===t||void 0===t?void 0:t.length)>0?(0,M.jsx)(s.iA,{className:g,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Account Name"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"}],tfoot:(0,M.jsx)("tfoot",{children:(0,M.jsxs)("tr",{className:b,children:[(0,M.jsx)("td",{}),(0,M.jsx)("td",{}),(0,M.jsx)("td",{}),(0,M.jsx)("td",{className:"text-right",children:"Total"}),(0,M.jsx)("td",{className:"text-right",children:t.reduce((function(e,t){return e+t.debit}),0).toFixed(2)}),(0,M.jsx)("td",{className:"text-right",children:t.reduce((function(e,t){return e+t.credit}),0).toFixed(2)})]})}),children:t.map((function(e,t,n){var a,r,l;return(0,M.jsxs)("tr",{children:[(0,M.jsx)("td",{className:"grid",children:(null===(a=n[t-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(s.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,M.jsx)(s.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,M.jsx)("td",{children:(null===(r=n[t-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&e.no}),(0,M.jsx)("td",{children:(null===(l=n[t-1])||void 0===l?void 0:l.rec_id)!==e.rec_id&&e.type}),(0,M.jsx)("td",{children:e.accountName}),(0,M.jsx)("td",{className:"text-right",children:e.debit?e.debit.toFixed(2):null}),(0,M.jsx)("td",{className:"text-right",children:e.credit?e.credit.toFixed(2):null})]},t)}))}):(0,M.jsx)("p",{className:N,children:"No row has been selected."})})},R=function(e){var t=e.setSidebarOpen,n=(0,l.useRef)(),h=(0,l.useState)(null),m=(0,r.Z)(h,2),p=m[0],x=m[1],v=(0,l.useState)([]),N=(0,r.Z)(v,2),S=N[0],A=N[1],Z=(0,l.useState)("voucherListing"),T=(0,r.Z)(Z,2),F=T[0],B=T[1],I=(0,l.useState)(!0),R=(0,r.Z)(I,2),Y=R[0],O=R[1],W=(0,l.useState)([]),Q=(0,r.Z)(W,2),H=Q[0],z=Q[1],L=(0,l.useState)({}),V=(0,r.Z)(L,2),K=V[0],U=V[1],X=(0,q.i)(k.Hv.accountingMasters).get,J=(0,l.useMemo)((function(){return function(e){var t={};e.forEach((function(e){e.children=[],t[e._id]=e}));var n=[];return e.forEach((function(e){if(e.parent){var a=t[e.parent];a&&a.children.push(e)}else n.push(e)})),n}(S)}),[S]);return(0,l.useEffect)((function(){X({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return A(t.data)})).catch((function(e){return(0,i.N)({type:"error",message:e.message})}))}),[]),(0,M.jsxs)("div",{className:"".concat(c," grid gap-1 m-a"),children:[(0,M.jsx)("div",{className:"flex ".concat(C),children:(0,M.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return t((function(e){return!e}))},children:[(0,M.jsx)(P.Ps6,{style:{fontSize:"1.75rem"}}),(0,M.jsx)("h2",{children:"Accounting"})]})}),(0,M.jsxs)("div",{className:"".concat(o," ").concat(Y?f:""),children:[(0,M.jsxs)("div",{className:u,children:[(0,M.jsx)("button",{className:d,onClick:function(){return x({})},children:(0,M.jsx)(P.iTs,{})}),(0,M.jsx)("ul",{children:S.length>0?J.map((function(e){return(0,M.jsx)(E,{account:e,setAddMaster:x,onClick:function(e){return U((function(t){return(0,a.Z)((0,a.Z)({},t),{},{accountId:e._id})}))}},e._id)})):(0,M.jsx)("p",{style:{marginTop:"1rem",marginBottom:"1rem",textAlign:"center",textWrap:"balance",color:"#797979"},children:"No accounts have been added yet."})})]}),(0,M.jsxs)("div",{className:_,children:[(0,M.jsxs)("div",{className:"flex gap-1 align-center",children:[(0,M.jsx)("button",{className:"btn clear iconOnly",onClick:function(){return O(!Y)},children:(0,M.jsx)(D.kpB,{})}),(0,M.jsx)(s.mQ,{activeTab:F,tabs:[{label:"Voucher Listing",value:"voucherListing"},{label:"Acconting Analysys",value:"analysys"}],onChange:function(e){return B(e.value)}})]}),"voucherListing"===F&&(0,M.jsx)("div",{className:j,children:(0,M.jsx)(s.iA,{ref:n,url:k.Hv.accountingVouchers,countRecord:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t,n,a){var r;return e+((null===(r=a[n-1])||void 0===r?void 0:r.rec_id)!==t.rec_id?1:0)}),0)},filters:K,filterFields:[{label:"Type",fieldType:"select",name:"type",optionType:"predefined",options:[{label:"Invoice",value:"Invoice"},{label:"Purchase",value:"Purchase"},{label:"Receipt",value:"Receipt"},{label:"Payment",value:"Payment"}]},{label:"Start Date",fieldType:"input",inputType:"datetime-local",name:"startDate"},{label:"End Date",fieldType:"input",inputType:"datetime-local",name:"endDate"}],className:g,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Account Name"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"}],renderRow:function(e,t,a){var r,l,i;return(0,M.jsxs)("tr",{onClick:function(){z((function(){var t;return null===(t=n.current)||void 0===t?void 0:t.data.filter((function(t){return t.rec_id===e.rec_id}))})),B("analysys")},children:[(0,M.jsx)("td",{className:"grid",children:(null===(r=a[t-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(s.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,M.jsx)(s.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,M.jsx)("td",{children:(null===(l=a[t-1])||void 0===l?void 0:l.rec_id)!==e.rec_id&&e.no}),(0,M.jsx)("td",{children:(null===(i=a[t-1])||void 0===i?void 0:i.rec_id)!==e.rec_id&&e.type}),(0,M.jsx)("td",{children:e.accountName}),(0,M.jsx)("td",{className:"text-right",children:e.debit?e.debit.toFixed(2):null}),(0,M.jsx)("td",{className:"text-right",children:e.credit?e.credit.toFixed(2):null})]},t)},tfoot:function(e){return(0,M.jsx)("tfoot",{children:(0,M.jsxs)("tr",{className:b,children:[(0,M.jsx)("td",{}),(0,M.jsx)("td",{}),(0,M.jsx)("td",{}),(0,M.jsx)("td",{className:"text-right",children:"Total"}),(0,M.jsx)("td",{className:"text-right",children:e.reduce((function(e,t){return e+t.debit}),0).toFixed(2)}),(0,M.jsx)("td",{className:"text-right",children:e.reduce((function(e,t){return e+t.credit}),0).toFixed(2)})]})})}})}),"analysys"===F&&(0,M.jsx)(w,{accounts:H})]})]}),(0,M.jsx)(i.u,{open:p,head:!0,label:"".concat(null!==p&&void 0!==p&&p._id?"Update":"Add"," Account"),className:y,setOpen:function(){x(null)},children:(0,M.jsx)(G,{edit:p,masters:S,onSuccess:function(){X({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return A(t.data)})).catch((function(e){return(0,i.N)({type:"error",message:e.message})})),x(!1)}})})]})}}}]);
//# sourceMappingURL=764.8d3fafdd.chunk.js.map