"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[791],{3791:function(e,s,n){n.r(s),n.d(s,{default:function(){return N}});var a=n(2982),t=n(885),i=n(2791),r=n(4581),o=n(5470),l={content:"sales_content__GdsYo",sales:"sales_sales__uj55C",head:"sales_head__+MPID",addSaleForm:"sales_addSaleForm__SX3Wi",itemForm:"sales_itemForm__6fi8Q",itemName:"sales_itemName__IgaET",mainForm:"sales_mainForm__E2evN",print:"sales_print__qVWTI"},c=n(8750),u=n(5454),d=n(1080),m=n(1413),p=n(1134),f=n(1570),h=n(184),b=function(e){var s=e.edit,n=e.onSuccess,a=(0,i.useState)(!1),r=(0,t.Z)(a,2),b=r[0],_=r[1],g=(0,p.cI)({resolver:(0,u.y)(f.Ry({name:f.Z_().required(),phone:f.Z_().required(),password:s?f.Z_():f.Z_().required(),subPlan:f.Z_().required()}))}),v=g.control,x=g.handleSubmit,j=g.register,N=g.reset,y=g.formState.errors,S=(0,u.i)(d.Hv.businesses+"/".concat((null===s||void 0===s?void 0:s._id)||"")),w=S.post,Z=S.put,C=S.loading;return(0,i.useEffect)((function(){var e,n;N({name:(null===s||void 0===s?void 0:s.name)||"",phone:(null===s||void 0===s?void 0:s.phone)||"",password:"",subPlan:(null===s||void 0===s||null===(e=s.subscription)||void 0===e||null===(n=e.plan)||void 0===n?void 0:n._id)||""})}),[s]),(0,h.jsx)("div",{className:"grid gap-1 p-1 ".concat(l.addRoleForm),children:(0,h.jsxs)("form",{autoComplete:"new-password",onSubmit:x((function(e){e.password||delete e.password,(s?Z:w)(e).then((function(e){var s=e.data;if(!s.success)return(0,c.N)({type:"error",message:s.message});n(s.data,b)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))})),className:"".concat(l.mainForm," grid gap-1"),children:[(0,h.jsx)(o.II,(0,m.Z)((0,m.Z)({label:"Name"},j("name")),{},{required:!0,error:y.name})),(0,h.jsx)(o.II,(0,m.Z)((0,m.Z)({label:"Phone"},j("phone")),{},{required:!0,error:y.phone})),(0,h.jsx)(o.II,(0,m.Z)((0,m.Z)({label:"Password",type:"password"},j("password")),{},{required:!s,error:y.password})),(0,h.jsx)(o.OC,{control:v,label:"Subscription Plan*",name:"subPlan",url:d.Hv.subPlans,getQuery:function(e,s){return{name:e,_id:s}},handleData:function(e){return{label:e.name,value:e._id}}}),(0,h.jsxs)("div",{className:"btns",children:[(0,h.jsx)("button",{className:"btn",disabled:C,children:s?"Update":"Submit"}),!s&&(0,h.jsx)("button",{className:"btn",disabled:C,onClick:function(){_(!0)},children:"Next"})]})]})})},_=n(6871),g=n(2202),v=n(3974),x=n(5804),j=n(657),N=function(e){var s=e.setSidebarOpen,n=(0,i.useContext)(r.D),m=n.setBusiness,p=n.setConfig,f=n.setUser,N=(0,i.useState)([]),y=(0,t.Z)(N,2),S=y[0],w=y[1],Z=(0,i.useState)(!1),C=(0,t.Z)(Z,2),I=C[0],k=C[1],P=(0,_.s0)(),H=(0,u.i)(d.Hv.findBusinesses).get,q=(0,u.i)(d.Hv.adminSwitchAccount).post;return(0,i.useEffect)((function(){H().then((function(e){var s=e.data;s.success?w(s.data):(0,c.N)({type:"error",message:s.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[]),(0,h.jsxs)("div",{className:"".concat(l.content," grid gap-1 m-a"),children:[(0,h.jsxs)("div",{className:"flex ".concat(l.head," align-center gap-1"),children:[(0,h.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return s((function(e){return!e}))},children:[(0,h.jsx)(x.Ps6,{style:{fontSize:"1.75rem"}}),(0,h.jsx)("h2",{children:"All Businesses"})]}),(0,h.jsx)("button",{className:"btn clear iconOnly",onClick:function(){return k(!0)},children:(0,h.jsx)(j.ueT,{})})]}),(0,h.jsx)(o.iA,{className:l.sales,columns:[{label:"Business"},{label:"Phone"},{label:"Plan"},{label:"Actions"}],children:S.map((function(e){var s,n;return(0,h.jsxs)("tr",{onClick:function(s){["TR","TD"].includes(s.target.nodeName)&&(m({business:e}),p(e.config))},style:{cursor:"pointer"},children:[(0,h.jsx)("td",{children:e.phone}),(0,h.jsx)("td",{children:e.name}),(0,h.jsx)("td",{children:null===(s=e.subscription)||void 0===s||null===(n=s.plan)||void 0===n?void 0:n.name}),(0,h.jsx)(o.p2,{className:l.actions,actions:[{icon:(0,h.jsx)(v._fJ,{style:{fontSize:"1.15rem"}}),label:"Login as this Business",onClick:function(){(0,c.N)({type:"confirmation",message:"Are you sure you want to logout and login as this business?",callback:function(){q({phone:e.phone}).then((function(e){var s=e.data;if(s.success)return f(s.data),localStorage.setItem("userType",s.data.userType),void(window.location=d.Hb.dashboard.replace("*","")+d.Hb.quotes);(0,c.N)({type:"error",message:s.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}})}},{icon:(0,h.jsx)(g.KHI,{}),label:"Edit",onClick:function(){k(e)}}]})]},e._id)}))}),(0,h.jsx)(c.u,{open:!!I,head:!0,label:"".concat(null!==I&&void 0!==I&&I._id?"View / Update":"Add"," Business"),className:l.addBusinessFormModal,setOpen:function(){k(null)},children:(0,h.jsx)(b,{edit:null!==I&&void 0!==I&&I._id?I:null,onSuccess:function(e,s){null!==I&&void 0!==I&&I._id?w((function(s){return s.map((function(s){return s._id===e._id?e:s}))})):w((function(s){return[].concat((0,a.Z)(s),[e])})),k(null),s&&(m({business:e}),p(e.config),P(d.Hb.dashboard.replace("*","")+d.Hb.settings.baseUrl.replace("*","")+d.Hb.settings.businessInformation,{state:{next:s}}))}})})]})}}}]);
//# sourceMappingURL=791.e2f6eff3.chunk.js.map