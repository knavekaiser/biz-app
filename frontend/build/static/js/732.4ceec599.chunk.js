"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[732],{732:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var i=n(2982),c=n(885),r=n(2791),a=n(4581),o=n(5470),s=n(2202),d=n(8750),u="payments_content__KwuWi",l="payments_payments__4KMLq",_="payments_addPaymentFormModal__nh8z9",m="payments_addPaymentForm__nSugk",p="payments_entryForm__qUJci",f="payments_head__AhgB9",b="payments_date__OD-Nt",y="payments_customer__b5fUx",h="payments_actions__rjIfS",v="payments_mainForm__e9GN3",g="payments_mainFormWrapper__EAYy8",x=n(5454),j=n(1080),N=n(1413),I=n(1134),Z=(n(1570),n(2942)),C=n(184),S=function(e){var t=e.edit,n=e.onSuccess,a=(0,r.useState)([]),s=(0,c.Z)(a,2),u=s[0],l=s[1],_=(0,I.cI)(),f=_.handleSubmit,b=_.register,y=_.reset,h=_.control,S=_.setFocus,k=_.setValue,D=_.setError,A=_.clearErrors,E=_.formState.errors,P=(0,x.i)(j.Hv.journals+"/".concat((null===t||void 0===t?void 0:t._id)||"")),M=P.post,O=P.put,F=P.loading,q=(0,r.useCallback)((function(e){u.some((function(e,t){return(!e.accountId||!("credit"===e.type&&e.credit||"debit"===e.type&&e.debit))&&(e.type?"debit"!==e.type||e.debit?"credit"!==e.type||e.credit||D("entries_".concat(t,"_credit"),{type:"custom",message:"Please enter credit."}):D("entries_".concat(t,"_debit"),{type:"custom",message:"Please enter debit."}):D("entries_".concat(t,"_type"),{type:"custom",message:"Please select a type."}),e.accountId||D("entries_".concat(t,"_accountId"),{type:"custom",message:"Please select an account."}),!0)}))||(t?O({accountId:e.entries_0_accountId,credit:+e.entries_0_credit||0,debit:+e.entries_0_debit||0}):M({entries:u.map((function(e){return{accountId:e.accountId,debit:+e.debit||0,credit:+e.credit||0}}))})).then((function(e){var t=e.data;if(!t.success)return(0,d.N)({type:"error",message:t.message});n(t.data)})).catch((function(e){return(0,d.N)({type:"error",message:e.message})}))}),[u]);return(0,r.useEffect)((function(){y({entries_0_type:(null===t||void 0===t?void 0:t.debit)>(null===t||void 0===t?void 0:t.credit)?"debit":"credit",entries_0_accountId:(null===t||void 0===t?void 0:t.accountId)||"",entries_0_debit:(null===t||void 0===t?void 0:t.debit)||"",entries_0_credit:(null===t||void 0===t?void 0:t.credit)||""}),l([{_id:(null===t||void 0===t?void 0:t._id)||Math.random().toString(36),type:(null===t||void 0===t?void 0:t.debit)>(null===t||void 0===t?void 0:t.credit)?"debit":"credit",accountId:(null===t||void 0===t?void 0:t.accountId)||"",debit:(null===t||void 0===t?void 0:t.debit)||"",credit:(null===t||void 0===t?void 0:t.credit)||""}])}),[t]),(0,C.jsxs)("div",{className:"grid gap-1 p-1 ".concat(m),children:[(0,C.jsx)("h3",{children:"Entries"}),(0,C.jsx)("div",{className:"".concat(v," grid gap-1"),children:(0,C.jsxs)("form",{className:"".concat(g," grid gap-1 all-columns"),onSubmit:f(q),children:[(u||[]).map((function(e,t){return(0,C.jsxs)("div",{className:p,children:[(0,C.jsx)(o.hQ,{label:"Type",control:h,name:"entries_".concat(t,"_type"),formOptions:{required:!0},options:[{label:"Credit",value:"credit"},{label:"Debit",value:"debit"}],onChange:function(n){"credit"===n.value?A("entries_".concat(t,"_debit")):A("entries_".concat(t,"_credit")),l((function(t){return t.map((function(t){return t._id===e._id?(0,N.Z)((0,N.Z)({},t),{},{type:n.value}):t}))}))}}),(0,C.jsx)(o.OC,{label:"Account",control:h,name:"entries_".concat(t,"_accountId"),formOptions:{required:!0},url:j.Hv.accountingMasters,getQuery:function(e){return{isGroup:"false",name:e||""}},handleData:function(e){return{label:"".concat(e.name).concat(e.type?" - ".concat(e.type):""),value:e._id,account:e}},onChange:function(n){l((function(t){return t.map((function(t){return t._id===e._id?(0,N.Z)((0,N.Z)({},t),{},{accountId:n.value}):t}))})),S("entries_".concat(t,"_").concat(e.type))}}),(0,C.jsx)(o.II,(0,N.Z)((0,N.Z)({label:"Debit",type:"number",step:"0.01",required:!0,disabled:"credit"===e.type},b("entries_".concat(t,"_debit"))),{},{onChange:function(n){A("entries_".concat(t,"_debit")),l((function(t){return t.map((function(t){return t._id===e._id?(0,N.Z)((0,N.Z)({},t),{},{debit:n.target.value}):t}))}))},error:E["entries_".concat(t,"_debit")]})),(0,C.jsx)(o.II,(0,N.Z)((0,N.Z)({label:"Credit",type:"number",step:"0.01",required:!0,disabled:"debit"===e.type},b("entries_".concat(t,"_credit"))),{},{onChange:function(n){A("entries_".concat(t,"_credit")),l((function(t){return t.map((function(t){return t._id===e._id?(0,N.Z)((0,N.Z)({},t),{},{credit:n.target.value}):t}))}))},error:E["entries_".concat(t,"_credit")]})),u.length>1&&(0,C.jsx)("button",{type:"button",onClick:function(){return l((function(t){return t.filter((function(t){return t._id!==e._id}))}))},className:"btn clear iconOnly",children:(0,C.jsx)(Z.K3i,{})})]},e._id)})),!F&&!t&&(0,C.jsx)("button",{type:"button",className:"btn secondary",onClick:function(){k("entries_".concat(u.length,"_type"),"credit"),l((function(e){return[].concat((0,i.Z)(e),[{_id:Math.random().toString(36),type:"credit",accountId:"",debit:"",credit:""}])}))},children:"Add More Entry"}),(0,C.jsx)("div",{className:"btns",children:(0,C.jsx)("button",{className:"btn",disabled:F,children:t?"Update":"Submit"})})]})})]})},k=n(5804),D=n(657),A=n(4316),E=function(e){var t=e.setSidebarOpen,n=(0,r.useContext)(a.D),m=n.config,p=n.checkPermission,v=(0,r.useState)([]),g=(0,c.Z)(v,2),N=g[0],I=g[1],Z=(0,r.useState)(null),E=(0,c.Z)(Z,2),P=E[0],M=E[1],O=(0,r.useState)(!1),F=(0,c.Z)(O,2),q=F[0],Y=F[1],w=(0,x.i)(j.Hv.journals),H=w.get,U=w.loading,J=(0,x.i)(j.Hv.journals+"/{ID}").remove;return(0,r.useEffect)((function(){H().then((function(e){var t=e.data;if(t.success)return I(t.data)})).catch((function(e){return(0,d.N)({type:"error",message:e.message})}))}),[]),(0,C.jsxs)("div",{className:"".concat(u," grid gap-1 m-a p-1"),children:[(0,C.jsx)("div",{className:"flex ".concat(f),children:(0,C.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return t((function(e){return!e}))},children:[(0,C.jsx)(k.Ps6,{style:{fontSize:"1.75rem"}}),(0,C.jsx)("h2",{children:"Journals"}),p("journal_create")&&(0,C.jsx)("button",{className:"btn clear iconOnly",onClick:function(e){e.stopPropagation(),Y(!0)},children:(0,C.jsx)(D.ueT,{})})]})}),(0,C.jsx)(o.iA,{loading:U,className:l,columns:[{label:"Date"},{label:"Account"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"},{label:"Action"}],children:N.map((function(e){return(0,C.jsxs)("tr",{onClick:function(){M(e),Y(!0)},style:{cursor:"pointer"},children:[(0,C.jsx)("td",{className:b,children:(0,C.jsx)(o.W7,{format:"DD/MM/YYYY",children:e.updatedAt})}),(0,C.jsx)("td",{className:y,children:e.accountName}),(0,C.jsx)("td",{className:"text-right",children:e.debit?e.debit.toFixed(2,null===m||void 0===m?void 0:m.numberSeparator):null}),(0,C.jsx)("td",{className:"text-right",children:e.credit?e.credit.fix(2,null===m||void 0===m?void 0:m.numberSeparator):null}),(0,C.jsx)(o.p2,{className:h,actions:[{icon:(0,C.jsx)(A.dou,{}),label:"Edit",onClick:function(){M(e),Y(!0)}}].concat((0,i.Z)(p("journal_delete")?[{icon:(0,C.jsx)(s.lp8,{}),label:"Delete",onClick:function(){return(0,d.N)({type:"confirmation",message:"Are you sure you want to remove this entry?",callback:function(){J({},{params:{"{ID}":e._id}}).then((function(t){var n=t.data;n.success?I((function(t){return t.filter((function(t){return t._id!==e._id}))})):(0,d.N)({type:"error",message:n.message})}))}})}}]:[]))})]},e._id)}))}),(0,C.jsx)(d.u,{open:q,head:!0,label:"".concat(P?"Update":"Add"," Journal Entries"),className:_,setOpen:function(){M(null),Y(!1)},children:(0,C.jsx)(S,{edit:P,payments:N,onSuccess:function(e){P?(I((function(t){return t.map((function(t){return t._id===e._id?e:t}))})),M(null)):I((function(t){return[].concat((0,i.Z)(t),(0,i.Z)(e))})),Y(!1)}})})]})}}}]);
//# sourceMappingURL=732.4ceec599.chunk.js.map