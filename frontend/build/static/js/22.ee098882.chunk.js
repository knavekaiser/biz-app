"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[22],{2022:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var a=n(1413),r=n(2982),s=n(885),i=n(2791),l=n(5470),c=n(8750),o={content:"quotes_content__d6QGt",innerWrapper:"quotes_innerWrapper__0o8+D",sidebar:"quotes_sidebar__OueuR",addButton:"quotes_addButton__XE+Gn",btns:"quotes_btns__y2nuy",listItem:"quotes_listItem__ityEv",label:"quotes_label__VuSPM",accountName:"quotes_accountName__zyenQ",highlight:"quotes_highlight__DDeNz",nestedList:"quotes_nestedList__B-cIy",open:"quotes_open__aa1x+",innerContent:"quotes_innerContent__wCHU6",innerContentWrapper:"quotes_innerContentWrapper__rKsb7",vouchers:"quotes_vouchers__t8sKZ",footer:"quotes_footer__AWxAV",analysysPlaceholder:"quotes_analysysPlaceholder__0wx94",voucherFilters:"quotes_voucherFilters__UNLDz",masterFormModal:"quotes_masterFormModal__36AN0",masterForm:"quotes_masterForm__dXJKs",print:"quotes_print__ir6Gn",logo:"quotes_logo__Vsg-f",box:"quotes_box__+p8As",items:"quotes_items__ANNmM",taxes:"quotes_taxes__cyTAG",totalAmount:"quotes_totalAmount__rIs44",word:"quotes_word__sjhD8",digit:"quotes_digit__VyweO",sign:"quotes_sign__sG6wg",signature:"quotes_signature__YnCoV",head:"quotes_head__uo7Hz",quotes:"quotes_quotes__tCxCu",date:"quotes_date__KOSsI",customer:"quotes_customer__6hEHP",net:"quotes_net__h-6C4",actions:"quotes_actions__Qdwow",addQuoteForm:"quotes_addQuoteForm__fmLXp",itemForm:"quotes_itemForm__E47xe",itemName:"quotes_itemName__hYpvW",mainForm:"quotes_mainForm__Neb5l"},u=n(5454),d=n(1080),m=n(1134),h=n(1570),x=n(184),f=h.Ry({name:h.Z_().required("Please enter a name"),parent:h.Z_(),type:h.Z_().oneOf(["Cash","Bank","Customers","Suppliers","Sales","Purchase","Stock","null","Tax",null]).nullable(),isGroup:h.O7().required(),openingBalance:h.Rx().min(0,"Opening balance can't be less than 0.").required("Please enter opening balance").typeError("Please enter a valid number")}),p=function(e){var t=e.edit,n=e.masters,s=void 0===n?[]:n,h=e.onSuccess,p=(0,m.cI)({resolver:(0,u.y)(f)}),v=p.handleSubmit,g=p.register,b=p.reset,_=p.control,j=p.formState.errors,N=(0,u.i)(d.Hv.accountingMasters+"/".concat((null===t||void 0===t?void 0:t._id)||"")),y=N.post,S=N.put,D=N.loading;return(0,i.useEffect)((function(){var e;b({name:(null===t||void 0===t?void 0:t.name)||"",parent:(null===t||void 0===t?void 0:t.parent)||"null",type:(null===t||void 0===t?void 0:t.type)||"null",isGroup:null===(e=null===t||void 0===t?void 0:t.isGroup)||void 0===e||e,openingBalance:Math.abs((null===t||void 0===t?void 0:t.openingBalance)||0),balanceType:(null===t||void 0===t?void 0:t.balanceType)||((null===t||void 0===t?void 0:t.openingBalance)<0?"credit":"debit")})}),[t]),(0,x.jsxs)("form",{onSubmit:v((function(e){var n=(0,a.Z)((0,a.Z)({},e),{},{openingBalance:"credit"===e.balanceType?-e.openingBalance:e.openingBalance});"null"===e.parent&&(n.parent=null),"null"===e.type&&(n.type=null),(null!==t&&void 0!==t&&t._id?S:y)(n).then((function(e){var t=e.data;if(!t.success)return(0,c.N)({type:"error",message:t.message});h(t.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))})),className:"".concat(o.masterForm," grid gap-1"),children:[(0,x.jsx)(l.II,(0,a.Z)((0,a.Z)({label:"Name"},g("name")),{},{required:!0,error:j.name})),(0,x.jsx)(l.hQ,{label:"Parent",name:"parent",control:_,options:[{label:"None",value:"null"}].concat((0,r.Z)(s.map((function(e){return{label:e.name,value:e._id}}))))}),(0,x.jsx)(l.hQ,{label:"Type",name:"type",control:_,options:[{label:"None",value:"null"},{label:"Cash",value:"Cash"},{label:"Bank",value:"Bank"},{label:"Customers",value:"Customers"},{label:"Suppliers",value:"Suppliers"},{label:"Sales",value:"Sales"},{label:"Purchase",value:"Purchase"},{label:"Stock",value:"Stock"},{label:"Tax",value:"Tax"}]}),(0,x.jsx)(l.hQ,{label:"Is Group",name:"isGroup",control:_,formOptions:{required:!0},options:[{label:"No",value:!1},{label:"Yes",value:!0}]}),(0,x.jsx)("label",{style:{fontWeight:"semibold",fontSize:"14px"},children:"Opening Balance *"}),(0,x.jsx)(l.rG,{control:_,name:"balanceType",options:[{label:"Credit",value:"credit"},{label:"Debit",value:"debit"}]}),(0,x.jsx)(l.II,(0,a.Z)((0,a.Z)({type:"number"},g("openingBalance")),{},{required:!0,error:j.openingBalance})),(0,x.jsx)("div",{className:"btns",children:(0,x.jsx)("button",{className:"btn",disabled:D,children:null!==t&&void 0!==t&&t._id?"Update":"Submit"})})]})},v=n(5804),g=n(3974),b=n(1765),_=n(4794),j=function(e){e.filters;var t=e.setFilters,n=(0,m.cI)(),r=n.handleSubmit,s=n.register,i=n.reset,c=n.control,u=n.formState.errors;return(0,x.jsxs)("form",{onSubmit:r((function(e){var n={};e.type&&(n.type=e.type),e.startDate&&e.endDate&&(n.startDate=e.startDate,n.endDate=e.endDate),t(n)})),className:"".concat(o.voucherFilters," grid gap-1"),children:[(0,x.jsx)(l.hQ,{label:"Type",name:"type",control:c,options:[{label:"Invoice",value:"Invoice"},{label:"Sales Return",value:"Sales Return"},{label:"Purchase",value:"Purchase"},{label:"Purchase Return",value:"Purchase Return"},{label:"Receipt",value:"Receipt"},{label:"Payment",value:"Payment"}]}),(0,x.jsx)(l.II,(0,a.Z)((0,a.Z)({label:"Start Date",type:"datetime-local"},s("startDate")),{},{required:!0,error:u.startDate})),(0,x.jsx)(l.II,(0,a.Z)((0,a.Z)({label:"End Date",type:"datetime-local"},s("endDate")),{},{required:!0,error:u.endDate})),(0,x.jsxs)("div",{className:"flex gap-1",children:[(0,x.jsx)("button",{className:"btn",children:"Search"}),(0,x.jsx)("button",{className:"btn secondary",type:"button",onClick:function(){i(),t({})},children:"Clear"})]})]})},N=function(e){e.filters;var t=e.setFilters,n=(0,m.cI)(),r=n.handleSubmit,s=n.register,i=n.reset,c=(n.control,n.formState.errors);return(0,x.jsxs)("form",{onSubmit:r((function(e){var n={};e.type&&(n.type=e.type),e.startDate&&e.endDate&&(n.startDate=e.startDate,n.endDate=e.endDate),t(n)})),className:"".concat(o.voucherFilters," grid gap-1"),children:[(0,x.jsx)(l.II,(0,a.Z)((0,a.Z)({label:"Start Date",type:"date"},s("startDate")),{},{required:!0,error:c.startDate})),(0,x.jsx)(l.II,(0,a.Z)((0,a.Z)({label:"End Date",type:"date"},s("endDate")),{},{required:!0,error:c.endDate})),(0,x.jsxs)("div",{className:"flex gap-1",children:[(0,x.jsx)("button",{className:"btn",children:"Search"}),(0,x.jsx)("button",{className:"btn secondary",type:"button",onClick:function(){i(),t({})},children:"Clear"})]})]})},y=n(4581),S=function e(t){var n=t.masters,a=t.account,r=t.setAddMaster,l=t.activeGroup,m=t.activeLeaf,h=t.activeLeavs,f=void 0===h?[]:h,p=t.defaultBalanceType,b=t.onClick,j=void 0===b?function(){}:b,N=(0,i.useState)([]),y=(0,s.Z)(N,2),S=y[0],D=y[1],C=(0,i.useState)(!1),q=(0,s.Z)(C,2),Z=q[0],I=q[1],B=(0,u.i)(d.Hv.accountingMasters),A=B.get,F=B.loading;return(0,i.useEffect)((function(){a.children&&(a.children.length&&a.totalChildren>a.children.length?A({query:{parent:a._id}}).then((function(e){var t=e.data;t.success?(D(t.data),I(!0)):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})})):(D(a.children),I(!(null===a||void 0===a||!a.isGroup)&&a.children.length>0)))}),[a.children]),(0,x.jsxs)("li",{style:{whiteSpace:"nowrap"},className:o.listItem,children:[(0,x.jsxs)("div",{className:o.label,children:[a.isGroup&&(0,x.jsx)(x.Fragment,{children:((null===S||void 0===S?void 0:S.length)||a.totalChildren)>0?(0,x.jsx)("button",{onClick:function(){(null===S||void 0===S?void 0:S.length)===a.totalChildren?I(!Z):A({query:{parent:a._id}}).then((function(e){var t=e.data;t.success?(D(t.data),I(!0)):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))},children:F?(0,x.jsx)(_.frZ,{className:"spin"}):Z?(0,x.jsx)(v.IgQ,{}):(0,x.jsx)(v.b5v,{})}):(0,x.jsx)("button",{style:{height:"16px",width:"16px",border:"1px dashed #818181",borderRadius:"2px",pointerEvents:"none"}})}),(0,x.jsx)("strong",{className:"".concat(o.accountName," ").concat(a.isGroup&&l===a._id||!a.isGroup&&m===a._id||f.includes(a._id)?o.highlight:""),onClick:function(){j(a)},children:a.name}),(0,x.jsxs)("div",{className:o.btns,children:[(0,x.jsx)("button",{className:o.addButton,onClick:function(){return r(a)},children:(0,x.jsx)(g.Nte,{})}),a.isGroup&&(0,x.jsx)("button",{className:o.addButton,onClick:function(){r({parent:a._id,type:a.type||"",balanceType:p})},children:(0,x.jsx)(v.iTs,{})})]})]}),Z&&S.length>0&&(0,x.jsx)("ul",{className:"".concat(o.nestedList," ").concat(a.isGroup&&l===a._id?o.highlight:""),children:S.map((function(t){return(0,x.jsx)(e,{defaultBalanceType:p,masters:n,activeGroup:l,activeLeaf:m,activeLeavs:f,account:t,setAddMaster:r,onClick:j},t._id)}))})]})},D=function(e){var t=e.vouchers,n=e.setVouchers,a=(0,i.useContext)(y.D).config,r=(0,i.useState)({}),m=(0,s.Z)(r,2),h=m[0],f=m[1],p=(0,i.useRef)(),v=(0,u.i)(d.Hv.accountingVouchers).get;return(0,i.useEffect)((function(){v({query:h}).then((function(e){var t=e.data;t.success?n(t.data):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[h]),(0,x.jsxs)("div",{className:o.innerContentWrapper,children:[(0,x.jsx)(j,{filters:h,setFilters:f}),(0,x.jsx)(l.iA,{ref:p,countRecord:function(){return t.reduce((function(e,t,n,a){var r;return e+((null===(r=a[n-1])||void 0===r?void 0:r.rec_id)!==t.rec_id?1:0)}),0)},className:o.vouchers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Account Name"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"}],tfoot:function(){return(0,x.jsx)("tfoot",{children:(0,x.jsxs)("tr",{className:o.footer,children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{}),(0,x.jsx)("td",{}),(0,x.jsx)("td",{className:"text-right",children:"Total"}),(0,x.jsx)("td",{className:"text-right",children:t.reduce((function(e,t){return e+t.debit}),0).fix(2,null===a||void 0===a?void 0:a.numberSeparator)}),(0,x.jsx)("td",{className:"text-right",children:t.reduce((function(e,t){return e+t.credit}),0).fix(2,null===a||void 0===a?void 0:a.numberSeparator)})]})})},children:t.map((function(e,t,n){var r,s,i;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"grid",children:(null===(r=n[t-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(l.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,x.jsx)(l.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,x.jsx)("td",{children:(null===(s=n[t-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.no}),(0,x.jsx)("td",{children:(null===(i=n[t-1])||void 0===i?void 0:i.rec_id)!==e.rec_id&&e.type}),(0,x.jsx)("td",{children:e.accountName}),(0,x.jsx)("td",{className:"text-right",children:e.debit?e.debit.fix(2,null===a||void 0===a?void 0:a.numberSeparator):null}),(0,x.jsx)("td",{className:"text-right",children:e.credit?e.credit.fix(2,null===a||void 0===a?void 0:a.numberSeparator):null})]},t)}))})]})},C=function(e){var t=e.account,n=(e.rows,(0,i.useContext)(y.D).config),a=(0,i.useState)([]),r=(0,s.Z)(a,2),m=r[0],h=r[1],f=(0,i.useState)(0),p=(0,s.Z)(f,2),v=p[0],g=p[1],b=(0,i.useState)({}),_=(0,s.Z)(b,2),j=_[0],S=_[1],D=(0,u.i)(d.Hv.accountingLedgers).get,C=v+m.reduce((function(e,t){return e+t.debit}),0)-m.reduce((function(e,t){return e+t.credit}),0);return(0,i.useEffect)((function(){if(t){var e={accountId:t._id};j.startDate&&j.endDate&&(e.startDate=j.startDate,e.endDate=j.endDate),D({query:e}).then((function(e){var t=e.data;t.success?(h(t.data),g(t.openingBalance||0)):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}else h([])}),[t,j]),(0,x.jsx)("div",{className:o.innerContentWrapper,children:t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(N,{filter:j,setFilters:S}),(0,x.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"mt-1 pl_5",children:t.name}),(0,x.jsxs)(l.iA,{className:o.vouchers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Account Name"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"}],tfoot:(0,x.jsxs)("tfoot",{style:{marginTop:"0"},children:[(0,x.jsxs)("tr",{className:o.footer,children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{}),(0,x.jsx)("td",{style:{fontWeight:"bold"},children:"Totals"}),(0,x.jsx)("td",{}),(0,x.jsx)("td",{className:"text-right",children:m.reduce((function(e,t){return e+t.debit}),0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)}),(0,x.jsx)("td",{className:"text-right",children:m.reduce((function(e,t){return e+t.credit}),0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)})]}),(0,x.jsxs)("tr",{className:o.footer,children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{}),(0,x.jsx)("td",{style:{fontWeight:"bold"},children:"Closing Balance"}),(0,x.jsx)("td",{}),C<0?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{className:"text-right",children:Math.abs(C).fix(2,null===n||void 0===n?void 0:n.numberSeparator)})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"text-right",children:Math.abs(C).fix(2,null===n||void 0===n?void 0:n.numberSeparator)}),(0,x.jsx)("td",{})]})]})]}),children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{}),(0,x.jsx)("td",{style:{fontWeight:"bold"},className:"grid",children:"Opening Balance"}),(0,x.jsx)("td",{}),v<0?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{className:"text-right",children:Math.abs(v||0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"text-right",children:Math.abs(v||0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)}),(0,x.jsx)("td",{})]})]}),m.map((function(e,t,a){var r,s,i,c;return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"grid",children:e.createdAt&&(null===(r=a[t-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(l.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,x.jsx)(l.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,x.jsx)("td",{children:(null===(s=a[t-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.no}),(0,x.jsx)("td",{children:(null===(i=a[t-1])||void 0===i?void 0:i.rec_id)!==e.rec_id&&e.type}),(0,x.jsx)("td",{className:"grid",children:(null===(c=e.details)||void 0===c?void 0:c.length)>0?"Details:":e.accountName}),(0,x.jsx)("td",{className:"text-right",children:e.debit?e.debit.fix(2,null===n||void 0===n?void 0:n.numberSeparator):null}),(0,x.jsx)("td",{className:"text-right",children:e.credit?e.credit.fix(2,null===n||void 0===n?void 0:n.numberSeparator):null})]},t)}))]})]}):(0,x.jsx)("p",{className:o.analysysPlaceholder,children:"No account has been selected."})})},q=function(e){var t=e.account,n=(0,i.useContext)(y.D).config,a=(0,i.useState)([]),m=(0,s.Z)(a,2),h=m[0],f=m[1],p=(0,i.useState)({}),v=(0,s.Z)(p,2),g=v[0],b=v[1],_=(0,i.useState)({}),j=(0,s.Z)(_,2),S=j[0],D=j[1],C=(0,i.useState)([]),q=(0,s.Z)(C,2),I=q[0],B=q[1],A=(0,i.useState)("sum_debit"),F=(0,s.Z)(A,2),M=F[0],T=F[1],k=Object.values(S||{}).reduce((function(e,t){return e+(t||0)}),0),G=I.reduce((function(e,t){return e+((S[t._id]||0)+t.entries.flat().reduce((function(e,t){return e+t.debit}),0)-t.entries.flat().reduce((function(e,t){return e+t.credit}),0))}),0),W=(0,u.i)(d.Hv.accountingMonthlyAnalysys),P=W.get,w=W.loading;return(0,i.useEffect)((function(){if(t){var e={accountId:t._id};g.startDate&&g.endDate&&(e.startDate=g.startDate,e.endDate=g.endDate),P({query:e}).then((function(e){var t=e.data;t.success?(B(t.data),f(t.months),D(t.openingBalances)):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}else B([]),f([])}),[t,g]),(0,i.useEffect)((function(){t&&T(["Liabilities","Income"].includes(null===t||void 0===t?void 0:t.name)?"sum_credit":"sum_debit")}),[t]),(0,x.jsx)("div",{className:o.innerContentWrapper,children:t?(0,x.jsxs)("div",{children:[(0,x.jsx)(N,{filters:g,setFilters:b}),(0,x.jsxs)("div",{className:"mt-1 flex gap-2 align-center",children:[(0,x.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"pl_5",children:t.name}),(0,x.jsxs)("div",{className:"flex gap-2",children:[(0,x.jsxs)("label",{className:"flex align-center gap_5",children:[(0,x.jsx)("input",{name:"calculation",type:"radio",value:"statement",checked:"statement"===M,onChange:function(e){return T(e.target.value)}}),"Accounting Statement"]}),(0,x.jsxs)("label",{className:"flex align-center gap_5",children:[(0,x.jsx)("input",{name:"calculation",type:"radio",value:"sum_debit",checked:"sum_debit"===M,onChange:function(e){return T(e.target.value)}}),"Sum Of Debits"]}),(0,x.jsxs)("label",{className:"flex align-center gap_5",children:[(0,x.jsx)("input",{name:"calculation",type:"radio",value:"sum_credit",checked:"sum_credit"===M,onChange:function(e){return T(e.target.value)}}),"Sum Of Credit"]}),(0,x.jsxs)("label",{className:"flex align-center gap_5",children:[(0,x.jsx)("input",{name:"calculation",type:"radio",value:"net",checked:"net"===M,onChange:function(e){return T(e.target.value)}}),"Net"]}),(0,x.jsxs)("label",{className:"flex align-center gap_5",children:[(0,x.jsx)("input",{name:"calculation",type:"radio",value:"balance",checked:"balance"===M,onChange:function(e){return T(e.target.value)}}),"Balance"]})]})]}),(0,x.jsx)(l.iA,{loading:w,className:o.analysys,columns:[{label:t.name}].concat((0,r.Z)("statement"===M?[{label:"Opening Balance",className:"text-right"},{label:"Total Debit",className:"text-right"},{label:"Total Credit",className:"text-right"},{label:"Closing Balance",className:"text-right"}]:(h||[]).map((function(e){return{label:e.label,className:"text-right"}})))),tfoot:(0,x.jsx)("tfoot",{style:{marginTop:"0"},children:(0,x.jsxs)("tr",{className:o.footer,style:{borderTop:"1px solid #979797",padding:"0 0.5rem",paddingTop:"1rem"},children:[(0,x.jsx)("td",{children:"Total"}),"statement"===M?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("td",{className:"text-right",children:[Math.abs(k).fix(2,null===n||void 0===n?void 0:n.numberSeparator)," ",k<0?"Cr.":"Dr."]}),(0,x.jsx)("td",{className:"text-right",children:I.reduce((function(e,t){return e+t.entries.flat().reduce((function(e,t){return e+t.debit}),0)}),0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)}),(0,x.jsx)("td",{className:"text-right",children:I.reduce((function(e,t){return e+t.entries.flat().reduce((function(e,t){return e+t.credit}),0)}),0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)}),(0,x.jsxs)("td",{className:"text-right",children:[Math.abs(G).fix(2,null===n||void 0===n?void 0:n.numberSeparator)," ",G<0?"Cr.":"Dr."]})]}):(h||[]).map((function(e,t){return(0,x.jsx)("td",{className:"text-right",children:Z(M,I.reduce((function(e,n,a){return e.push.apply(e,(0,r.Z)(n.entries[t])),e}),[]),0,null===n||void 0===n?void 0:n.numberSeparator)},t)}))]})}),children:(I||[]).map((function(e,t,a){var r,s=(S[e._id]||0)+e.entries.flat().reduce((function(e,t){return e+t.debit}),0)-e.entries.flat().reduce((function(e,t){return e+t.credit}),0);return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"grid",children:e.name}),"statement"===M?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("td",{className:"text-right",children:[null===(r=Math.abs(S[e._id]))||void 0===r?void 0:r.fix(2,null===n||void 0===n?void 0:n.numberSeparator)," ",S[e._id]<0?"Cr.":"Dr."]}),(0,x.jsx)("td",{className:"text-right",children:e.entries.flat().reduce((function(e,t){return e+t.debit}),0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)}),(0,x.jsx)("td",{className:"text-right",children:e.entries.flat().reduce((function(e,t){return e+t.credit}),0).fix(2,null===n||void 0===n?void 0:n.numberSeparator)}),(0,x.jsxs)("td",{className:"text-right",children:[Math.abs(s).fix(2,null===n||void 0===n?void 0:n.numberSeparator)," ",s<0?"Cr.":"Dr."]})]}):(h||[]).map((function(t,a){return(0,x.jsx)("td",{className:"text-right",children:Z(M,e.entries[a],e.openingBalance,null===n||void 0===n?void 0:n.numberSeparator)},a)}))]},t)}))})]}):(0,x.jsx)("p",{className:o.analysysPlaceholder,children:"No group has been selected."})})},Z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,r=null;return"sum_debit"===e?r=t.reduce((function(e,t){return e+t.debit}),0):"statement"===e?r=t.reduce((function(e,t){return e+t.debit-t.credit}),0):"sum_credit"===e?r=t.reduce((function(e,t){return e+t.credit}),0):"net"===e?r=t.reduce((function(e,t){return e+t.debit-t.credit}),0):"balance"===e&&(r=t.reduce((function(e,t){return e+t.debit-t.credit}),0)+n),["net","balance"].includes(e)?"".concat(Math.abs(r).fix(2,a)," ").concat(r<0?"Cr.":"Dr."):r.fix(2,a)},I=function(e){var t=e.setSidebarOpen,n=(0,i.useContext)(y.D).config,m=(0,i.useState)(null),h=(0,s.Z)(m,2),f=h[0],g=h[1],_=(0,i.useState)([]),j=(0,s.Z)(_,2),N=j[0],Z=j[1],I=(0,i.useState)("voucherListing"),B=(0,s.Z)(I,2),A=B[0],F=B[1],M=(0,i.useState)(!0),T=(0,s.Z)(M,2),k=T[0],G=T[1],W=(0,i.useState)(null),P=(0,s.Z)(W,2),w=P[0],L=P[1],E=(0,i.useState)({}),O=(0,s.Z)(E,2),R=O[0],Q=O[1],Y=(0,i.useState)([]),z=(0,s.Z)(Y,2),H=z[0],V=z[1],K=(0,i.useState)([]),U=(0,s.Z)(K,2),X=U[0],J=U[1],$=(0,u.i)(d.Hv.accountingMasters).get,ee=(0,i.useMemo)((function(){return function(e){var t={};e.forEach((function(e){e.children=[],t[e._id]=e}));var n=[];return e.forEach((function(e){if(e.parent){var a=t[e.parent];a&&a.children.push(e)}else n.push(e)})),n}(N)}),[N]);return(0,i.useEffect)((function(){$({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return Z(t.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[]),(0,x.jsxs)("div",{className:"".concat(o.content," grid gap-1 m-a"),children:[(0,x.jsx)("div",{className:"flex ".concat(o.head),children:(0,x.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return t((function(e){return!e}))},children:[(0,x.jsx)(v.Ps6,{style:{fontSize:"1.75rem"}}),(0,x.jsx)("h2",{children:"Accounting"})]})}),(0,x.jsxs)("div",{className:"".concat(o.innerWrapper," ").concat(k?o.open:""),children:[(0,x.jsxs)("div",{className:o.sidebar,children:[(0,x.jsx)("button",{className:o.addButton,onClick:function(){return g({})},children:(0,x.jsx)(v.iTs,{})}),(0,x.jsx)("ul",{children:N.length>0?ee.map((function(e){var t;return(0,x.jsx)(S,{defaultBalanceType:"Assets"===e.name?"debit":"credit",masters:N,account:e,setAddMaster:g,activeGroup:"analysys"===A?null===w||void 0===w?void 0:w._id:null,activeLeaf:"ledgers"===A?null===R||void 0===R||null===(t=R.account)||void 0===t?void 0:t._id:null,activeLeavs:"journals"===A?X.map((function(e){return e._id})):[],onClick:function(e){if("journals"!==A)if(e.isGroup)L(e),F("analysys");else{var t=(H||[]).filter((function(t){return t.accountId===e._id})),s=(H||[]).filter((function(e){return t.some((function(t){return t.rec_id===e.rec_id}))})),i=[].concat((0,r.Z)(t),(0,r.Z)(s)).filter((function(e,t,n){return t===n.findIndex((function(t){return t.rec_id===e.rec_id&&t.index===e.index}))})),l=i.filter((function(t){return t.accountId!==e._id})).reduce((function(e,t){var n=e.findIndex((function(e){return e.some((function(e){return e.rec_id===t.rec_id}))}));return-1===n?e.push([t]):e[n].push(t),e}),[]).map((function(e){var t=i.find((function(t){return t.rec_id===e[0].rec_id}));return e.length<=1?(0,a.Z)((0,a.Z)({},e[0]),{},{debit:t.debit,credit:t.credit}):(0,a.Z)((0,a.Z)({},e[0]),{},{details:e.map((function(e){return{label:e.accountName,value:e.credit||e.debit}})),debit:t.debit,credit:t.credit})})).sort((function(e,t){return new Date(e)>new Date(t)?1:-1})).sort((function(e,t){return e.index>t.index?1:-1})).reduce((function(e,t){var a;return null!==(a=t.details)&&void 0!==a&&a.length?e.push.apply(e,[t].concat((0,r.Z)(t.details.map((function(e){return{createdAt:null,no:null,type:null,accountName:(0,x.jsxs)("p",{children:[e.label,":"," ",e.value.fix(2,null===n||void 0===n?void 0:n.numberSeparator)]}),debit:null,credit:null}}))))):e.push(t),e}),[]);Q({account:e,rows:l}),F("ledgers")}else e.isGroup||J((function(t){return t.some((function(t){return t._id===e._id}))?t.filter((function(t){return t._id!==e._id})):[].concat((0,r.Z)(t),[e]).filter((function(e,t,n){return n.findIndex((function(t){return t._id===e._id}))===t}))}))}},e._id)})):(0,x.jsx)("p",{style:{marginTop:"1rem",marginBottom:"1rem",textAlign:"center",textWrap:"balance",color:"#797979"},children:"No accounts have been added yet."})})]}),(0,x.jsxs)("div",{className:o.innerContent,children:[(0,x.jsxs)("div",{className:"flex gap-1 align-center",children:[(0,x.jsx)("button",{className:"btn clear iconOnly",onClick:function(){return G(!k)},children:(0,x.jsx)(b.kpB,{})}),(0,x.jsx)(l.mQ,{activeTab:A,tabs:[{label:"Voucher Listing",value:"voucherListing"},{label:"Ledgers",value:"ledgers"},{label:"Accounting Analysys",value:"analysys"}],onChange:function(e){return F(e.value)}})]}),"voucherListing"===A&&(0,x.jsx)(D,{vouchers:H,setVouchers:V}),"ledgers"===A&&(0,x.jsx)(C,{account:null===R||void 0===R?void 0:R.account,rows:null===R||void 0===R?void 0:R.rows}),"analysys"===A&&(0,x.jsx)(q,{account:w})]})]}),(0,x.jsx)(c.u,{open:f,head:!0,label:"".concat(null!==f&&void 0!==f&&f._id?"Update":"Add"," Account"),className:o.masterFormModal,setOpen:function(){g(null)},children:(0,x.jsx)(p,{edit:f,masters:N,onSuccess:function(){$({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return Z(t.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})})),g(!1)}})})]})}}}]);
//# sourceMappingURL=22.ee098882.chunk.js.map