"use strict";(self.webpackChunkcash_app=self.webpackChunkcash_app||[]).push([[764],{9764:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var a=n(1413),r=n(2982),s=n(885),i=n(2791),l=n(5470),c=n(8750),o={content:"quotes_content__d6QGt",innerWrapper:"quotes_innerWrapper__0o8+D",sidebar:"quotes_sidebar__OueuR",addButton:"quotes_addButton__XE+Gn",btns:"quotes_btns__y2nuy",listItem:"quotes_listItem__ityEv",label:"quotes_label__VuSPM",accountName:"quotes_accountName__zyenQ",highlight:"quotes_highlight__DDeNz",nestedList:"quotes_nestedList__B-cIy",open:"quotes_open__aa1x+",innerContent:"quotes_innerContent__wCHU6",innerContentWrapper:"quotes_innerContentWrapper__rKsb7",vouchers:"quotes_vouchers__t8sKZ",footer:"quotes_footer__AWxAV",analysysPlaceholder:"quotes_analysysPlaceholder__0wx94",masterFormModal:"quotes_masterFormModal__36AN0",masterForm:"quotes_masterForm__dXJKs",print:"quotes_print__ir6Gn",logo:"quotes_logo__Vsg-f",box:"quotes_box__+p8As",items:"quotes_items__ANNmM",taxes:"quotes_taxes__cyTAG",totalAmount:"quotes_totalAmount__rIs44",word:"quotes_word__sjhD8",digit:"quotes_digit__VyweO",sign:"quotes_sign__sG6wg",signature:"quotes_signature__YnCoV",head:"quotes_head__uo7Hz",quotes:"quotes_quotes__tCxCu",date:"quotes_date__KOSsI",customer:"quotes_customer__6hEHP",net:"quotes_net__h-6C4",actions:"quotes_actions__Qdwow",addQuoteForm:"quotes_addQuoteForm__fmLXp",itemForm:"quotes_itemForm__E47xe",itemName:"quotes_itemName__hYpvW",mainForm:"quotes_mainForm__Neb5l"},u=n(5454),d=n(1080),m=n(1134),h=n(1570),p=n(184),x=h.Ry({name:h.Z_().required("Please enter a name"),parent:h.Z_(),type:h.Z_().oneOf(["Cash","Bank","Customers","Suppliers","Sales","Purchase","Stock","null","Tax",null]).nullable(),isGroup:h.O7().required(),openingBalance:h.Rx().required("Please enter opening balance").typeError("Please enter a valid number")}),_=function(e){var t=e.edit,n=e.masters,s=void 0===n?[]:n,h=e.onSuccess,_=(0,m.cI)({resolver:(0,u.y)(x)}),f=_.handleSubmit,g=_.register,v=_.reset,b=_.control,j=_.formState.errors,N=(0,u.i)(d.Hv.accountingMasters+"/".concat((null===t||void 0===t?void 0:t._id)||"")),y=N.post,q=N.put,C=N.loading;return(0,i.useEffect)((function(){var e;v({name:(null===t||void 0===t?void 0:t.name)||"",parent:(null===t||void 0===t?void 0:t.parent)||"null",type:(null===t||void 0===t?void 0:t.type)||"null",isGroup:null===(e=null===t||void 0===t?void 0:t.isGroup)||void 0===e||e,openingBalance:(null===t||void 0===t?void 0:t.openingBalance)||0})}),[t]),(0,p.jsxs)("form",{onSubmit:f((function(e){"null"===e.parent&&(e.parent=null),"null"===e.type&&(e.type=null),(null!==t&&void 0!==t&&t._id?q:y)(e).then((function(e){var t=e.data;if(!t.success)return(0,c.N)({type:"error",message:t.message});h(t.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))})),className:"".concat(o.masterForm," grid gap-1"),children:[(0,p.jsx)(l.II,(0,a.Z)((0,a.Z)({label:"Name"},g("name")),{},{required:!0,error:j.name})),(0,p.jsx)(l.hQ,{label:"Parent",name:"parent",control:b,options:[{label:"None",value:"null"}].concat((0,r.Z)(s.map((function(e){return{label:e.name,value:e._id}}))))}),(0,p.jsx)(l.hQ,{label:"Type",name:"type",control:b,options:[{label:"None",value:"null"},{label:"Cash",value:"Cash"},{label:"Bank",value:"Bank"},{label:"Customers",value:"Customers"},{label:"Suppliers",value:"Suppliers"},{label:"Sales",value:"Sales"},{label:"Purchase",value:"Purchase"},{label:"Stock",value:"Stock"},{label:"Tax",value:"Tax"}]}),(0,p.jsx)(l.hQ,{label:"Is Group",name:"isGroup",control:b,formOptions:{required:!0},options:[{label:"No",value:!1},{label:"Yes",value:!0}]}),(0,p.jsx)(l.II,(0,a.Z)((0,a.Z)({label:"Opening Balance",type:"number"},g("openingBalance")),{},{required:!0,error:j.openingBalance})),(0,p.jsx)("div",{className:"btns",children:(0,p.jsx)("button",{className:"btn",disabled:C,children:null!==t&&void 0!==t&&t._id?"Update":"Submit"})})]})},f=n(5804),g=n(3974),v=n(1765),b=n(4794),j=function e(t){var n=t.account,a=t.setAddMaster,r=t.activeGroup,l=t.activeLeaf,m=t.onClick,h=void 0===m?function(){}:m,x=(0,i.useState)([]),_=(0,s.Z)(x,2),v=_[0],j=_[1],N=(0,i.useState)(!1),y=(0,s.Z)(N,2),q=y[0],C=y[1],S=(0,u.i)(d.Hv.accountingMasters),Z=S.get,A=S.loading;return(0,i.useEffect)((function(){n.children&&(n.children.length&&n.totalChildren>n.children.length?Z({query:{parent:n._id}}).then((function(e){var t=e.data;t.success?(j(t.data),C(!0)):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})})):(j(n.children),C(!(null===n||void 0===n||!n.isGroup)&&n.children.length>0)))}),[n.children]),(0,p.jsxs)("li",{style:{whiteSpace:"nowrap"},className:o.listItem,children:[(0,p.jsxs)("div",{className:o.label,children:[n.isGroup&&(0,p.jsx)(p.Fragment,{children:((null===v||void 0===v?void 0:v.length)||n.totalChildren)>0?(0,p.jsx)("button",{onClick:function(){(null===v||void 0===v?void 0:v.length)===n.totalChildren?C(!q):Z({query:{parent:n._id}}).then((function(e){var t=e.data;t.success?(j(t.data),C(!0)):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))},children:A?(0,p.jsx)(b.frZ,{className:"spin"}):q?(0,p.jsx)(f.IgQ,{}):(0,p.jsx)(f.b5v,{})}):(0,p.jsx)("button",{style:{height:"16px",width:"16px",border:"1px dashed #818181",borderRadius:"2px",pointerEvents:"none"}})}),(0,p.jsx)("strong",{className:"".concat(o.accountName," ").concat(n.isGroup&&r===n._id||!n.isGroup&&l===n._id?o.highlight:""),onClick:function(){h(n)},children:n.name}),(0,p.jsxs)("div",{className:o.btns,children:[(0,p.jsx)("button",{className:o.addButton,onClick:function(){return a(n)},children:(0,p.jsx)(g.Nte,{})}),n.isGroup&&(0,p.jsx)("button",{className:o.addButton,onClick:function(){return a({parent:n._id,type:n.type||""})},children:(0,p.jsx)(f.iTs,{})})]})]}),q&&v.length>0&&(0,p.jsx)("ul",{className:"".concat(o.nestedList," ").concat(n.isGroup&&r===n._id?o.highlight:""),children:v.map((function(t){return(0,p.jsx)(e,{activeGroup:r,activeLeaf:l,account:t,setAddMaster:a,onClick:h},t._id)}))})]})},N=function(e){var t=e.account,n=e.rows;return(0,p.jsx)("div",{className:o.innerContentWrapper,children:(null===n||void 0===n?void 0:n.length)>0?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"mt-1 pl_5",children:t.name}),(0,p.jsx)(l.iA,{className:o.vouchers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Account Name"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"}],tfoot:(0,p.jsx)("tfoot",{style:{marginTop:"0"},children:(0,p.jsxs)("tr",{className:o.footer,children:[(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{className:"text-right",children:"Total"}),(0,p.jsx)("td",{className:"text-right",children:n.reduce((function(e,t){return e+t.debit}),0).toFixed(2)}),(0,p.jsx)("td",{className:"text-right",children:n.reduce((function(e,t){return e+t.credit}),0).toFixed(2)})]})}),children:n.map((function(e,t,n){var a,r,s,i;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"grid",children:e.createdAt&&(null===(a=n[t-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,p.jsx)(l.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,p.jsx)("td",{children:(null===(r=n[t-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&e.no}),(0,p.jsx)("td",{children:(null===(s=n[t-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.type}),(0,p.jsx)("td",{className:"grid",children:(null===(i=e.details)||void 0===i?void 0:i.length)>0?"Details:":e.accountName}),(0,p.jsx)("td",{className:"text-right",children:e.debit?e.debit.toFixed(2):null}),(0,p.jsx)("td",{className:"text-right",children:e.credit?e.credit.toFixed(2):null})]},t)}))})]}):t?(0,p.jsxs)("p",{className:o.analysysPlaceholder,children:["No records found for ",(0,p.jsx)("strong",{children:t.name}),"."]}):(0,p.jsx)("p",{className:o.analysysPlaceholder,children:"No account has been selected."})})},y=function(e){var t=e.account,n=(0,i.useState)([]),a=(0,s.Z)(n,2),m=a[0],h=a[1],x=(0,i.useState)([]),_=(0,s.Z)(x,2),f=_[0],g=_[1],v=(0,i.useState)("sub_debit"),b=(0,s.Z)(v,2),j=b[0],N=b[1],y=(0,u.i)(d.Hv.accountingMonthlyAnalysys),C=y.get,S=y.loading;return(0,i.useEffect)((function(){t?C({query:{accountId:t._id}}).then((function(e){var t=e.data;t.success?(g(t.data),h(t.months)):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})})):(g([]),h([]))}),[t]),(0,p.jsx)("div",{className:o.innerContentWrapper,children:t?(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"mt-1 flex gap-2 align-center",children:[(0,p.jsx)("p",{style:{fontWeight:"600",fontSize:"1.2em"},className:"pl_5",children:t.name}),(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"sub_debit",defaultChecked:!0,onChange:function(e){return N(e.target.value)}}),"Sum Of Debits"]}),(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"sub_credit",onChange:function(e){return N(e.target.value)}}),"Sum Of Credit"]}),(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"net",onChange:function(e){return N(e.target.value)}}),"Net"]}),(0,p.jsxs)("label",{className:"flex align-center gap_5",children:[(0,p.jsx)("input",{name:"calculation",type:"radio",value:"balance",onChange:function(e){return N(e.target.value)}}),"Balance"]})]})]}),(0,p.jsx)(l.iA,{loading:S,className:o.analysys,columns:[{label:t.name}].concat((0,r.Z)((m||[]).map((function(e){return{label:e.label,className:"text-right"}})))),tfoot:(0,p.jsx)("tfoot",{style:{marginTop:"0"},children:(0,p.jsxs)("tr",{className:o.footer,style:{borderTop:"1px solid #979797",padding:"0 0.5rem",paddingTop:"1rem"},children:[(0,p.jsx)("td",{children:"Total"}),(m||[]).map((function(e,t){return(0,p.jsx)("td",{className:"text-right",children:q(j,f.reduce((function(e,n,a){return e.push.apply(e,(0,r.Z)(n.entries[t])),e}),[]))},t)}))]})}),children:(f||[]).map((function(e,t,n){return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"grid",children:e.name}),(m||[]).map((function(t,n){return(0,p.jsx)("td",{className:"text-right",children:q(j,e.entries[n],e.openingBalance)},n)}))]},t)}))})]}):(0,p.jsx)("p",{className:o.analysysPlaceholder,children:"No group has been selected."})})},q=function(e,t){var n=null;if("sub_debit"===e)n=t.reduce((function(e,t){return e+t.debit}),0);else if("sub_credit"===e)n=t.reduce((function(e,t){return e+t.credit}),0);else if("net"===e)n=t.reduce((function(e,t){return e+t.debit-t.credit}),0);else if("balance"===e)return;return n.toFixed(2)},C=function(e){var t=e.setSidebarOpen,n=(0,i.useRef)(),m=(0,i.useState)(null),h=(0,s.Z)(m,2),x=h[0],g=h[1],b=(0,i.useState)([]),q=(0,s.Z)(b,2),C=q[0],S=q[1],Z=(0,i.useState)("voucherListing"),A=(0,s.Z)(Z,2),F=A[0],T=A[1],k=(0,i.useState)(!0),G=(0,s.Z)(k,2),D=G[0],I=G[1],w=(0,i.useState)(null),B=(0,s.Z)(w,2),M=B[0],P=B[1],W=(0,i.useState)({}),E=(0,s.Z)(W,2),L=E[0],O=E[1],Y=(0,i.useState)([]),Q=(0,s.Z)(Y,2),H=Q[0],z=Q[1],R=(0,i.useState)({}),V=(0,s.Z)(R,2),K=V[0],U=(V[1],(0,u.i)(d.Hv.accountingMasters).get),X=(0,u.i)(d.Hv.accountingVouchers).get,J=(0,i.useMemo)((function(){return function(e){var t={};e.forEach((function(e){e.children=[],t[e._id]=e}));var n=[];return e.forEach((function(e){if(e.parent){var a=t[e.parent];a&&a.children.push(e)}else n.push(e)})),n}(C)}),[C]);return(0,i.useEffect)((function(){U({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return S(t.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[]),(0,i.useEffect)((function(){X({query:K}).then((function(e){var t=e.data;t.success?z(t.data):(0,c.N)({type:"error",message:t.message})})).catch((function(e){return(0,c.N)({type:"error",message:e.message})}))}),[K]),(0,p.jsxs)("div",{className:"".concat(o.content," grid gap-1 m-a"),children:[(0,p.jsx)("div",{className:"flex ".concat(o.head),children:(0,p.jsxs)("div",{className:"flex align-center pointer gap_5  ml-1",onClick:function(){return t((function(e){return!e}))},children:[(0,p.jsx)(f.Ps6,{style:{fontSize:"1.75rem"}}),(0,p.jsx)("h2",{children:"Accounting"})]})}),(0,p.jsxs)("div",{className:"".concat(o.innerWrapper," ").concat(D?o.open:""),children:[(0,p.jsxs)("div",{className:o.sidebar,children:[(0,p.jsx)("button",{className:o.addButton,onClick:function(){return g({})},children:(0,p.jsx)(f.iTs,{})}),(0,p.jsx)("ul",{children:C.length>0?J.map((function(e){var t;return(0,p.jsx)(j,{account:e,setAddMaster:g,activeGroup:"analysys"===F?null===M||void 0===M?void 0:M._id:null,activeLeaf:"ledgers"===F?null===L||void 0===L||null===(t=L.account)||void 0===t?void 0:t._id:null,onClick:function(e){if(e.isGroup)P(e),T("analysys");else{var t=(H||[]).filter((function(t){return t.accountId===e._id})),n=(H||[]).filter((function(e){return t.some((function(t){return t.rec_id===e.rec_id}))})),s=[].concat((0,r.Z)(t),(0,r.Z)(n)).filter((function(e,t,n){return t===n.findIndex((function(t){return t.rec_id===e.rec_id&&t.index===e.index}))})),i=s.filter((function(t){return t.accountId!==e._id})).reduce((function(e,t){var n=e.findIndex((function(e){return e.some((function(e){return e.rec_id===t.rec_id}))}));return-1===n?e.push([t]):e[n].push(t),e}),[]).map((function(e){var t=s.find((function(t){return t.rec_id===e[0].rec_id}));return e.length<=1?(0,a.Z)((0,a.Z)({},e[0]),{},{debit:t.debit,credit:t.credit}):(0,a.Z)((0,a.Z)({},e[0]),{},{details:e.map((function(e){return{label:e.accountName,value:e.credit||e.debit}})),debit:t.debit,credit:t.credit})})).sort((function(e,t){return new Date(e)>new Date(t)?1:-1})).sort((function(e,t){return e.index>t.index?1:-1})).reduce((function(e,t){var n;return null!==(n=t.details)&&void 0!==n&&n.length?e.push.apply(e,[t].concat((0,r.Z)(t.details.map((function(e){return{createdAt:null,no:null,type:null,accountName:(0,p.jsxs)("p",{children:[e.label,": ",e.value.toFixed(2)]}),debit:null,credit:null}}))))):e.push(t),e}),[]);O({account:e,rows:i}),T("ledgers")}}},e._id)})):(0,p.jsx)("p",{style:{marginTop:"1rem",marginBottom:"1rem",textAlign:"center",textWrap:"balance",color:"#797979"},children:"No accounts have been added yet."})})]}),(0,p.jsxs)("div",{className:o.innerContent,children:[(0,p.jsxs)("div",{className:"flex gap-1 align-center",children:[(0,p.jsx)("button",{className:"btn clear iconOnly",onClick:function(){return I(!D)},children:(0,p.jsx)(v.kpB,{})}),(0,p.jsx)(l.mQ,{activeTab:F,tabs:[{label:"Voucher Listing",value:"voucherListing"},{label:"Ledgers",value:"ledgers"},{label:"Accounting Analysys",value:"analysys"}],onChange:function(e){return T(e.value)}})]}),"voucherListing"===F&&(0,p.jsx)("div",{className:o.innerContentWrapper,children:(0,p.jsx)(l.iA,{ref:n,url:d.Hv.accountingVouchers,countRecord:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t,n,a){var r;return e+((null===(r=a[n-1])||void 0===r?void 0:r.rec_id)!==t.rec_id?1:0)}),0)},filters:K,filterFields:[{label:"Type",fieldType:"select",name:"type",optionType:"predefined",options:[{label:"Invoice",value:"Invoice"},{label:"Purchase",value:"Purchase"},{label:"Receipt",value:"Receipt"},{label:"Payment",value:"Payment"}]},{label:"Start Date",fieldType:"input",inputType:"datetime-local",name:"startDate"},{label:"End Date",fieldType:"input",inputType:"datetime-local",name:"endDate"}],className:o.vouchers,columns:[{label:"Date"},{label:"No"},{label:"Type"},{label:"Account Name"},{label:"Debit",className:"text-right"},{label:"Credit",className:"text-right"}],tfoot:function(e){return(0,p.jsx)("tfoot",{children:(0,p.jsxs)("tr",{className:o.footer,children:[(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{}),(0,p.jsx)("td",{className:"text-right",children:"Total"}),(0,p.jsx)("td",{className:"text-right",children:e.reduce((function(e,t){return e+t.debit}),0).toFixed(2)}),(0,p.jsx)("td",{className:"text-right",children:e.reduce((function(e,t){return e+t.credit}),0).toFixed(2)})]})})},children:H.map((function(e,t,n){var a,r,s;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{className:"grid",children:(null===(a=n[t-1])||void 0===a?void 0:a.rec_id)!==e.rec_id&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.W7,{style:{fontSize:"14px"},format:"DD MMM YYYY",children:e.createdAt}),(0,p.jsx)(l.W7,{format:"hh:mma",children:e.createdAt})]})}),(0,p.jsx)("td",{children:(null===(r=n[t-1])||void 0===r?void 0:r.rec_id)!==e.rec_id&&e.no}),(0,p.jsx)("td",{children:(null===(s=n[t-1])||void 0===s?void 0:s.rec_id)!==e.rec_id&&e.type}),(0,p.jsx)("td",{children:e.accountName}),(0,p.jsx)("td",{className:"text-right",children:e.debit?e.debit.toFixed(2):null}),(0,p.jsx)("td",{className:"text-right",children:e.credit?e.credit.toFixed(2):null})]},t)}))})}),"ledgers"===F&&(0,p.jsx)(N,{account:null===L||void 0===L?void 0:L.account,rows:null===L||void 0===L?void 0:L.rows}),"analysys"===F&&(0,p.jsx)(y,{account:M})]})]}),(0,p.jsx)(c.u,{open:x,head:!0,label:"".concat(null!==x&&void 0!==x&&x._id?"Update":"Add"," Account"),className:o.masterFormModal,setOpen:function(){g(null)},children:(0,p.jsx)(_,{edit:x,masters:C,onSuccess:function(){U({query:{isGroup:"true"}}).then((function(e){var t=e.data;if(t.success)return S(t.data)})).catch((function(e){return(0,c.N)({type:"error",message:e.message})})),g(!1)}})})]})}}}]);
//# sourceMappingURL=764.5aca0be2.chunk.js.map